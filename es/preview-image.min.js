function t(){return t=Object.assign?Object.assign.bind():function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},t.apply(this,arguments)}function e(t,e){if(null==t)return{};var i,n,s={},o=Object.keys(t);for(n=0;o.length>n;n++)0>e.indexOf(i=o[n])&&(s[i]=t[i]);return s}let i=class{constructor(){this.events={},this.events={}}one(t,e,i){const n="function"==typeof e?(...s)=>{e.apply(null,s),this.off(t,n,i)}:e;this.on(t,n,i)}on(t,e,i){const n=this.events[t]||{pool:[],single:-1};if("function"==typeof e)if(i)-1===n.single?n.single=n.pool.push(e)-1:n.pool[n.single]=e;else{let t=!0;for(let i=0,s=n.pool.length;s>i;i++)if(n.pool[i]===e&&i!==n.single){t=!1;break}t&&n.pool.push(e)}else i&&-1!==n.single&&(n.pool.splice(n.single,1),n.single=-1);this.events[t]=n}off(t,e,i){if(void 0===t)this.events={};else if(void 0===e)delete this.events[t];else if(i){const e=this.events[t];e&&-1!==e.single&&(e.pool.splice(e.single,1),e.single=-1)}else{const i=this.events[t];if(i)for(let t=i.pool.length-1;t>=0;t--)if(i.pool[t]===e&&t!==i.single){i.pool.splice(t,1);break}}}emit(t,e){const i=this.events[t];if(i)for(let n=0,s=i.pool.length;s>n;n++){const s=i.pool[n];if("function"==typeof s&&!1===s.call(null,e,t))break}}};const n=(t,e)=>{let i=t;for(;i&&i!==e;)i=i.parentNode;return!!i};function s(t,e,i){return"number"!=typeof t||i>t?e:t}function o(){return window.navigator.maxTouchPoints||"ontouchstart"in window.document}function r(t,e=!1){if(t.touches){if(e){const e=Array.prototype.filter.call(t.touches,(e=>n(e.target,t.currentTarget))).map((t=>({pageX:t.pageX,pageY:t.pageY,identifier:t.identifier})));return{points:e,isFirst:t.changedTouches.length===e.length}}return{points:Array.prototype.slice.call(t.changedTouches||[]).map((t=>({pageX:t.pageX,pageY:t.pageY,identifier:t.identifier})))}}return{points:[{pageX:t.pageX,pageY:t.pageY,identifier:-1}],isFirst:e}}function a([t,e],[i,n]){return"number"==typeof t&&"number"==typeof i&&"number"==typeof e&&"number"==typeof n?Math.sqrt(Math.pow(i-t,2)+Math.pow(n-e,2)):0}function l([t,e],[i,n]){return"number"==typeof t&&"number"==typeof i&&"number"==typeof e&&"number"==typeof n?180*Math.atan2(n-e,i-t)/Math.PI:0}function h([t,e],[i,n]){const s="number"==typeof t&&"number"==typeof e,o="number"==typeof i&&"number"==typeof n;return s||o?s&&!o?[t,e]:!s&&o?[i,n]:[(t+i)/2,(e+n)/2]:[0,0]}function c([t,e],[i,n]){if("number"==typeof t&&"number"==typeof i&&"number"==typeof e&&"number"==typeof n){const s=t-i,o=e-n;if(s!==o)return Math.abs(o)>Math.abs(s)?e-n>0?"Up":"Down":t-i>0?"Left":"Right"}return"None"}let u=class extends i{constructor(t){super(),this.wheelDelay=350,this.longTapInterval=750,this.doubleTapInterval=250,this.doubleTapDistance=30,this.touchMoveDistance=3,this.swipeVelocity=.3,this.swipeDuration=100,this.raiseDuration=100,this._rotateAngle=0,this._singleTapTimer=0,this._longTapTimer=0,this._wheelTimerEnd=null,this._preventTap=!0,this._swipePoints=null,this._preventSingleTap=!0,this._preventDoubleTap=!0,this._firstPointer=null,this._pointer0=null,this._pointer1=null,this.resetOptions(t)}resetOptions(t){const{wheelDelay:e,longTapInterval:i,doubleTapInterval:n,doubleTapDistance:o,touchMoveDistance:r,swipeVelocity:a,swipeDuration:l,raiseDuration:h}=t||{};this.wheelDelay=s(e,350,1),this.longTapInterval=s(i,750,1),this.doubleTapInterval=s(n,250,1),this.doubleTapDistance=s(o,30,1),this.touchMoveDistance=s(r,3,0),this.swipeVelocity=s(a,.3,0),this.swipeDuration=s(l,100,1),this.raiseDuration=s(h,100,1)}preventAllTap(t=!0){this._preventTap=!0,this._preventSingleTap=!0,this._preventDoubleTap=!0,t&&(this._firstPointer=null),this._longTapTimer&&(clearTimeout(this._longTapTimer),this._longTapTimer=0)}};function p(){this.nativeEvent||(this.preventDefault?this.preventDefault():this.returnValue=!1)}function d(){this.stopPropagation?this.stopPropagation():this.cancelBubble=!0}function m(){this.nativeEvent?this.nativeEvent.stopImmediatePropagation&&this.nativeEvent.stopImmediatePropagation():this.stopImmediatePropagation?this.stopImmediatePropagation():d.call(this)}function f(t){const e={sourceEvent:t,timestamp:Date.now(),pointers:[],leavePointers:[],getPoint:()=>[0,0],isTouching:()=>!!o()&&!!t.touches,preventDefault:p.bind(t),stopPropagation:d.bind(t),stopImmediatePropagation:m.bind(t)},{points:i,isFirst:n}=r(t,!0);n?(this._wheelTimerEnd&&(clearTimeout(this._wheelTimerEnd.timer),this._wheelTimerEnd.wheelEnd(),this._wheelTimerEnd=null),this._pointer0=null,this._pointer1=null):(this._pointer0&&(this._pointer0.changed=!1),this._pointer1&&(this._pointer1.changed=!1));for(let t=0,e=i.length;e>t;++t){const e=i[t],n=[e.pageX,e.pageY],s={start:n,previous:n,current:n,identifier:e.identifier,changed:!0};this._pointer0?this._pointer1||this._pointer0.identifier===e.identifier||(this._pointer1=s):this._pointer0=s}this.preventAllTap(!1),this._swipePoints=null,this._rotateAngle=0;const s=this._pointer0,l=this._pointer1;if(l&&s)this._firstPointer=null,e.pointers=[s,l],e.getPoint=()=>h(s.current,l.current),this.emit("gestureStart",e);else{if(!s)return;{e.pointers=[s],e.getPoint=()=>s.current,this._preventTap=!1,this._longTapTimer=+setTimeout((()=>{this._preventTap=!0,this._preventSingleTap=!0,this._preventDoubleTap=!0,this._longTapTimer=0,this._firstPointer=null,e.waitTime=this.longTapInterval,this.emit("longTap",e)}),this.longTapInterval);const t=this._firstPointer,i=this._singleTapTimer;i&&t&&a(t.current,s.current)<this.doubleTapDistance?(clearTimeout(i),this._singleTapTimer=0,this._preventSingleTap=!0,this._preventDoubleTap=!1,e.getPoint=()=>t.current):(this._firstPointer=s,this._preventSingleTap=!1,this._preventDoubleTap=!0)}}this.emit("pointerStart",e)}function g(t){const e={sourceEvent:t,timestamp:Date.now(),pointers:[],leavePointers:[],getPoint:()=>[0,0],isTouching:()=>!!o()&&!!t.touches,preventDefault:p.bind(t),stopPropagation:d.bind(t),stopImmediatePropagation:m.bind(t)};this._pointer0&&(this._pointer0.changed=!1),this._pointer1&&(this._pointer1.changed=!1);const{points:i}=r(t);for(let t=0,e=i.length;e>t;++t){const e=i[t],n=[e.pageX,e.pageY];this._pointer0&&this._pointer0.identifier===e.identifier?(this._pointer0.changed=!0,this._pointer0.previous=this._pointer0.current,this._pointer0.current=n):this._pointer1&&this._pointer1.identifier===e.identifier&&(this._pointer1.changed=!0,this._pointer1.previous=this._pointer1.current,this._pointer1.current=n)}const n=this._pointer0,s=this._pointer1;if(n&&a(n.start,n.current)>this.touchMoveDistance||s&&a(s.start,s.current)>this.touchMoveDistance){if(this.preventAllTap(),s&&n){e.pointers=[n,s];const{start:t,previous:i,current:o}=n,{start:r,previous:u,current:p}=s,d=h(o,p),m=h(i,u),f=h(t,r);e.getPoint=t=>"start"===t?f:"previous"===t?m:d,e.direction=c(m,d),e.moveDirection=c(f,d),e.deltaX=d[0]-m[0],e.moveX=d[0]-f[0],e.deltaY=d[1]-m[1],e.moveY=d[1]-f[1];const g=a(o,p),v=a(i,u),_=a(t,r);_>0&&g>0&&v>0&&(e.scale=g/v,e.moveScale=g/_);let y=l(o,p)-l(i,u);-180>y?y+=360:y>180&&(y-=360),e.angle=y,this._rotateAngle+=y,e.moveAngle=this._rotateAngle,this.emit("rotate",e),_>0&&g>0&&v>0&&this.emit("scale",e),this.emit("multiPan",e),this.emit("gestureMove",e)}else{if(!n)return;{e.pointers=[n];const{start:t,previous:i,current:s}=n;e.getPoint=e=>"start"===e?t:"previous"===e?i:s,e.direction=c(i,s),e.moveDirection=c(t,s),e.deltaX=s[0]-i[0],e.moveX=s[0]-t[0],e.deltaY=s[1]-i[1],e.moveY=s[1]-t[1];const o=Date.now(),r=this._swipePoints||[[],[]];o-((r[1][0]?r[1][0].timestamp:0)||0)>this.swipeDuration&&(r[0]=r[1],r[1]=[]),r[1].push({point:s,timestamp:o}),this._swipePoints=r,this.emit("pan",e)}}this.emit("pointerMove",e)}}function v(t){const e={sourceEvent:t,timestamp:Date.now(),pointers:[],leavePointers:[],getPoint:()=>[0,0],isTouching:()=>!!o()&&!!t.touches,preventDefault:p.bind(t),stopPropagation:d.bind(t),stopImmediatePropagation:m.bind(t)};let i=null,n=null;this._pointer0&&(this._pointer0.changed=!1),this._pointer1&&(this._pointer1.changed=!1);const{points:s}=r(t);for(let t=0,e=s.length;e>t;++t){const e=s[t];this._pointer0&&this._pointer0.identifier===e.identifier?(this._pointer0.changed=!0,i=this._pointer0,this._pointer0=null):this._pointer1&&this._pointer1.identifier===e.identifier&&(this._pointer1.changed=!0,n=this._pointer1,this._pointer1=null)}if(this._pointer1&&!this._pointer0&&(this._pointer0=this._pointer1,this._pointer1=null,n=i,i=null),this._longTapTimer&&(clearTimeout(this._longTapTimer),this._longTapTimer=0),this._pointer0){e.pointers=[this._pointer0],this._pointer1?e.pointers.push(this._pointer1):n&&(e.leavePointers=[n],this._rotateAngle=0);const t=h(this._pointer0.start,this._pointer1?this._pointer1.start:n?n.start:[]),i=h(this._pointer0.previous,this._pointer1?this._pointer1.previous:n?n.previous:[]),s=h(this._pointer0.current,this._pointer1?this._pointer1.current:n?n.current:[]);e.getPoint=e=>"start"===e?t:"previous"===e?i:s,this.emit("gestureEnd",e)}else if(i){e.leavePointers=[i],n&&e.leavePointers.push(n);const t=n?h(i.start,n.start):i.start,s=n?h(i.previous,n.previous):i.previous,o=n?h(i.current,n.current):i.current;if(e.getPoint=e=>"start"===e?t:"previous"===e?s:o,this._preventTap||(this.emit("tap",e),this._preventTap=!0),this._preventSingleTap||(this._singleTapTimer=+setTimeout((()=>{this._singleTapTimer=0,e.delayTime=this.doubleTapInterval,this.emit("singleTap",e)}),this.doubleTapInterval),this._preventSingleTap=!0),!this._preventDoubleTap){const t=this._firstPointer;t&&(e.getPoint=()=>t.current),e.intervalTime=this.doubleTapInterval,this.emit("doubleTap",e),this._firstPointer=null,this._preventDoubleTap=!0}if(this._swipePoints){const[t,i]=this._swipePoints,n=i[i.length-1];if(Date.now()-n.timestamp<=this.raiseDuration){let s=i[0];for(let e=t.length-1;e>=0&&this.swipeDuration>=n.timestamp-t[e].timestamp;e--)s=t[e];const o=(u=n.timestamp-s.timestamp,"number"!=typeof(f=a(s.point,n.point))||0===f||"number"!=typeof u||0===u?0:f/u);if(o>this.swipeVelocity){const t=l(s.point,n.point);e.direction=c(s.point,n.point),e.angle=t,e.velocity=o,e.swipeComputed=(e,i=o)=>{let n=0,s=0,r=0;e>1?(n=e,s=i/n,r=i*n/2):e>0&&(s=e,n=i/s,r=i*i/(2*s));const[a,l]=function(t,e){if("number"!=typeof t||"number"!=typeof e)return[0,0];const i=e*Math.PI/180;return[t*Math.cos(i),t*Math.sin(i)]}(r,t);return{duration:n,stretchX:a,stretchY:l,deceleration:s}},this.emit("swipe",e),this._swipePoints=null}}}}var u,f;this.emit("pointerEnd",e)}function _(t){this.emit("pointerCancel",{sourceEvent:t,timestamp:Date.now(),pointers:[],leavePointers:[],getPoint:()=>[0,0],isTouching:()=>!!o()&&!!t.touches,preventDefault:p.bind(t),stopPropagation:d.bind(t),stopImmediatePropagation:m.bind(t)}),v.call(this,t)}function y(t){const e=this;function i(){"undefined"!=typeof window&&(window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",r),window.removeEventListener("blur",s),window.removeEventListener("dragstart",n),"onselectstart"in window.document.documentElement&&window.removeEventListener("selectstart",n))}function n(t){t.preventDefault()}function s(t){n(t),i()}function o(i){if(0===t.button)g.call(e,i);else{const t={sourceEvent:i,timestamp:Date.now(),pointers:[],leavePointers:[],getPoint:()=>[0,0],isTouching:()=>!1,preventDefault:p.bind(i),stopPropagation:d.bind(i),stopImmediatePropagation:m.bind(i)},n=[i.pageX,i.pageY];if(e._pointer0&&a(e._pointer0.start,n)>e.touchMoveDistance){e._pointer0.previous=e._pointer0.current,e._pointer0.current=n,t.pointers=[e._pointer0];const{start:i,previous:s,current:o}=e._pointer0;t.getPoint=t=>"start"===t?i:"previous"===t?s:o,t.direction=c(s,o),t.moveDirection=c(i,o),t.deltaX=o[0]-s[0],t.moveX=o[0]-i[0],t.deltaY=o[1]-s[1],t.moveY=o[1]-i[1],t.angle=t.deltaX/4,t.moveAngle=t.moveX/4,e.emit("rotate",t)}}}function r(n){if(i(),0===t.button)v.call(e,n);else{const t={sourceEvent:n,timestamp:Date.now(),pointers:[],leavePointers:[],getPoint:()=>[0,0],isTouching:()=>!1,preventDefault:p.bind(n),stopPropagation:d.bind(n),stopImmediatePropagation:m.bind(n)},i=[n.pageX,n.pageY];if(e._pointer0){const n=e._pointer0;e._pointer0=null,n.previous=n.current,n.current=i,t.leavePointers=[n];const{start:s,previous:o,current:r}=n;t.getPoint=t=>"start"===t?s:"previous"===t?o:r}t.angle=NaN,e.emit("rotate",t)}}if("undefined"!=typeof window&&(window.addEventListener("mousemove",o,{capture:!1,passive:!1}),window.addEventListener("mouseup",r,{capture:!1,passive:!1}),window.addEventListener("blur",s,{capture:!0,passive:!1}),window.addEventListener("dragstart",n,{capture:!0,passive:!1}),"onselectstart"in window.document.documentElement&&window.addEventListener("selectstart",n,{capture:!0,passive:!1})),0===t.button)f.call(e,t);else{e._wheelTimerEnd&&(clearTimeout(e._wheelTimerEnd.timer),e._wheelTimerEnd.wheelEnd(),e._wheelTimerEnd=null);const i=[t.pageX,t.pageY];e._pointer0={start:i,previous:i,current:i,identifier:-1,changed:!0}}}function w(t){const e={sourceEvent:t,timestamp:Date.now(),pointers:[],leavePointers:[],getPoint:()=>[0,0],isTouching:()=>!1,preventDefault:p.bind(t),stopPropagation:d.bind(t),stopImmediatePropagation:m.bind(t)},i=[t.pageX,t.pageY];this._wheelTimerEnd?(this._pointer0&&(this._pointer0.previous=this._pointer0.current,this._pointer0.current=i),clearTimeout(this._wheelTimerEnd.timer)):this._pointer0={start:i,previous:i,current:i,identifier:-1,changed:!0};const n=()=>{this._pointer0=null,this._wheelTimerEnd=null,e.timestamp=Date.now(),e.scale=NaN,this.emit("scale",e)};if(this._wheelTimerEnd={wheelEnd:n,timer:+setTimeout(n,this.wheelDelay),scale:this._wheelTimerEnd?this._wheelTimerEnd.scale:1},this._pointer0){e.pointers=[this._pointer0];const{start:i,previous:n,current:s}=this._pointer0;e.getPoint=t=>"start"===t?i:"previous"===t?n:s;const o=Math.pow(2,-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002));this._wheelTimerEnd.scale*=o,e.moveScale=this._wheelTimerEnd.scale,e.scale=o,this.emit("scale",e)}}class b extends u{constructor(t,e){super(e),this.element=null,this._unbind=null;const i=function(t){let e=t;return"string"==typeof t&&(e=document.querySelector(t)),"function"==typeof t&&(e=t()),e||null}(t);if(!i)throw Error("Please pass in a valid element...");this.element=i;let n=()=>{};if(o()){const t=f.bind(this),e=g.bind(this),s=v.bind(this),o=_.bind(this);i.addEventListener("touchstart",t,{capture:!1,passive:!1}),i.addEventListener("touchmove",e,{capture:!1,passive:!1}),i.addEventListener("touchend",s,{capture:!1,passive:!1}),i.addEventListener("touchcancel",o,{capture:!1,passive:!1}),n=()=>{i.removeEventListener("touchstart",t),i.removeEventListener("touchmove",e),i.removeEventListener("touchend",s),i.removeEventListener("touchcancel",o)}}const s=y.bind(this),r=w.bind(this);i.addEventListener("mousedown",s,{capture:!1,passive:!1}),i.addEventListener("wheel",r,{capture:!1,passive:!1}),this._unbind=()=>{i.removeEventListener("mousedown",s),i.removeEventListener("wheel",r),n()}}destory(){super.off(),this._unbind&&(this._unbind(),this._unbind=null,this.element=null)}}function T(t){return t.replace(/([A-Z])/g,"-$1").toLocaleLowerCase()}const x=/^(?:-border(?:-top|-right|-bottom|-left)?(?:-width|)|(?:-margin|-padding)?(?:-top|-right|-bottom|-left)?|(?:-min|-max)?(?:-width|-height))$/;function D(t,e){if(t&&e){let i="";Object.keys(e).forEach((n=>{const s=T(n),o=e[n];if(o||0===o){const t="number"==typeof o&&/^[a-z]/.test(s)&&x.test("-"+s)?"px":"";i+=`${s}: ${o}${t};`}else t.style.removeProperty(s)})),t.style.cssText+=i}return t}function P(t,e){return!(!t||!e)&&t.classList.contains(e)}function E(t,e){return t&&e&&(Array.isArray(e)?e:e.split(" ")).forEach((e=>e&&t.classList.add(e))),t}function M(t,e){return t&&e&&(Array.isArray(e)?e:e.split(" ")).forEach((e=>e&&t.classList.remove(e))),t}function C(t){let e=t;return"string"==typeof t&&(e=document.querySelector(t)),"function"==typeof t&&(e=t()),e||null}function I(t,e,i,n){var s;let o,r,a,l;"string"==typeof t?(o=t,r=e||{},a=Array.isArray(i)?i:[i],l=n):(o="div",r=t||{},a=Array.isArray(e)?e:[e],l=i);const h=D(E(document.createElement(o),r.className),r.style),c=r.attrs||{};return Object.keys(c).forEach((t=>{"innerHTML"!==t&&"className"!==t&&"style"!==t&&h.setAttribute(T(t),c[t])})),a.forEach((t=>{t instanceof Element?null==h||h.appendChild(t):h&&null!=t&&(h.innerHTML=t+"")})),null==(s=C(l))||s.appendChild(h),h}function k(){return k=Object.assign?Object.assign.bind():function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},k.apply(this,arguments)}function S(t,e){if(null==t)return{};var i,n,s={},o=Object.keys(t);for(n=0;o.length>n;n++)0>e.indexOf(i=o[n])&&(s[i]=t[i]);return s}const A=/^(?:-border(?:-top|-right|-bottom|-left)?(?:-width|)|(?:-margin|-padding)?(?:-top|-right|-bottom|-left)?|(?:-min|-max)?(?:-width|-height))$/,L="undefined"==typeof window?global:window,z=["moz","webkit"];let F=L.requestAnimationFrame,O=L.cancelAnimationFrame||L.cancelRequestAnimationFrame;if(!F||!O)for(var X=0;2>X;X++)F=L[z[X]+"RequestAnimationFrame"],O=L[z[X]+"CancelAnimationFrame"]||L[z[X]+"CancelRequestAnimationFrame"];F&&O||(F=function(){let t=0;return function(e){const i=Date.now(),n=Math.max(0,16-(i-t));return t=i+n,window.setTimeout(e,n)}}(),O=function(t){return window.clearTimeout(t)});const j=F,Y=O,H=(t,e)=>e>0?+setTimeout(t,e):(t(Math.abs(e)),0);let B=class{constructor({duration:t,easing:e,delay:i}={}){this._delay=0,this._frameId=0,this._elapsed=0,this._sleepId=0,this._delayId=0,this._tick=null,this._delayFn=null,this.duration="number"==typeof t&&t>0?t:0,this.easing="function"!=typeof e?t=>t:e,this.delay="number"!=typeof i?0:i}start(t){if(!this._tick&&!this._delayFn){const{duration:e,easing:i,delay:n}=this;this._delayFn=n=>{if(this._delayId=0,this._delayFn=null,this._delay=0,e>0){const s=n=>{const o=Date.now();this._elapsed+=o-n,e>this._elapsed?(this._frameId=j((()=>s(o))),t(i(this._elapsed/e))):(this._tick=null,this._frameId=0,this._elapsed=0,t(1))};this._tick=s,this._elapsed=n||0,s(Date.now())}else t(1)},this._delay=Date.now(),this._delayId=H(this._delayFn,n)}}restart(){if((this._tick||this._delayFn)&&(this.stop(),this._tick&&this._tick(Date.now()),this._delayFn)){const t=this.delay+this._delay;this._delay+=Date.now(),this._delayId=H(this._delayFn,t)}}sleep(t){t&&t>0&&(this._tick||this._delayFn)&&(this.stop(),this._sleepId=+setTimeout((()=>{this._sleepId=0,this.restart()}),t))}stop(){(this._tick||this._delayFn)&&(this._delayId&&(clearTimeout(this._delayId),this._delayId=0,this._delay-=Date.now()),this._frameId&&(Y(this._frameId),this._frameId=0),this._sleepId&&(clearTimeout(this._sleepId),this._sleepId=0))}end(){(this._tick||this._delayFn)&&(this.stop(),this._tick&&this._tick(Date.now()+this._elapsed-this.duration),this._delayFn&&this._delayFn(this.duration))}},N=class{constructor(t,e,i){const n=this.value="number"==typeof t?{default:t}:t;if("number"==typeof e){const t={};Object.keys(n).forEach((i=>{t[i]=e||0})),this.precision=t}else e&&(this.precision=e);"function"==typeof i&&(this.transform=i)}toRaw(){const t={value:this.value};return this.precision&&(t.precision=this.precision),this.transform&&(t.transform=this.transform),t}};const V=["value","precision"],R=["value"],W=["before","after","cancel"];let $=class{constructor({cssProperties:t,apply:e}={}){this.cssProperties={},this._cssProperties=null,this._animations=[],this._apply=e||(()=>{}),t&&this.apply(t)}update(){!this.running()&&this._cssProperties&&(this.cssProperties=this._cssProperties,this._cssProperties=null);const{cssProperties:t}=this,e={};Object.keys(t).forEach((i=>{const{value:n,transform:s}=t[i];e[i.replace(/([A-Z])/g,"-$1").toLocaleLowerCase()]=s(n)})),this._apply(e)}value(){const t=this._cssProperties||this.cssProperties,e={};return Object.keys(t).forEach((i=>{e[i]=t[i].value})),e}apply(t,e){this._cssProperties||(this._cssProperties=this.cssProperties);const i=function(t,e){const i=k({},t);if(e instanceof N){const n=Object.keys(t)[0];if(n){const s=t[n],o=e.toRaw();i[n]=k({},s,o,{value:k({},s.value,o.value)})}}else Object.keys(e).forEach((n=>{const s=t[n],o=e[n].toRaw();i[n]=s?k({},s,o,{value:k({},s.value,o.value)}):k({transform:t=>Object.keys(t).map((e=>t[e])).join(" "),precision:{}},o)}));return i}(this._cssProperties,t),n=function(t,e){const i={};return Object.keys(t).forEach((n=>{const s=t[n].value,o=e[n],{value:r,precision:a}=o,l=S(o,V);let h=null;Object.keys(s).forEach((t=>{const e=r[t]-s[t];Math.abs(e)>(a[t]||0)&&(h||(h={}),h[t]=e)})),h&&(i[n]=k({value:h,precision:a},l))})),i}(this._cssProperties,i);this._cssProperties=i;const s=Object.keys(n),o={};s.forEach((t=>{const e=n[t],{value:i}=e,s=S(e,R);o[t]=k({value:k({},i)},s),this.cssProperties[t]=k({},this.cssProperties[t],s)}));const r=e&&0!==s.length?e:{};return new Promise((t=>{const{before:e=(()=>{}),after:i=(()=>{}),cancel:a=!0}=r,l=S(r,W),h=new B(l);this._animations.push({animation:h,cancel:a,remain:o}),h.start((r=>{const a=e(r,this.value());if(!1!==a){let t=r;"number"==typeof a&&(t=a),s.forEach((e=>{const i=this.cssProperties[e].value,s=n[e].value,r=o[e].value;Object.keys(s).forEach((e=>{const n=s[e]*(1-t);i[e]+=r[e]-n,r[e]=n}))})),this.update()}if(i(r,this.value()),1===r){const e=this._animations.findIndex((t=>h===t.animation));-1!==e&&this._animations.splice(e,1),this.update(),t(this.value())}}))}))}cancel(t=!1){let e=0;return this._animations=this._animations.filter((({animation:i,remain:n,cancel:s})=>{if(s){i[t?"end":"stop"](),e+=1;const s=this._cssProperties;return s&&Object.keys(n).forEach((t=>{if(s[t]){const e=n[t].value,i=s[t].value;Object.keys(e).forEach((t=>{i[t]-=e[t]}))}})),!1}return!0})),this.update(),e}running(){return 0!==this._animations.length}};const G=N;class q extends ${constructor(t,e){super(k({apply:e=>function(t,e){if(t&&e){let i="";Object.keys(e).forEach((n=>{const s=function(t){return t.replace(/([A-Z])/g,"-$1").toLocaleLowerCase()}(n),o=e[n];if(o||0===o){const t="number"==typeof o&&/^[a-z]/.test(s)&&A.test("-"+s)?"px":"";i+=`${s}: ${o}${t};`}else t.style.removeProperty(s)})),t.style.cssText+=i}return t}(function(t){let e=t;return"string"==typeof t&&(e=document.querySelector(t)),"function"==typeof t&&(e=t()),e||null}(t),e)},e||{}))}}const U=t=>1-(1-t)*(1-t),Z={cancel:!0,duration:500,easing:t=>1-(1-t)*(1-t)*(1-t)*(1-t)},J=["direction","itemModels","itemSize","enableSwipeClose","transitionEl"],K=["before","after"];class Q extends q{constructor(t={}){let{direction:i,itemModels:n,itemSize:s,enableSwipeClose:o,transitionEl:r}=t;super(r||null,e(t,J)),this._direction="horizontal",this._itemModels=[],this._itemSize=0,this._activeIndex=-1,this._enableSwipeClose=!0,this._fgBehavior=0,this._moveTarget="none",this.apply({transform:new G(0,1,(t=>`translateX(${t.default}px)`))}),this.swipeClose(o),this.direction(i),this.itemSize(s),this.itemModels(n)}activeIndex(){return this._activeIndex}isHorizontal(){return"horizontal"===this._direction}isVertical(){return"vertical"===this._direction}swipeClose(t){return void 0!==t&&(this._enableSwipeClose=t),this._enableSwipeClose}direction(t){if(t){this._direction=t;const e="vertical"===t?"Y":"X";this.apply(new G(0,1,(t=>`translate${e}(${t.default}px)`)))}return this._direction}itemSize(t){return void 0!==t&&(this._itemSize=t,this.apply(new G(-this.activeIndex()*t))),this._itemSize}itemModels(t,e){return void 0===t?this._itemModels:"number"==typeof t?this._itemModels[t]:Array.isArray(t)?(this._itemModels=t,t):(this._itemModels[e||0]=t,t)}currentItem(){return this.itemModels(this.activeIndex())}countItems(){return this.itemModels().length}slide(i,n={}){const{before:s,after:o}=n,r=e(n,K),a=Math.max(Math.min(i,this.countItems()-1),0),l=this.activeIndex()!==a;l&&(this._activeIndex=a,null==s||s(a));const h=-a*this.itemSize();return this.apply(new G(h),t({},Z,r)).then((()=>(l&&(null==o||o(a)),a)))}next(t){return this.slide(this._activeIndex+1,t)}prev(t){return this.slide(this._activeIndex-1,t)}}const tt=Math.PI/180,et={multiply:function(t,e,i){const n=e[0],s=e[4],o=e[8],r=e[12],a=e[1],l=e[5],h=e[9],c=e[13],u=e[2],p=e[6],d=e[10],m=e[14],f=e[3],g=e[7],v=e[11],_=e[15],y=i[0],w=i[1],b=i[2],T=i[3],x=i[4],D=i[5],P=i[6],E=i[7],M=i[8],C=i[9],I=i[10],k=i[11],S=i[12],A=i[13],L=i[14],z=i[15];t[0]=n*y+s*x+o*M+r*S,t[4]=n*w+s*D+o*C+r*A,t[8]=n*b+s*P+o*I+r*L,t[12]=n*T+s*E+o*k+r*z,t[1]=a*y+l*x+h*M+c*S,t[5]=a*w+l*D+h*C+c*A,t[9]=a*b+l*P+h*I+c*L,t[13]=a*T+l*E+h*k+c*z,t[2]=u*y+p*x+d*M+m*S,t[6]=u*w+p*D+d*C+m*A,t[10]=u*b+p*P+d*I+m*L,t[14]=u*T+p*E+d*k+m*z,t[3]=f*y+g*x+v*M+_*S,t[7]=f*w+g*D+v*C+_*A,t[11]=f*b+g*P+v*I+_*L,t[15]=f*T+g*E+v*k+_*z},identity:function(t){for(let e=0;16>e;e++)t[e]=0;for(let e=0;16>e;e+=5)t[e]=1},translate:function(t,e,i,n){for(let s=0;4>s;s++)t[12+s]+=t[s]*e+t[4+s]*i+t[8+s]*n},scale:function(t,e,i,n){for(let s=0;4>s;s++)t[s]*=e,t[4+s]*=i,t[8+s]*=n},rotate:function(t,e,i,n,s){const o=new Float32Array(16);o[3]=0,o[7]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1;const r=e*tt,a=Math.sin(r),l=Math.cos(r);if(1===i&&0===n&&0===s)o[5]=l,o[10]=l,o[6]=a,o[9]=-a,o[1]=0,o[2]=0,o[4]=0,o[8]=0,o[0]=1;else if(0===i&&0===n&&0===s)o[0]=l,o[10]=l,o[8]=a,o[2]=-a,o[1]=0,o[4]=0,o[6]=0,o[9]=0,o[5]=1;else if(0===i&&0===n&&1===s)o[0]=l,o[5]=l,o[1]=a,o[4]=-a,o[2]=0,o[6]=0,o[8]=0,o[9]=0,o[10]=1;else{const t=Math.sqrt(i*i+n*n+s*s);if(1!==t){const e=1/t;i*=e,n*=e,s*=e}const e=1-l,r=i*n,h=n*s,c=s*i,u=i*a,p=n*a,d=s*a;o[0]=i*i*e+l,o[4]=r*e-d,o[8]=c*e+p,o[1]=r*e+d,o[5]=n*n*e+l,o[9]=h*e-u,o[2]=c*e-p,o[6]=h*e+u,o[10]=s*s*e+l}et.multiply(t,t,o)},rotateEuler:function(t,e,i,n){const s=new Float32Array(16),o=e*tt,r=i*tt,a=n*tt,l=Math.cos(o),h=Math.sin(o),c=Math.cos(r),u=Math.sin(r),p=Math.cos(a),d=Math.sin(a),m=l*u,f=h*u;s[0]=c*p,s[1]=-c*d,s[2]=u,s[3]=0,s[4]=m*p+l*d,s[5]=-m*d+l*p,s[6]=-h*c,s[7]=0,s[8]=-f*p+h*d,s[9]=f*d+h*p,s[10]=l*c,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,et.multiply(t,t,s)},perspective:function(t,e,i,n,s){const o=1/Math.tan(e*(Math.PI/360)),r=1/(n-s);t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(s+n)*r,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*s*n*r,t[15]=0}};let it=class t{constructor(t={}){"number"==typeof t.a&&(this.a=t.a),"number"==typeof t.k&&(this.k=t.k),"number"==typeof t.x&&(this.x=t.x),"number"==typeof t.y&&(this.y=t.y)}static identity(){return new t({a:0,k:1,x:0,y:0})}toRaw(){const t={};return"number"==typeof this.a&&(t.a=this.a),"number"==typeof this.k&&(t.k=this.k),"number"==typeof this.x&&(t.x=this.x),"number"==typeof this.y&&(t.y=this.y),t}toString(){const{a:t=0,k:e=1,x:i=0,y:n=0}=this,s=new Float32Array(16);return et.identity(s),et.translate(s,i,n,0),et.scale(s,e,e,e),et.rotate(s,-t,0,0,1),`matrix3d(${Array.prototype.slice.call(s).join(",")})`}};function nt(t,e,i,n=!1){return 1>t||1>e||n&&t>e||0>=i||i>1?t:n?Math.pow((e-1)*t/(e-t),1/i):e/(1+(e-1)/Math.pow(t,i))}function st(t,e={}){if(0===t)return 0;const{max:i=9999,mode:n=0,expo:s=.88}=e;let o=Math.abs(t);return o=1>o?1===n?1/nt(1/o,i,s):nt(o+1,i,s)-1:nt(o,i,s),o*(t>0?1:-1)}function ot(t,e={}){if(0===t)return 0;const{max:i=9999,mode:n=0,expo:s=.88}=e;let o=Math.abs(t);return o=1>o?1===n?1/nt(1/o,i,s,!0):nt(o+1,i,s,!0)-1:nt(o,i,s,!0),o*(t>0?1:-1)}function rt(t,e,i){return t>(1-e)/(2*e)?(1+e-2*i)/(2*e)>t?(t-(1-i)/(2*e))/(1-i/e):.5:-.5}function at(t,...e){return"function"==typeof t?t(...e):t}function lt(t,[e,i]){return t>=e&&i>=t}function ht(t,[e,i],n){return Math.max(Math.min(t,i),e)}function ct(t){if(t){const{left:e,top:i,width:n,height:s}=t.getBoundingClientRect();return{x:e+n/2,y:i+s/2,w:n,h:s}}return{x:0,y:0,w:0,h:0}}function ut(t){return t.preventDefault()}const pt=["sizePosition","dblAdjust","dblScale","damping","rotation","scalation","translation","transitionEl"],dt=["touching"];class mt extends q{constructor(t={}){let{sizePosition:i,dblAdjust:n,dblScale:s,damping:o,rotation:r,scalation:a,translation:l,transitionEl:h}=t;super(h||null,e(t,pt)),this._dblAdjust=!0,this._dblScale=0,this._damping=[],this._rotation=[],this._scalation=[],this._translation=[],this._sizePosition={containerCenter:[0,0],containerWidth:0,containerHeight:0,naturalWidth:0,naturalHeight:0,elementWidth:0,elementHeight:0},this.apply({transform:new G({a:0,k:1,x:0,y:0},{a:.001,k:.001,x:1,y:1},(t=>""+new it(t)))}),this.sizePosition(i),this.setDblAdjust(n),this.setDamping(o),this.setDblScale(s),this.setRotation(r),this.setScalation(a),this.setTranslation(l)}reset(e=0){const i=ht(0,this.getRotation()),n=ht(1,this.getScalation()),s=ht(0,this.getXTranslation(n)),o=ht(0,this.getYTranslation(n));this.apply(new G({a:i,k:n,x:s,y:o}),t({},Z,{duration:e}))}sizePosition(t){if(t){const{containerCenter:e,containerWidth:i,containerHeight:n,naturalWidth:s,naturalHeight:o}=t,r=s/o;let a=s;a=i/n>r?1/2.2>r?Math.min(i,s):n*r:i;this._sizePosition={containerCenter:e,containerWidth:i,containerHeight:n,naturalWidth:s,naturalHeight:o,elementWidth:a||0,elementHeight:a/r||0},this.reset()}return this._sizePosition}setRotation(t){this._rotation=t}getRotation(...t){const e=at(this._rotation,...t);return e&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[1]>=e[0]?e:[0,0]}setScalation(t){this._scalation=t}getScalation(...t){const e=at(this._scalation,...t);return e&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[1]>=e[0]&&e[0]>0?e:[1,2*this.getDblScale()]}setTranslation(t){this.setXTranslation(t&&t[0]),this.setYTranslation(t&&t[1])}getTranslation(t,...e){return[this.getXTranslation(t,...e),this.getYTranslation(t,...e)]}setXTranslation(t){this._translation[0]=t}getXTranslation(t,...e){const i=at(this._translation[0],...e);if(i&&"number"==typeof i[0]&&"number"==typeof i[1]&&i[1]>=i[0])return i;const n=t||this.value().transform.k||1,{containerWidth:s,elementWidth:o}=this.sizePosition(),r=Math.max((o*n-s)/2,0);return[-r,r]}setYTranslation(t){this._translation[1]=t}getYTranslation(t,...e){const i=at(this._translation[1],...e);if(i&&"number"==typeof i[0]&&"number"==typeof i[1]&&i[1]>=i[0])return i;const n=t||this.value().transform.k||1,{containerHeight:s,elementHeight:o}=this.sizePosition(),r=Math.max((o*n-s)/2,0);return[-r,r]}setDblScale(t){this._dblScale=t}getDblScale(...t){const e=at(this._dblScale,...t);if("number"==typeof e&&e>0)return e;const{containerWidth:i,containerHeight:n,naturalWidth:s,naturalHeight:o,elementWidth:r,elementHeight:a}=this.sizePosition();return Math.max(2,Math.max(i/r,n/a),Math.min(s/i,o/n))||1}setDblAdjust(t=!0){this._dblAdjust=t}getDblAdjust(){return this._dblAdjust}isDamping(t){var e;return-1!==(null==(e=this._damping)?void 0:e.indexOf(t))}setDamping(t){this._damping=t||["scale","translate"]}rotate(t){return this.transform(new it({a:t}))}rotateTo(t){return this.transformTo(new it({a:t}))}scale(t,e){return this.transform(new it({k:t}),e)}scaleTo(t,e){return this.transformTo(new it({k:t}),e)}translate(t,e){return this.transform(new it({x:t,y:e}))}translateTo(t,e){return this.transformTo(new it({x:t,y:e}))}translateX(t){return this.transform(new it({x:t}))}translateXTo(t){return this.transformTo(new it({x:t}))}translateY(t){return this.transform(new it({y:t}))}translateYTo(t){return this.transformTo(new it({y:t}))}transform(t,e,i){const n=this.value().transform;let{a:s,k:o,x:r,y:a}=t;return"number"==typeof s&&(s+=n.a||0),"number"==typeof o&&(o*=n.k||1),"number"==typeof r&&(r+=n.x||0),"number"==typeof a&&(a+=n.y||0),this.transformTo(new it({a:s,k:o,x:r,y:a}),e,i)}transformTo(i,n,s){let o=n,r=s;s||Array.isArray(n)||(r=n,o=void 0);const a=r||{},{touching:l}=a,h=e(a,dt),{a:c,k:u,x:p,y:d}=i,m=new it;if("number"==typeof c&&(m.a=ht(c,this.getRotation(l))),"number"==typeof u){const t=m.k=ht(u,this.getScalation(l));if(Array.isArray(o)){const[e,i]=this.computeOffset(o,t),n=this.value().transform;m.x=ht(("number"==typeof p?p:n.x)+e,this.getXTranslation(t,l)),m.y=ht(("number"==typeof d?d:n.y)+i,this.getYTranslation(t,l))}else"number"==typeof p&&(m.x=ht(p,this.getXTranslation(t,l))),"number"==typeof d&&(m.y=ht(d,this.getYTranslation(t,l)))}else"number"==typeof p&&(m.x=ht(p,this.getXTranslation(0,l))),"number"==typeof d&&(m.y=ht(d,this.getYTranslation(0,l)));return this.apply(new G(m.toRaw()),t({},Z,h))}computeOffset(t,e,i=!1){const{containerCenter:n,containerWidth:s,containerHeight:o,elementWidth:r,elementHeight:a}=this.sizePosition(),l=this.value().transform,h=e/l.k,[c,u]=n;let p=("number"==typeof t[0]?t[0]:c)-(c+l.x),d=("number"==typeof t[1]?t[1]:u)-(u+l.y);if(i){const t=s/1,e=o/1,i=r/l.k,n=a/l.k;p=ht(i-(t-i)/(h-1),[0,i])*rt(p/i,h,ht(t/i,[1,2]))||0,d=ht(n-(e-n)/(h-1),[0,n])*rt(d/n,h,ht(e/n,[1,2]))||0}return p*=1-h,d*=1-h,[p,d]}moveBounce(t,e,i,n,s,o=[]){let{a:r,k:a,x:l,y:h}=this.value().transform;const c=this.getRotation(t);if(this.isDamping("rotate")){let t=ht(r,c);r=t+ot(r-t,{max:180}),t=ht(r+=e,c),r=t+st(r-t,{max:180})}else r=ht(r+=e,c);const u=this.getScalation(t);if(this.isDamping("scale")){let t=ht(a,u);a=t*ot(a/t,{max:2,mode:1}),t=ht(a*=i,u),a=t*st(a/t,{max:2,mode:1})}else a=ht(a*=i,u);const[p,d]=this.computeOffset(o,a);if(this.isDamping("scale")){const{containerWidth:e,containerHeight:i}=this.sizePosition();let o=ht(l,this.getXTranslation(0,t));l=o+ot(l-o,{max:e}),o=ht(l+=p+n,this.getXTranslation(a,t)),l=o+st(l-o,{max:e});let r=ht(h,this.getYTranslation(0,t));h=r+ot(h-r,{max:i}),r=ht(h+=d+s,this.getYTranslation(a,t)),h=r+st(h-r,{max:i})}else l=ht(l+=p+n,this.getXTranslation(a,t)),h=ht(h+=d+s,this.getYTranslation(a,t));this.apply(new G({a:r,k:a,x:l,y:h}))}resetBounce(t,e=[],i=!1){let{a:n,k:s,x:o,y:r}=this.value().transform;if(this.isDamping("rotate")){const e=ht(n,this.getRotation(t));n=e+ot(n-e,{max:180})}if(this.isDamping("scale")){const e=ht(s,this.getScalation(t));s=e*ot(s/e,{max:2,mode:1})}if(this.isDamping("translate")){const{containerWidth:e,containerHeight:i}=this.sizePosition(),n=ht(o,this.getXTranslation(0,t));o=n+ot(o-n,{max:e});const s=ht(r,this.getYTranslation(0,t));r=s+ot(r-s,{max:i})}this.transformTo(new it({a:n,k:s,x:o,y:r}),e,{cancel:i,touching:t})}dblScale(t,e=[]){const i=this.value().transform.k||1,n=ht(this.getDblScale(t),this.getScalation(t)),s=ht(1,this.getScalation(t));if(n>s&&s>=i||s>n&&i>=s)if(this.getDblAdjust()){const[t,i]=this.computeOffset(e,n,this.getDblAdjust()),s=this.value().transform;this.transformTo(new it({a:0,k:n,x:s.x+t,y:s.y+i}),{cancel:!1})}else this.transformTo(new it({k:n}),e,{cancel:!1,touching:t});else this.getDblAdjust()?this.transformTo(new it({a:0,k:s,x:0,y:0}),{cancel:!1,touching:t}):this.transformTo(new it({k:s}),e,{cancel:!1,touching:t})}swipeBounce(e,i,n,s,o){const r=this.sizePosition()["x"===s?"containerWidth":"containerHeight"],a=1.2*this.getDblScale(e),l=this.value().transform[s]||0,h=this.getTranslation(0,e)["x"===s?0:1],c=n>0?1:-1,u=Math.max(1,Math.min(Math.abs(n),a*r))*c,p=Math.max(800,Math.min(2500,i));if(lt(l+u,h))"function"==typeof o?o(s,u,0,(()=>({duration:p,easing:U}))):this.apply(new G({[s]:l+u}),t({},Z,{easing:U,duration:p}));else{const e=ht(l+u,h)-l;let i=0;if(this.isDamping("translate")){const t=(lt(l,h)?Math.sqrt(1-Math.abs(e/u)):1)*(2*Math.abs(u)/p);i=Math.min(30*t,r/4)*c}if("function"==typeof o)o(s,e,i,(t=>({duration:(1-Math.sqrt(1-Math.abs(t/u)))*p,easing:U})));else{const n=Math.max((e+i)*c,0)*c,o=1-Math.sqrt(1-Math.abs(n/u));0===n?this.apply(new G({[s]:ht(l+n,h)}),t({},Z)):this.apply(new G({[s]:l+n}),t({},Z,{duration:o*p,easing:U})).then((()=>{this.apply(new G({[s]:ht(l+n,h)}),t({},Z))}))}}}}const ft=function(t,e){return new Promise(((i,n)=>{const s=new Image,o=()=>{s.onload=null,s.onprogress=null,s.onerror=null};s.onload=()=>{i(s),o()},s.onerror=t=>{n(t),o()},"function"==typeof e&&(s.onprogress=t=>e(t.loaded/t.total)),s.src=t}))},gt=function(t,e){return"function"==typeof e?function(t,e){return new Promise(((i,n)=>{const s=new XMLHttpRequest;s.onprogress=t=>{t.lengthComputable&&"function"==typeof e&&e(t)},s.onloadend=t=>{s.status>=200&&300>s.status||304===s.status?i(URL.createObjectURL(s.response)):n(t)},s.open("GET",t),s.responseType="blob",s.send()}))}(t,(t=>e(t.loaded/t.total))).then((t=>ft(t).then((e=>(URL.revokeObjectURL(t),e))))).catch((()=>ft(t))):ft(t)};let vt=class extends mt{constructor({container:t,style:e,className:i,src:n="",viewPosition:s,loading:o,error:r,active:a=!0}){let l=null;super({transitionEl:()=>null==l?void 0:l(),rotation:t=>t?void 0:[-Number.MAX_VALUE,Number.MAX_VALUE],scalation:t=>t?void 0:[.1,10]}),this._viewPosition=null,this._src="",this._active=!1,this._wrapper=I({className:["preview-image__image__wrapper",i||""],style:e},null,t),this._loading=o||null,this._error=r||null,this.setViewPosition(s),this.setSrc(n),this.setActive(a),l=()=>this.getImageElement()}getElement(){return this._wrapper}getImageElement(){return this._image||null}setActive(t=!0){this._active=t,t&&this.load()}setSrc(t){this._src=t||"",this._image=void 0;const e=this.getElement();if(e){e.innerHTML="";const t=this._loading;!1!==t&&e.appendChild(C(t)||I("span",{className:"preview-image__image__loading",style:{background:"url(data:image/svg+xml,%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2080%2080%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%20%20%3Cdefs%3E%20%20%20%20%3ClinearGradient%20%20%20%20%20%20x1%3D%2294.0869141%25%22%20%20%20%20%20%20y1%3D%220%25%22%20%20%20%20%20%20x2%3D%2294.0869141%25%22%20%20%20%20%20%20y2%3D%2290.559082%25%22%20%20%20%20%20%20id%3D%22linearGradient-1%22%20%20%20%20%3E%20%20%20%20%20%20%3Cstop%20stop-color%3D%22%23fff%22%20stop-opacity%3D%220%22%20offset%3D%220%25%22%20%2F%3E%20%20%20%20%20%20%3Cstop%20stop-color%3D%22%23fff%22%20stop-opacity%3D%220.3%22%20offset%3D%22100%25%22%20%2F%3E%20%20%20%20%3C%2FlinearGradient%3E%20%20%20%20%3ClinearGradient%20%20%20%20%20%20x1%3D%22100%25%22%20%20%20%20%20%20y1%3D%228.67370605%25%22%20%20%20%20%20%20x2%3D%22100%25%22%20%20%20%20%20%20y2%3D%2290.6286621%25%22%20%20%20%20%20%20id%3D%22linearGradient-2%22%20%20%20%20%3E%20%20%20%20%20%20%3Cstop%20stop-color%3D%22%23fff%22%20offset%3D%220%25%22%20%2F%3E%20%20%20%20%20%20%3Cstop%20stop-color%3D%22%23fff%22%20stop-opacity%3D%220.3%22%20offset%3D%22100%25%22%20%2F%3E%20%20%20%20%3C%2FlinearGradient%3E%20%20%3C%2Fdefs%3E%20%20%3Cg%20%20%20%20stroke%3D%22none%22%20%20%20%20stroke-width%3D%221%22%20%20%20%20fill%3D%22none%22%20%20%20%20fill-rule%3D%22evenodd%22%20%20%20%20opacity%3D%220.9%22%20%20%3E%20%20%20%20%3Cg%3E%20%20%20%20%20%20%3Cpath%20%20%20%20%20%20%20%20d%3D%22M40%2C0%20C62.09139%2C0%2080%2C17.90861%2080%2C40%20C80%2C62.09139%2062.09139%2C80%2040%2C80%20L40%2C73%20C58.2253967%2C73%2073%2C58.2253967%2073%2C40%20C73%2C21.7746033%2058.2253967%2C7%2040%2C7%20L40%2C0%20Z%22%20%20%20%20%20%20%20%20fill%3D%22url%28%23linearGradient-1%29%22%20%20%20%20%20%20%2F%3E%20%20%20%20%20%20%3Cpath%20%20%20%20%20%20%20%20d%3D%22M40%2C0%20L40%2C7%20C21.7746033%2C7%207%2C21.7746033%207%2C40%20C7%2C58.2253967%2021.7746033%2C73%2040%2C73%20L40%2C80%20C17.90861%2C80%200%2C62.09139%200%2C40%20C0%2C17.90861%2017.90861%2C0%2040%2C0%20Z%22%20%20%20%20%20%20%20%20fill%3D%22url%28%23linearGradient-2%29%22%20%20%20%20%20%20%2F%3E%20%20%20%20%20%20%3Ccircle%20id%3D%22Oval%22%20fill%3D%22%23fff%22%20cx%3D%2240.5%22%20cy%3D%223.5%22%20r%3D%223.5%22%20%2F%3E%20%20%20%20%3C%2Fg%3E%20%20%20%20%3CanimateTransform%20%20%20%20%20%20attributeName%3D%22transform%22%20%20%20%20%20%20begin%3D%220s%22%20%20%20%20%20%20dur%3D%221s%22%20%20%20%20%20%20type%3D%22rotate%22%20%20%20%20%20%20values%3D%220%2040%2040%3B360%2040%2040%22%20%20%20%20%20%20repeatCount%3D%22indefinite%22%20%20%20%20%2F%3E%20%20%3C%2Fg%3E%3C%2Fsvg%3E)"}})),this._active&&this.load()}}setViewPosition(t){this._viewPosition=t||null,this.resize()}load(){const t=this.getElement();t&&void 0===this._image&&(this._image=null,gt(this._src).then((e=>{this._image=e,this.resize(),t.innerHTML="",t.appendChild(e)})).catch((()=>{this._image=null,t.innerHTML="";const e=this._error;!1!==e&&t.appendChild(C(e)||I({className:"preview-image__image__error"},[I("span",{style:{background:"url(data:image/svg+xml,%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22%23fff%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%20%20%3Cpath%20%20%20%20d%3D%22M12%2022C6.477%2022%202%2017.523%202%2012S6.477%202%2012%202s10%204.477%2010%2010-4.477%2010-10%2010zm-.763-15.864l.11%207.596h1.305l.11-7.596h-1.525zm.759%2010.967c.512%200%20.902-.383.902-.882%200-.5-.39-.882-.902-.882a.878.878%200%2000-.896.882c0%20.499.396.882.896.882z%22%20%2F%3E%3C%2Fsvg%3E)"}}),I("span",{},"图片加载失败")]))})))}resize(){const t=this._image;if(t){const e=t.naturalWidth,i=t.naturalHeight,{x:n=0,y:s=0,w:o=0,h:r=0}=this._viewPosition||{},{elementWidth:a,elementHeight:l}=super.sizePosition({containerCenter:[n,s],containerWidth:o,containerHeight:r,naturalWidth:e,naturalHeight:i});t.width=a,t.height=l}}destory(){this._wrapper=null,this._image=void 0,this._viewPosition=null,this._loading=null,this._error=null}},_t=!1;function yt(t,{contextMenu:e}){if(!t.isTouching()){const i=this.currentItem();if(this.running()||null!=i&&i.running())return;const n=-this.activeIndex()*this.itemSize();if(0===Math.round(this.value().transform.default-n)){const{angle:n=0}=t;isNaN(n)?(_t||null==e||e(t),_t=!1,null==i||i.resetBounce(!1)):(_t=!0,null==i||i.moveBounce(!1,n,1,0,0))}}}function wt(t){if(!t.isTouching()){const e=this.currentItem();if(this.running()||null!=e&&e.running())return;const i=-this.activeIndex()*this.itemSize();if(0===Math.round(this.value().transform.default-i)){const{scale:i=1}=t;isNaN(i)?null==e||e.resetBounce(!1):null==e||e.moveBounce(!1,0,i,0,0)}}}function bt(t,{contextMenu:e}){if(t.isTouching()){const i=this.currentItem();if(this.running()||null!=i&&i.running())return;null==e||e(t)}}function Tt(t,{internalClose:e}){const i=this.currentItem();this.running()||null!=i&&i.running()||null==e||e(t)}function xt(e,{internalClose:i,slideBefore:n,slideAfter:s}){const o=this.currentItem();if(this.running()||null!=o&&o.running())return;const{direction:r}=e,a="Right"===r&&this.isHorizontal()||"Down"===r&&this.isVertical(),l=-this.activeIndex()*this.itemSize(),h=this.value().transform.default-l,c=(a&&0>h||!a&&h>0)&&0!==Math.round(h)?-h:0;if("inside"===this._moveTarget){if(o){const{velocity:i=0,swipeComputed:n}=e;if(i>0&&n){const i=this,s=(e,n,s,r)=>{if(0!==n){const{duration:a,easing:h}=r(n+s);0!==s?Promise.all([0!==c?i.apply(new G(l),t({},Z,{duration:a,easing:h,before:t=>Math.min(Math.abs(c+n+s)*t/Math.abs(c),1)})):Promise.resolve(),o.apply(new G({[e]:(o.value().transform[e]||0)+n}),t({},Z,{duration:a,easing:h,before:t=>Math.min(Math.max((Math.abs(c+n+s)*t-Math.abs(c))/Math.abs(n),0),1)})),i.apply(new G(l+s),t({},Z,{duration:a,easing:h,before:t=>Math.max((Math.abs(c+n+s)*t-Math.abs(c)-Math.abs(n))/Math.abs(s),0)}))]).then((()=>{i.apply(new G(l),t({},Z))})):(0!==c&&i.apply(new G(l),t({},Z,{duration:a,easing:h,before:t=>Math.min(Math.abs(c+n)*t/Math.abs(c),1)})),o.apply(new G({[e]:(o.value().transform[e]||0)+n}),t({},Z,{duration:a,easing:h,before:t=>Math.max((Math.abs(c+n)*t-Math.abs(c))/Math.abs(n),0)})))}else{const e=h>0?1:-1,n=Math.max((s-h)*e,0)*e,{duration:o,easing:a}=r(n);0===n?i.apply(new G(l),t({},Z)):i.apply(new G(l+h+n),t({},Z,{duration:o,easing:a})).then((()=>{i.apply(new G(l),t({},Z))}))}},{duration:r,stretchX:a,stretchY:u}=n(.003);if(this.isVertical()){const t=o.getXTranslation(0,e.isTouching());0===t[0]&&0===t[1]||o.swipeBounce(e.isTouching(),r,a,"x"),o.swipeBounce(e.isTouching(),r,u-c,"y",s)}else{o.swipeBounce(e.isTouching(),r,a-c,"x",s);const t=o.getYTranslation(0,e.isTouching());0===t[0]&&0===t[1]||o.swipeBounce(e.isTouching(),r,u,"y")}}}else this.slide(this.activeIndex(),{before:n,after:s});return}if("closures"===this._moveTarget){const t="Down"===r&&this.isHorizontal()||"Right"===r&&this.isVertical();return void(this.swipeClose()&&t&&null!=i&&i(e)&&(this._moveTarget="none"))}const u=this.itemSize(),p=0===u?0:-this.value().transform.default/u;this.slide(Math[a?"floor":"ceil"](p),{before:n,after:s})}function Dt(t){const e=this.currentItem();if(this.running()||null!=e&&e.running())return;const i=-this.activeIndex()*this.itemSize();0===Math.round(this.value().transform.default-i)&&(null==e||e.dblScale(t.isTouching(),t.getPoint()))}const Pt=["x","y"];function Et(i,{preventAllTap:n}){0===this._fgBehavior&&i.pointers.length>1&&(this._fgBehavior=2);let s=0;s+=this.cancel();const o=this.currentItem();if(s+=(null==o?void 0:o.cancel())||0,s>0){if(o){const n=o.value().transform,{x:s=0,y:r=0}=n,a=e(n,Pt),[l,h]=o.getTranslation(0,i.isTouching()),c=0===this.activeIndex(),u=this.activeIndex()===this.countItems()-1;this.isVertical()?lt(s,l)||(r>h[0]||u)&&(h[1]>r||c)||o.apply(new G(t({x:ht(s,l),y:r},a))):lt(r,h)||(s>l[0]||u)&&(l[1]>s||c)||o.apply(new G(t({x:s,y:ht(r,h)},a)))}null==n||n()}}const Mt=(t,[e,i],[n,s])=>t?Math.abs(e-n)>4*Math.abs(i-s)&&0>=e-n:Math.abs(i-s)>4*Math.abs(e-n)&&0>=i-s;function Ct(t,{openStyleChange:e}){0===this._fgBehavior&&1===t.pointers.length&&(this._fgBehavior=1);const i=this.currentItem();if(this.running()||null!=i&&i.running())return;const n=1===t.pointers.length||1===this._fgBehavior,s={max:this.itemSize()},{getPoint:o,direction:r,angle:a=0,scale:l=1,deltaX:h=0,deltaY:c=0,moveX:u=0,moveY:p=0}=t,d=o();if("none"===this._moveTarget){const e=o("previous");if(i){if(this._moveTarget="inside",n){const n=0===this.activeIndex(),s=this.activeIndex()===this.countItems()-1,o=Mt(this.isVertical(),e,d),{x:a=0,y:l=0}=i.value().transform,[u,p]=i.getTranslation(0,t.isTouching());if(this.isVertical())if(this.swipeClose()&&a>=u[1]&&o)this._moveTarget="closures";else{const t=0===u[0]&&0===u[1];(p[0]>=l&&(t?0>c:"Up"===r)&&!s||l>=p[1]&&(t?c>0:"Down"===r)&&!n)&&(this._moveTarget="outside")}else if(this.swipeClose()&&l>=p[1]&&o)this._moveTarget="closures";else{const t=0===p[0]&&0===p[1];(u[0]>=a&&(t?0>h:"Left"===r)&&!s||a>=u[1]&&(t?h>0:"Right"===r)&&!n)&&(this._moveTarget="outside")}}}else this._moveTarget=this.swipeClose()&&Mt(this.isVertical(),e,d)?"closures":"outside"}if("inside"===this._moveTarget){if(i){const e=-this.activeIndex()*this.itemSize(),o=ot(this.value().transform.default-e,s);let r=h,u=c;if(this.isVertical()?u+=o:r+=o,n){const{x:n=0,y:o=0}=i.value().transform,[a,l]=i.getTranslation(0,t.isTouching());let h=0;if(this.isVertical()){h=u,r=0===a[0]&&0===a[1]?0:r,u=ht(u+o,l)-o,h-=u}else{const t=0===l[0]&&0===l[1];h=r,r=ht(r+n,a)-n,u=t?0:u,h-=r}i.moveBounce(t.isTouching(),0,1,r,u,d),this.apply(new G(e+st(h,s)))}else i.moveBounce(t.isTouching(),a,l,r,u,d),0!==o&&this.apply(new G(e))}return}if("closures"===this._moveTarget)return void(null==e||e(((t,e)=>{const{w:i=0,h:n=0,x:s=0,y:o=0}=e,r=Math.min(Math.max(1-((this.isVertical()?u/i:p/n)||0),.3),1),a=.01+.99*(r-.3)/.7,{k:l=1,x:m=0,y:f=0}=t;return{o:a,k:r,x:m+h+(d[0]-(m+s))*(1-r/l),y:f+c+(d[1]-(f+o))*(1-r/l)}})));const m=[(1-this.countItems())*this.itemSize(),0];let f=ht(this.value().transform.default,m),g=f+ot(this.value().transform.default-f,s);f=ht(g+=this.isVertical()?c:h,m),g=f+st(g-f,s),this.apply(new G(g))}function It(t,{openStyleChange:e,slideBefore:i,slideAfter:n}){const s=this._moveTarget,o=1===t.leavePointers.length||1===this._fgBehavior;if(0===t.pointers.length)this._fgBehavior=0,this._moveTarget="none";else if(1===this._fgBehavior){if(!this.running()&&"outside"===s){const t=this.itemSize(),e=0===t?0:-this.value().transform.default/t;this.slide(Math.round(e),{before:i,after:n})}return}const r=this.currentItem();if(this.running()||null!=r&&r.running())return;if("closures"===s)return void(null==e||e((()=>({o:1,k:1,x:0,y:0,t:300}))));null==r||r.resetBounce(t.isTouching(),t.getPoint(),o);let a=this.activeIndex();if("outside"===s){const t=this.itemSize();a=Math.round(0===t?0:-this.value().transform.default/t)}this.slide(a,{before:i,after:n})}class kt extends Q{constructor({container:e,style:i,className:n,backdropStyle:s,backdropClassName:o,wrapperStyle:r,wrapperClassName:a,indicatorStyle:l,indicatorClassName:h,current:c=0,imageUrls:u=[],direction:p="horizontal",itemGap:d=20,isLazy:m=!0,hasIndicator:f=!0,destroyOnClose:g=!1,enableSwipeClose:v=!1,loading:_,error:y,clickPosition:w,onContextMenu:T,onChange:x,onAfterChange:D,onClose:k,onAfterClose:S,onAfterOpenChange:A}){let L=null;super({transitionEl:()=>null==L?void 0:L()}),this._openStyle=null,this._clickPosition=null,this._viewPosition=null,this._destoryOnClose=!1,this._itemGap=0;const z=u.length,F=c&&c>=0&&z>c?c:0,O=this._container=I({className:["preview-image__gallery__container","preview-image__gallery__container-"+p,n||""],style:i},null,C(e)||document.body),X=this._backdrop=I({className:["preview-image__gallery__backdrop",o||""],style:t({backgroundColor:"#000f"},s||{})},null,O),j=this._wrapper=I({className:["preview-image__gallery__wrapper",a||""],style:r},null,O),Y=this._indicator=f&&z>1?I({className:["preview-image__gallery__indicator",h||""],style:l},null,O):null,H=[];u.forEach(((t,e)=>{Y&&H.push(I("span",{className:["preview-image__gallery__indicator-item",F===e?"active":""]},null,Y));const i=new vt({container:j,src:t,active:!m||F===e,loading:_,error:y});super.itemModels(i,e)})),this.setClickPosition(w),this.setDestoryOnClose(g),this.setItemGap(d),this.setDirection(p),this.enableSwipeClose(v),this.slide(F,{duration:0,before:x,after:D});const B=new b(O),N=(t,e)=>{t.call(this,e,{preventAllTap:()=>{B.preventAllTap()},contextMenu:t=>{null==T||T(t)},internalClose:t=>{if("function"==typeof k)return k(t),!0},openStyleChange:t=>{this.openStyle(t(this._openStyle||{},this._viewPosition||{}))},slideBefore:t=>{super.itemModels().forEach(((e,i)=>{e.setActive(t===i);const n=H[i];i!==t&&P(n,"active")&&M(n,"active"),i!==t||P(n,"active")||E(n,"active")})),null==x||x(t)},slideAfter:t=>null==D?void 0:D(t)})};B.on("pointerStart",(t=>N(Et,t))),B.on("pointerMove",(t=>N(Ct,t))),B.on("pointerEnd",(t=>N(It,t))),B.on("doubleTap",(t=>N(Dt,t))),B.on("singleTap",(t=>N(Tt,t))),B.on("longTap",(t=>N(bt,t))),B.on("rotate",(t=>N(yt,t))),B.on("scale",(t=>N(wt,t))),B.on("swipe",(t=>N(xt,t)));const V=t=>{if(t.target===X&&"opacity"===t.propertyName){const{o:t,k:e,x:i,y:n,end:s,open:o=!1}=this._openStyle||{};s&&(o||null==S||S(),null==A||A(o)),this.openStyle({o:t,k:e,x:i,y:n}),null==s||s()}};X.addEventListener("transitionend",V,{capture:!1,passive:!1});const R=function(t,e=0){let i=0;return(...n)=>{i&&clearTimeout(i),i=+setTimeout((()=>{t.apply(null,n)}),e)}}((()=>this.updateViewPosition()),50);window.addEventListener("resize",R,{capture:!1,passive:!1}),this._unbind=()=>{B.destory(),X.removeEventListener("transitionend",V),window.removeEventListener("resize",R)},L=()=>j}updateViewPosition(){const t=this._viewPosition=ct(this._container);super.itemModels().forEach((e=>e.setViewPosition(t))),this.updateImageSize()}updateImageGap(){super.itemModels().forEach(((t,e)=>D(t.getElement(),{marginTop:this.isVertical()&&0!==e?this._itemGap:0,marginLeft:this.isVertical()||0===e?0:this._itemGap})))}updateImageSize(){let{w:t=0,h:e=0}=this._viewPosition||{},i=this.isVertical()?e:t;i=i?i+this._itemGap:0,super.itemSize(i);i=i*this.countItems()-this._itemGap,this.isVertical()?e=i:t=i,D(this._wrapper,{width:t,height:e})}setDestoryOnClose(t){this._destoryOnClose=t||!1}setClickPosition(t){this._clickPosition=t||null}setItemGap(t){this._itemGap=t||0,this.updateImageGap(),this.updateImageSize()}setDirection(t){const e=t||"horizontal";E(M(this._container,"preview-image__gallery__container-"+super.direction()),"preview-image__gallery__container-"+e),super.direction(e),this.updateImageGap(),this.updateImageSize()}currentItem(t=!0){const e=super.currentItem();return!t||null!=e&&e.getImageElement()?e:null}enableSwipeClose(t){super.swipeClose(t||!1)}destory(){var t,e;null==(t=this._unbind)||t.call(this),null==(e=this._container)||null==(e=e.parentNode)||e.removeChild(this._container),super.itemModels([]),this._indicator=null,this._backdrop=null,this._wrapper=null,this._container=null,this._openStyle=null,this._clickPosition=null,this._viewPosition=null,this._unbind=null}animateOpen(e,i){const n=this.currentItem(!1);null==n||n.reset();const{elementWidth:s=0,elementHeight:o=0}=(null==n?void 0:n.sizePosition())||{},{x:r=0,y:a=0,w:l=0,h:h=0}=this._viewPosition||{},{x:c=0,y:u=0,w:p=0,h:d=0}=this._clickPosition||{},m=0==s&&0===o?l:s,f=0==s&&0===o?h:o,g=m/f>p/d,v={o:0,k:(g?d/f:p/m)||.001,x:0===p&&0===d?0:c-r,y:0===p&&0===d?0:u-a,w:(g?f*(p/d):m)||0,h:(g?f:m/(p/d))||0},_={o:1,k:1,x:0,y:0,w:s,h:o};this.openStyle(t({},e?v:t({},_,this._openStyle))),ct(this._container),this.openStyle(t({},e?_:v,{t:300,end:i,open:e}))}openStyle(t){this._openStyle=t;const{o:e,k:i,x:n,y:s,w:o,h:r,t:a}=t;D(this._backdrop,{opacity:e,transition:a?`opacity ${a}ms`:""});const l=this.currentItem(!1);D(null==l?void 0:l.getElement(),{transform:`translate(${n}px,${s}px) scale(${i})`,transition:a?`transform ${a}ms`:"",overflow:1>(i||1)||a?"visible":void 0}),D(null==l?void 0:l.getImageElement(),{width:o||void 0,height:r||void 0,transition:a&&o&&r?`width ${a}ms, height ${a}ms`:"",objectFit:o&&r?"cover":void 0})}preventDefault(t=!0){t?(window.addEventListener("contextmenu",ut,{capture:!1,passive:!1}),window.addEventListener("touchstart",ut,{capture:!1,passive:!1}),window.addEventListener("wheel",ut,{capture:!1,passive:!1}),window.addEventListener("dragstart",ut,{capture:!1,passive:!1}),"onselectstart"in window.document.documentElement&&window.addEventListener("selectstart",ut,{capture:!1,passive:!1})):(window.removeEventListener("contextmenu",ut),window.removeEventListener("touchstart",ut),window.removeEventListener("wheel",ut),window.removeEventListener("dragstart",ut),"onselectstart"in window.document.documentElement&&window.removeEventListener("selectstart",ut))}open(){E(this._container,"visible"),this.preventDefault(!0),this.updateViewPosition(),this.animateOpen(!0,(()=>{E(this._indicator,"visible")}))}close(){M(this._indicator,"visible"),this.preventDefault(!1),this.animateOpen(!1,(()=>{this._destoryOnClose?this.destory():M(this._container,"visible")}))}}const St=function({urls:t=[],current:e="",clickPosition:i,onContextMenu:n}={}){const s=t.indexOf(e),o=new kt({current:s,imageUrls:t,destroyOnClose:!0,enableSwipeClose:!0,onClose:()=>{o.close()},clickPosition:i,onContextMenu:n});o.open()};export{kt as Gallery,vt as Image,mt as ItemModel,Q as SwiperModel,Z as defaultAnimationExtendOptions,St as previewImage};
//# sourceMappingURL=preview-image.min.js.map
