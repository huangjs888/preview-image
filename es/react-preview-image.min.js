import*as t from"react";import e from"react";import n from"react-dom";function i(){return i=Object.assign?Object.assign.bind():function(t){for(var e=1;arguments.length>e;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},i.apply(this,arguments)}function s(t,e){if(null==t)return{};var n,i,s={},r=Object.keys(t);for(i=0;r.length>i;i++)0>e.indexOf(n=r[i])&&(s[n]=t[n]);return s}const r=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement)?e.useLayoutEffect:e.useEffect;function o(t,e,n){r((()=>{if(t){const i=t=>{"function"==typeof n&&n.call(null,t)};return t.on(e,i),()=>{t.off(e,i)}}return()=>{}}),[n,t])}class a{constructor(){this.events={},this.events={}}one(t,e,n){const i="function"==typeof e?(...s)=>{e.apply(null,s),this.off(t,i,n)}:e;this.on(t,i,n)}on(t,e,n){const i=this.events[t]||{pool:[],single:-1};if("function"==typeof e)if(n)-1===i.single?i.single=i.pool.push(e)-1:i.pool[i.single]=e;else{let t=!0;for(let n=0,s=i.pool.length;s>n;n++)if(i.pool[n]===e&&n!==i.single){t=!1;break}t&&i.pool.push(e)}else n&&-1!==i.single&&(i.pool.splice(i.single,1),i.single=-1);this.events[t]=i}off(t,e,n){if(void 0===t)this.events={};else if(void 0===e)delete this.events[t];else if(n){const e=this.events[t];e&&-1!==e.single&&(e.pool.splice(e.single,1),e.single=-1)}else{const n=this.events[t];if(n)for(let t=n.pool.length-1;t>=0;t--)if(n.pool[t]===e&&t!==n.single){n.pool.splice(t,1);break}}}emit(t,e){const n=this.events[t];if(n)for(let i=0,s=n.pool.length;s>i;i++){const s=n.pool[i];if("function"==typeof s){if(!1===s.call(null,e,t))break}}}}const l=(t,e)=>{let n=t;for(;n&&n!==e;)n=n.parentNode;return!!n};function h(t,e,n){return"number"!=typeof t||n>t?e:t}function c(){return window.navigator.maxTouchPoints||"ontouchstart"in window.document}function u(t,e=!1){if(t.touches){if(e){const e=Array.prototype.filter.call(t.touches,(e=>l(e.target,t.currentTarget))).map((t=>({pageX:t.pageX,pageY:t.pageY,identifier:t.identifier})));return{points:e,isFirst:t.changedTouches.length===e.length}}return{points:Array.prototype.slice.call(t.changedTouches||[]).map((t=>({pageX:t.pageX,pageY:t.pageY,identifier:t.identifier})))}}return{points:[{pageX:t.pageX,pageY:t.pageY,identifier:-1}],isFirst:e}}function p([t,e],[n,i]){return"number"==typeof t&&"number"==typeof n&&"number"==typeof e&&"number"==typeof i?Math.sqrt(Math.pow(n-t,2)+Math.pow(i-e,2)):0}function d([t,e],[n,i]){return"number"==typeof t&&"number"==typeof n&&"number"==typeof e&&"number"==typeof i?180*Math.atan2(i-e,n-t)/Math.PI:0}function f([t,e],[n,i]){const s="number"==typeof t&&"number"==typeof e,r="number"==typeof n&&"number"==typeof i;return s||r?s&&!r?[t,e]:!s&&r?[n,i]:[(t+n)/2,(e+i)/2]:[0,0]}function m([t,e],[n,i]){if("number"==typeof t&&"number"==typeof n&&"number"==typeof e&&"number"==typeof i){const s=t-n,r=e-i;if(s!==r)return Math.abs(r)>Math.abs(s)?e-i>0?"Up":"Down":t-n>0?"Left":"Right"}return"None"}let g=class extends a{constructor(t){super(),this.wheelDelay=350,this.longTapInterval=750,this.doubleTapInterval=250,this.doubleTapDistance=30,this.touchMoveDistance=3,this.swipeVelocity=.3,this.swipeDuration=100,this.raiseDuration=100,this._rotateAngle=0,this._singleTapTimer=0,this._longTapTimer=0,this._wheelTimerEnd=null,this._preventTap=!0,this._swipePoints=null,this._preventSingleTap=!0,this._preventDoubleTap=!0,this._firstPointer=null,this._pointer0=null,this._pointer1=null,this.resetOptions(t)}resetOptions(t){const{wheelDelay:e,longTapInterval:n,doubleTapInterval:i,doubleTapDistance:s,touchMoveDistance:r,swipeVelocity:o,swipeDuration:a,raiseDuration:l}=t||{};this.wheelDelay=h(e,350,1),this.longTapInterval=h(n,750,1),this.doubleTapInterval=h(i,250,1),this.doubleTapDistance=h(s,30,1),this.touchMoveDistance=h(r,3,0),this.swipeVelocity=h(o,.3,0),this.swipeDuration=h(a,100,1),this.raiseDuration=h(l,100,1)}preventAllTap(t=!0){this._preventTap=!0,this._preventSingleTap=!0,this._preventDoubleTap=!0,t&&(this._firstPointer=null),this._longTapTimer&&(clearTimeout(this._longTapTimer),this._longTapTimer=0)}};function v(t){const e={sourceEvent:t,timestamp:Date.now(),pointers:[],leavePointers:[],getPoint:()=>[0,0]},{points:n,isFirst:i}=u(t,!0);i?(this._wheelTimerEnd&&(clearTimeout(this._wheelTimerEnd.timer),this._wheelTimerEnd.wheelEnd(),this._wheelTimerEnd=null),this._pointer0=null,this._pointer1=null):(this._pointer0&&(this._pointer0.changed=!1),this._pointer1&&(this._pointer1.changed=!1));for(let t=0,e=n.length;e>t;++t){const e=n[t],i=[e.pageX,e.pageY],s={start:i,previous:i,current:i,identifier:e.identifier,changed:!0};this._pointer0?this._pointer1||this._pointer0.identifier===e.identifier||(this._pointer1=s):this._pointer0=s}this.preventAllTap(!1),this._swipePoints=null,this._rotateAngle=0;const s=this._pointer0,r=this._pointer1;if(r&&s)this._firstPointer=null,e.pointers=[s,r],e.getPoint=()=>f(s.current,r.current),this.emit("gestureStart",e);else{if(!s)return;{e.pointers=[s],e.getPoint=()=>s.current,this._preventTap=!1,this._longTapTimer=+setTimeout((()=>{this._preventTap=!0,this._preventSingleTap=!0,this._preventDoubleTap=!0,this._longTapTimer=0,this._firstPointer=null,e.waitTime=this.longTapInterval,this.emit("longTap",e)}),this.longTapInterval);const t=this._firstPointer,n=this._singleTapTimer;n&&t&&p(t.current,s.current)<this.doubleTapDistance?(clearTimeout(n),this._singleTapTimer=0,this._preventSingleTap=!0,this._preventDoubleTap=!1,e.getPoint=()=>t.current):(this._firstPointer=s,this._preventSingleTap=!1,this._preventDoubleTap=!0)}}this.emit("pointerStart",e)}function _(t){const e={sourceEvent:t,timestamp:Date.now(),pointers:[],leavePointers:[],getPoint:()=>[0,0]};this._pointer0&&(this._pointer0.changed=!1),this._pointer1&&(this._pointer1.changed=!1);const{points:n}=u(t);for(let t=0,e=n.length;e>t;++t){const e=n[t],i=[e.pageX,e.pageY];this._pointer0&&this._pointer0.identifier===e.identifier?(this._pointer0.changed=!0,this._pointer0.previous=this._pointer0.current,this._pointer0.current=i):this._pointer1&&this._pointer1.identifier===e.identifier&&(this._pointer1.changed=!0,this._pointer1.previous=this._pointer1.current,this._pointer1.current=i)}const i=this._pointer0,s=this._pointer1;if(i&&p(i.start,i.current)>this.touchMoveDistance||s&&p(s.start,s.current)>this.touchMoveDistance){if(this.preventAllTap(),s&&i){e.pointers=[i,s];const{start:t,previous:n,current:r}=i,{start:o,previous:a,current:l}=s,h=f(r,l),c=f(n,a),u=f(t,o);e.getPoint=t=>"start"===t?u:"previous"===t?c:h,e.direction=m(c,h),e.moveDirection=m(u,h),e.deltaX=h[0]-c[0],e.moveX=h[0]-u[0],e.deltaY=h[1]-c[1],e.moveY=h[1]-u[1];const g=p(r,l),v=p(n,a),_=p(t,o);_>0&&g>0&&v>0&&(e.scale=g/v,e.moveScale=g/_);let y=d(r,l)-d(n,a);-180>y?y+=360:y>180&&(y-=360),e.angle=y,this._rotateAngle+=y,e.moveAngle=this._rotateAngle,this.emit("rotate",e),_>0&&g>0&&v>0&&this.emit("scale",e),this.emit("multiPan",e),this.emit("gestureMove",e)}else{if(!i)return;{e.pointers=[i];const{start:t,previous:n,current:s}=i;e.getPoint=e=>"start"===e?t:"previous"===e?n:s,e.direction=m(n,s),e.moveDirection=m(t,s),e.deltaX=s[0]-n[0],e.moveX=s[0]-t[0],e.deltaY=s[1]-n[1],e.moveY=s[1]-t[1];const r=Date.now(),o=this._swipePoints||[[],[]];r-((o[1][0]?o[1][0].timestamp:0)||0)>this.swipeDuration&&(o[0]=o[1],o[1]=[]),o[1].push({point:s,timestamp:r}),this._swipePoints=o,this.emit("pan",e)}}this.emit("pointerMove",e)}}function y(t){const e={sourceEvent:t,timestamp:Date.now(),pointers:[],leavePointers:[],getPoint:()=>[0,0]};let n=null,i=null;this._pointer0&&(this._pointer0.changed=!1),this._pointer1&&(this._pointer1.changed=!1);const{points:s}=u(t);for(let t=0,e=s.length;e>t;++t){const e=s[t];this._pointer0&&this._pointer0.identifier===e.identifier?(this._pointer0.changed=!0,n=this._pointer0,this._pointer0=null):this._pointer1&&this._pointer1.identifier===e.identifier&&(this._pointer1.changed=!0,i=this._pointer1,this._pointer1=null)}if(this._pointer1&&!this._pointer0&&(this._pointer0=this._pointer1,this._pointer1=null,i=n,n=null),this._longTapTimer&&(clearTimeout(this._longTapTimer),this._longTapTimer=0),this._pointer0){e.pointers=[this._pointer0],this._pointer1?e.pointers.push(this._pointer1):i&&(e.leavePointers=[i],this._rotateAngle=0);const t=f(this._pointer0.start,this._pointer1?this._pointer1.start:i?i.start:[]),n=f(this._pointer0.previous,this._pointer1?this._pointer1.previous:i?i.previous:[]),s=f(this._pointer0.current,this._pointer1?this._pointer1.current:i?i.current:[]);e.getPoint=e=>"start"===e?t:"previous"===e?n:s,this.emit("gestureEnd",e)}else if(n){e.leavePointers=[n],i&&e.leavePointers.push(i);const t=i?f(n.start,i.start):n.start,s=i?f(n.previous,i.previous):n.previous,a=i?f(n.current,i.current):n.current;if(e.getPoint=e=>"start"===e?t:"previous"===e?s:a,this._preventTap||(this.emit("tap",e),this._preventTap=!0),this._preventSingleTap||(this._singleTapTimer=+setTimeout((()=>{this._singleTapTimer=0,e.delayTime=this.doubleTapInterval,this.emit("singleTap",e)}),this.doubleTapInterval),this._preventSingleTap=!0),!this._preventDoubleTap){const t=this._firstPointer;t&&(e.getPoint=()=>t.current),e.intervalTime=this.doubleTapInterval,this.emit("doubleTap",e),this._firstPointer=null,this._preventDoubleTap=!0}if(this._swipePoints){const[t,n]=this._swipePoints,i=n[n.length-1];if(Date.now()-i.timestamp<=this.raiseDuration){let s=n[0];for(let e=t.length-1;e>=0&&i.timestamp-t[e].timestamp<=this.swipeDuration;e--)s=t[e];const a=(r=i.timestamp-s.timestamp,"number"!=typeof(o=p(s.point,i.point))||0===o||"number"!=typeof r||0===r?0:o/r);if(a>this.swipeVelocity){const t=d(s.point,i.point);e.direction=m(s.point,i.point),e.angle=t,e.velocity=a,e.swipeComputed=(e,n=a)=>{let i=0,s=0,r=0;e>1?(i=e,s=n/i,r=n*i/2):e>0&&(s=e,i=n/s,r=n*n/(2*s));const[o,l]=function(t,e){if("number"!=typeof t||"number"!=typeof e)return[0,0];const n=e*Math.PI/180;return[t*Math.cos(n),t*Math.sin(n)]}(r,t);return{duration:i,stretchX:o,stretchY:l,deceleration:s}},this.emit("swipe",e),this._swipePoints=null}}}}var r,o;this.emit("pointerEnd",e)}function w(t){this.emit("pointerCancel",{sourceEvent:t,timestamp:Date.now(),pointers:[],leavePointers:[],getPoint:()=>[0,0]}),y.call(this,t)}function b(t){const e=this;function n(){"undefined"!=typeof window&&(window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",o),window.removeEventListener("blur",i),window.removeEventListener("dragstart",s),"onselectstart"in window.document.documentElement&&window.removeEventListener("selectstart",s))}function i(t){t.preventDefault(),t.stopPropagation(),n()}function s(t){t.preventDefault(),t.stopPropagation()}function r(n){if(0===t.button)_.call(e,n);else{const i={sourceEvent:t,timestamp:Date.now(),pointers:[],leavePointers:[],getPoint:()=>[0,0]},s=[n.pageX,n.pageY];if(e._pointer0){e._pointer0.previous=e._pointer0.current,e._pointer0.current=s,i.pointers=[e._pointer0];const{start:t,previous:n,current:r}=e._pointer0;i.getPoint=e=>"start"===e?t:"previous"===e?n:r,i.direction=m(n,r),i.moveDirection=m(t,r),i.deltaX=r[0]-n[0],i.moveX=r[0]-t[0],i.deltaY=r[1]-n[1],i.moveY=r[1]-t[1],i.angle=i.deltaX/4,i.moveAngle=i.moveX/4,e.emit("rotate",i)}}}function o(i){if(n(),0===t.button)y.call(e,i);else{const n={sourceEvent:t,timestamp:Date.now(),pointers:[],leavePointers:[],getPoint:()=>[0,0]},s=[i.pageX,i.pageY];if(e._pointer0){const t=e._pointer0;e._pointer0=null,t.previous=t.current,t.current=s,n.leavePointers=[t];const{start:i,previous:r,current:o}=t;n.getPoint=t=>"start"===t?i:"previous"===t?r:o}n.angle=NaN,e.emit("rotate",n)}}if("undefined"!=typeof window&&(window.addEventListener("mousemove",r),window.addEventListener("mouseup",o),window.addEventListener("blur",i),window.addEventListener("dragstart",s,{capture:!0,passive:!1}),"onselectstart"in window.document.documentElement&&window.addEventListener("selectstart",s,{capture:!0,passive:!1})),0===t.button)v.call(e,t);else{e._wheelTimerEnd&&(clearTimeout(e._wheelTimerEnd.timer),e._wheelTimerEnd.wheelEnd(),e._wheelTimerEnd=null);const n=[t.pageX,t.pageY];e._pointer0={start:n,previous:n,current:n,identifier:-1,changed:!0}}}function T(t){const e={sourceEvent:t,timestamp:Date.now(),pointers:[],leavePointers:[],getPoint:()=>[0,0]},n=[t.pageX,t.pageY];this._wheelTimerEnd?(this._pointer0&&(this._pointer0.previous=this._pointer0.current,this._pointer0.current=n),clearTimeout(this._wheelTimerEnd.timer)):this._pointer0={start:n,previous:n,current:n,identifier:-1,changed:!0};const i=()=>{this._pointer0=null,this._wheelTimerEnd=null,e.timestamp=Date.now(),e.scale=NaN,this.emit("scale",e)};if(this._wheelTimerEnd={wheelEnd:i,timer:+setTimeout(i,this.wheelDelay),scale:this._wheelTimerEnd?this._wheelTimerEnd.scale:1},this._pointer0){e.pointers=[this._pointer0];const{start:n,previous:i,current:s}=this._pointer0;e.getPoint=t=>"start"===t?n:"previous"===t?i:s;const r=Math.pow(2,-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002));this._wheelTimerEnd.scale*=r,e.moveScale=this._wheelTimerEnd.scale,e.scale=r,this.emit("scale",e)}}const x=["children","options","preventAllTap"];var M=e.forwardRef(((t,a)=>{let{children:l,options:h,preventAllTap:u}=t,p=s(t,x);const d=e.useRef(null),f=e.useRef(null);r((()=>{f.current=new g}),[]),r((()=>{f.current&&f.current.resetOptions(h)}),[h]),r((()=>{u&&f.current&&f.current.preventAllTap()}),[u]),function(t,e){const{onPan:n,onTap:i,onSwipe:s,onSingleTap:r,onLongTap:a,onDoubleTap:l,onMultiPan:h,onScale:c,onRotate:u,onPointerStart:p,onPointerMove:d,onPointerEnd:f,onPointerCancel:m,onGestureStart:g,onGestureMove:v,onGestureEnd:_}=t;o(e,"pan",n),o(e,"tap",i),o(e,"swipe",s),o(e,"singleTap",r),o(e,"longTap",a),o(e,"doubleTap",l),o(e,"multiPan",h),o(e,"scale",c),o(e,"rotate",u),o(e,"pointerStart",p),o(e,"pointerMove",d),o(e,"pointerEnd",f),o(e,"pointerCancel",m),o(e,"gestureStart",g),o(e,"gestureMove",v),o(e,"gestureEnd",_)}(p,f.current),e.useImperativeHandle(a,(()=>({findDOMElement:()=>d.current,getInstance:()=>f.current})),[]);const m=e.useCallback((t=>{let i=t;!(t instanceof Element)&&t instanceof e.Component&&(i=n.findDOMNode(t)),i instanceof Element||(i=null),d.current=i}),[]);return l?e.Children.only(e.cloneElement(l,i({ref:m},c()?{onTouchStart:f.current&&v.bind(f.current),onTouchMove:f.current&&_.bind(f.current),onTouchEnd:f.current&&y.bind(f.current),onTouchCancel:f.current&&w.bind(f.current)}:{onMouseDown:f.current&&b.bind(f.current),onWheel:f.current&&T.bind(f.current)}))):(console.warn("Warning: Gesture children must exist."),null)}));let E;function P(t){if("undefined"==typeof document)return 0;if(t||void 0===E){const t=document.createElement("div");t.style.width="100%",t.style.height="200px";const e=document.createElement("div"),n=e.style;n.position="absolute",n.top="0",n.left="0",n.pointerEvents="none",n.visibility="hidden",n.width="200px",n.height="150px",n.overflow="hidden",e.appendChild(t),document.body.appendChild(e);const i=t.offsetWidth;e.style.overflow="scroll";let s=t.offsetWidth;i===s&&(s=e.clientWidth),document.body.removeChild(e),E=i-s}return E}function S(t){const e=t.match(/^(.*)px$/),n=Number(null==e?void 0:e[1]);return Number.isNaN(n)?P():n}const D=/^(?:-border(?:-top|-right|-bottom|-left)?(?:-width|)|(?:-margin|-padding)?(?:-top|-right|-bottom|-left)?|(?:-min|-max)?(?:-width|-height))$/;function k(t){if(t){const{left:e,top:n,width:i,height:s}=t.getBoundingClientRect();return{left:e,top:n,width:i,height:s}}return{left:0,top:0,width:0,height:0}}function I(t,n=((t,e)=>t!==e)){const i=e.useRef(t),s=n(i.current,t);return s&&(i.current=t),s}function C(t,n=((t,e)=>I(e)?e:t)){const i="function"==typeof t?t():t,s=e.useRef(i);s.current=n(s.current,i);const r=function(){const t=e.useState({})[1];return e.useCallback((()=>t({})),[t])}(),o=e.useCallback((t=>{const e="function"==typeof t?t(s.current):t;e!==s.current&&(s.current=e,r())}),[r]);return[s.current,o]}function A(){return!("undefined"==typeof window||!window.document||!window.document.createElement)}const z=A()?e.useLayoutEffect:e.useEffect,O="undefined"==typeof window?global:window,X=["moz","webkit"];let Y=O.requestAnimationFrame,j=O.cancelAnimationFrame||O.cancelRequestAnimationFrame;if(!Y||!j)for(var B=0;2>B;B++)Y=O[X[B]+"RequestAnimationFrame"],j=O[X[B]+"CancelAnimationFrame"]||O[X[B]+"CancelRequestAnimationFrame"];Y&&j||(Y=function(){let t=0;return function(e){const n=Date.now(),i=Math.max(0,16-(n-t));return t=n+i,window.setTimeout(e,i)}}(),j=function(t){return window.clearTimeout(t)});const R=Y,H=j,N=(t,e)=>e>0?+setTimeout(t,e):(t(Math.abs(e)),0);class W{constructor({duration:t,easing:e,delay:n}={}){this._delay=0,this._frameId=0,this._elapsed=0,this._sleepId=0,this._delayId=0,this._tick=null,this._delayFn=null,this.duration="number"==typeof t&&t>0?t:0,this.easing="function"!=typeof e?t=>t:e,this.delay="number"!=typeof n?0:n}start(t){if(!this._tick&&!this._delayFn){const{duration:e,easing:n,delay:i}=this;this._delayFn=i=>{if(this._delayId=0,this._delayFn=null,this._delay=0,e>0){const s=i=>{const r=Date.now();this._elapsed+=r-i,e>this._elapsed?(this._frameId=R((()=>s(r))),t(n(this._elapsed/e))):(this._tick=null,this._frameId=0,this._elapsed=0,t(1))};this._tick=s,this._elapsed=i||0,s(Date.now())}else t(1)},this._delay=Date.now(),this._delayId=N(this._delayFn,i)}}restart(){if((this._tick||this._delayFn)&&(this.stop(),this._tick&&this._tick(Date.now()),this._delayFn)){const t=this.delay+this._delay;this._delay+=Date.now(),this._delayId=N(this._delayFn,t)}}sleep(t){t&&t>0&&(this._tick||this._delayFn)&&(this.stop(),this._sleepId=+setTimeout((()=>{this._sleepId=0,this.restart()}),t))}stop(){(this._tick||this._delayFn)&&(this._delayId&&(clearTimeout(this._delayId),this._delayId=0,this._delay-=Date.now()),this._frameId&&(H(this._frameId),this._frameId=0),this._sleepId&&(clearTimeout(this._sleepId),this._sleepId=0))}end(){(this._tick||this._delayFn)&&(this.stop(),this._tick&&this._tick(Date.now()+this._elapsed-this.duration),this._delayFn&&this._delayFn(this.duration))}}class L{constructor(t,e,n){const i=this.value="number"==typeof t?{default:t}:t;if("number"==typeof e){const t={};Object.keys(i).forEach((n=>{t[n]=e||0})),this.precision=t}else e&&(this.precision=e);"function"==typeof n&&(this.transform=n)}toRaw(){const t={value:this.value};return this.precision&&(t.precision=this.precision),this.transform&&(t.transform=this.transform),t}}const F=["value","precision"];const $=["value"],V=["before","after","cancel"];let q=class{constructor({cssProperties:t,apply:e}={}){this.cssProperties={},this._cssProperties=null,this._animations=[],this._apply=e||(()=>{}),t&&this.apply(t)}update(){!this.running()&&this._cssProperties&&(this.cssProperties=this._cssProperties,this._cssProperties=null);const{cssProperties:t}=this,e={};Object.keys(t).forEach((n=>{const{value:i,transform:s}=t[n];e[n.replace(/([A-Z])/g,"-$1").toLocaleLowerCase()]=s(i)})),this._apply(e)}value(){const t=this._cssProperties||this.cssProperties,e={};return Object.keys(t).forEach((n=>{e[n]=t[n].value})),e}apply(t,e){this._cssProperties||(this._cssProperties=this.cssProperties);const n=function(t,e){const n=i({},t);if(e instanceof L){const s=Object.keys(t)[0];if(s){const r=t[s],o=e.toRaw();n[s]=i({},r,o,{value:i({},r.value,o.value)})}}else Object.keys(e).forEach((s=>{const r=t[s],o=e[s].toRaw();n[s]=r?i({},r,o,{value:i({},r.value,o.value)}):i({transform:t=>Object.keys(t).map((e=>t[e])).join(" "),precision:{}},o)}));return n}(this._cssProperties,t),r=function(t,e){const n={};return Object.keys(t).forEach((r=>{const o=t[r].value,a=e[r],{value:l,precision:h}=a,c=s(a,F);let u=null;Object.keys(o).forEach((t=>{const e=l[t]-o[t];Math.abs(e)>(h[t]||0)&&(u||(u={}),u[t]=e)})),u&&(n[r]=i({value:u,precision:h},c))})),n}(this._cssProperties,n);this._cssProperties=n;const o=Object.keys(r),a={};o.forEach((t=>{const e=r[t],{value:n}=e,o=s(e,$);a[t]=i({value:i({},n)},o),this.cssProperties[t]=i({},this.cssProperties[t],o)}));const l=e&&0!==o.length?e:{};return new Promise((t=>{const{before:e=(()=>{}),after:n=(()=>{}),cancel:i=!0}=l,h=s(l,V),c=new W(h);this._animations.push({animation:c,cancel:i,remain:a}),c.start((i=>{const s=e(i,this.value());if(!1!==s){let t=i;"number"==typeof s&&(t=s),o.forEach((e=>{const n=this.cssProperties[e].value,i=r[e].value,s=a[e].value;Object.keys(i).forEach((e=>{const r=i[e]*(1-t);n[e]+=s[e]-r,s[e]=r}))})),this.update()}if(n(i,this.value()),1===i){const e=this._animations.findIndex((t=>c===t.animation));-1!==e&&this._animations.splice(e,1),this.update(),t(this.value())}}))}))}cancel(t=!1){let e=0;return this._animations=this._animations.filter((({animation:n,remain:i,cancel:s})=>{if(s){n[t?"end":"stop"](),e+=1;const s=this._cssProperties;return s&&Object.keys(i).forEach((t=>{if(s[t]){const e=i[t].value,n=s[t].value;Object.keys(e).forEach((t=>{n[t]-=e[t]}))}})),!1}return!0})),this.update(),e}running(){return 0!==this._animations.length}};class G extends q{constructor(t,e){super(i({apply:e=>function(t,e){if(t&&e){let n="";Object.keys(e).forEach((i=>{const s=i.replace(/([A-Z])/g,"-$1").toLocaleLowerCase(),r=e[i];if(r||0===r){const t="number"==typeof r&&/^[a-z]/.test(s)&&D.test("-"+s)?"px":"";n+=`${s}: ${r}${t};`}else t.style.removeProperty(s)})),t.style.cssText+=n}return t}(function(t){let e=t;return"string"==typeof t&&(e=document.querySelector(t)),"function"==typeof t&&(e=t()),e||null}(t),e)},e||{}))}}const U=t=>1-(1-t)*(1-t),Z={cancel:!0,duration:500,easing:t=>1-(1-t)*(1-t)*(1-t)*(1-t)},J=["direction","itemModels","itemSize","enableSwipeClose","transitionEl"],K=["before","after"];class Q extends G{constructor(t={}){let{direction:e,itemModels:n,itemSize:i,enableSwipeClose:r,transitionEl:o}=t;super(o||null,s(t,J)),this._direction="horizontal",this._itemModels=[],this._itemSize=0,this._activeIndex=-1,this._enableSwipeClose=!0,this._fgBehavior=0,this._moveTarget="none",this.apply({transform:new L(0,1,(t=>`translateX(${t.default}px)`))}),this.swipeClose(r),this.direction(e),this.itemSize(i),this.itemModels(n)}activeIndex(){return this._activeIndex}isHorizontal(){return"horizontal"===this._direction}isVertical(){return"vertical"===this._direction}swipeClose(t){return void 0!==t&&(this._enableSwipeClose=t),this._enableSwipeClose}direction(t){if(t){this._direction=t;const e="vertical"===t?"Y":"X";this.apply(new L(0,1,(t=>`translate${e}(${t.default}px)`)))}return this._direction}itemSize(t){return void 0!==t&&(this._itemSize=t,this.apply(new L(-this.activeIndex()*t))),this._itemSize}itemModels(t,e){return void 0===t?this._itemModels:"number"==typeof t?this._itemModels[t]:Array.isArray(t)?(this._itemModels=t,t):(this._itemModels[e||0]=t,t)}currentItem(){return this.itemModels(this.activeIndex())}countItems(){return this.itemModels().length}slide(t,e={}){const{before:n,after:r}=e,o=s(e,K),a=Math.max(Math.min(t,this.countItems()-1),0),l=this.activeIndex()!==a;l&&(this._activeIndex=a,null==n||n(a));const h=-a*this.itemSize();return this.apply(new L(h),i({},Z,o)).then((()=>(l&&(null==r||r(a)),a)))}next(t){return this.slide(this._activeIndex+1,t)}prev(t){return this.slide(this._activeIndex-1,t)}}const tt=Math.PI/180,et={multiply:function(t,e,n){const i=e[0],s=e[4],r=e[8],o=e[12],a=e[1],l=e[5],h=e[9],c=e[13],u=e[2],p=e[6],d=e[10],f=e[14],m=e[3],g=e[7],v=e[11],_=e[15],y=n[0],w=n[1],b=n[2],T=n[3],x=n[4],M=n[5],E=n[6],P=n[7],S=n[8],D=n[9],k=n[10],I=n[11],C=n[12],A=n[13],z=n[14],O=n[15];t[0]=i*y+s*x+r*S+o*C,t[4]=i*w+s*M+r*D+o*A,t[8]=i*b+s*E+r*k+o*z,t[12]=i*T+s*P+r*I+o*O,t[1]=a*y+l*x+h*S+c*C,t[5]=a*w+l*M+h*D+c*A,t[9]=a*b+l*E+h*k+c*z,t[13]=a*T+l*P+h*I+c*O,t[2]=u*y+p*x+d*S+f*C,t[6]=u*w+p*M+d*D+f*A,t[10]=u*b+p*E+d*k+f*z,t[14]=u*T+p*P+d*I+f*O,t[3]=m*y+g*x+v*S+_*C,t[7]=m*w+g*M+v*D+_*A,t[11]=m*b+g*E+v*k+_*z,t[15]=m*T+g*P+v*I+_*O},identity:function(t){for(let e=0;16>e;e++)t[e]=0;for(let e=0;16>e;e+=5)t[e]=1},translate:function(t,e,n,i){for(let s=0;4>s;s++)t[12+s]+=t[s]*e+t[4+s]*n+t[8+s]*i},scale:function(t,e,n,i){for(let s=0;4>s;s++)t[s]*=e,t[4+s]*=n,t[8+s]*=i},rotate:function(t,e,n,i,s){const r=new Float32Array(16);r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1;const o=e*tt,a=Math.sin(o),l=Math.cos(o);if(1===n&&0===i&&0===s)r[5]=l,r[10]=l,r[6]=a,r[9]=-a,r[1]=0,r[2]=0,r[4]=0,r[8]=0,r[0]=1;else if(0===n&&0===i&&0===s)r[0]=l,r[10]=l,r[8]=a,r[2]=-a,r[1]=0,r[4]=0,r[6]=0,r[9]=0,r[5]=1;else if(0===n&&0===i&&1===s)r[0]=l,r[5]=l,r[1]=a,r[4]=-a,r[2]=0,r[6]=0,r[8]=0,r[9]=0,r[10]=1;else{const t=Math.sqrt(n*n+i*i+s*s);if(1!==t){const e=1/t;n*=e,i*=e,s*=e}const e=1-l,o=n*i,h=i*s,c=s*n,u=n*a,p=i*a,d=s*a;r[0]=n*n*e+l,r[4]=o*e-d,r[8]=c*e+p,r[1]=o*e+d,r[5]=i*i*e+l,r[9]=h*e-u,r[2]=c*e-p,r[6]=h*e+u,r[10]=s*s*e+l}et.multiply(t,t,r)},rotateEuler:function(t,e,n,i){const s=new Float32Array(16),r=e*tt,o=n*tt,a=i*tt,l=Math.cos(r),h=Math.sin(r),c=Math.cos(o),u=Math.sin(o),p=Math.cos(a),d=Math.sin(a),f=l*u,m=h*u;s[0]=c*p,s[1]=-c*d,s[2]=u,s[3]=0,s[4]=f*p+l*d,s[5]=-f*d+l*p,s[6]=-h*c,s[7]=0,s[8]=-m*p+h*d,s[9]=m*d+h*p,s[10]=l*c,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,et.multiply(t,t,s)},perspective:function(t,e,n,i,s){const r=1/Math.tan(e*(Math.PI/360)),o=1/(i-s);t[0]=r/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(s+i)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*s*i*o,t[15]=0}};class nt{constructor(t={}){"number"==typeof t.a&&(this.a=t.a),"number"==typeof t.k&&(this.k=t.k),"number"==typeof t.x&&(this.x=t.x),"number"==typeof t.y&&(this.y=t.y)}static identity(){return new nt({a:0,k:1,x:0,y:0})}toRaw(){const t={};return"number"==typeof this.a&&(t.a=this.a),"number"==typeof this.k&&(t.k=this.k),"number"==typeof this.x&&(t.x=this.x),"number"==typeof this.y&&(t.y=this.y),t}toString(){const{a:t=0,k:e=1,x:n=0,y:i=0}=this,s=new Float32Array(16);return et.identity(s),et.translate(s,n,i,0),et.scale(s,e,e,e),et.rotate(s,-t,0,0,1),`matrix3d(${Array.prototype.slice.call(s).join(",")})`}}function it(t,e,n,i=!1){return 1>t||1>e||i&&t>e||0>=n||n>1?t:i?Math.pow((e-1)*t/(e-t),1/n):e/(1+(e-1)/Math.pow(t,n))}function st(t,e={}){if(0===t)return 0;const{max:n=9999,mode:i=0,expo:s=.88}=e;let r=Math.abs(t);return r=1>r?1===i?1/it(1/r,n,s):it(r+1,n,s)-1:it(r,n,s),r*(t>0?1:-1)}function rt(t,e={}){if(0===t)return 0;const{max:n=9999,mode:i=0,expo:s=.88}=e;let r=Math.abs(t);return r=1>r?1===i?1/it(1/r,n,s,!0):it(r+1,n,s,!0)-1:it(r,n,s,!0),r*(t>0?1:-1)}function ot(t,e,n){return t>(1-e)/(2*e)?(1+e-2*n)/(2*e)>t?(t-(1-n)/(2*e))/(1-n/e):.5:-.5}function at(t,...e){return"function"==typeof t?t(...e):t}function lt(t,[e,n]){return t>=e&&n>=t}function ht(t,[e,n],i){return Math.max(Math.min(t,n),e)}const ct=["sizePosition","dblAdjust","dblScale","damping","rotation","scalation","translation","transitionEl"];class ut extends G{constructor(t={}){let{sizePosition:e,dblAdjust:n,dblScale:i,damping:r,rotation:o,scalation:a,translation:l,transitionEl:h}=t;super(h||null,s(t,ct)),this._dblAdjust=!0,this._dblScale=0,this._damping=[],this._rotation=[],this._scalation=[],this._translation=[],this._sizePosition={containerCenter:[0,0],containerWidth:0,containerHeight:0,naturalWidth:0,naturalHeight:0,elementWidth:0,elementHeight:0},this.apply({transform:new L({a:0,k:1,x:0,y:0},{a:.001,k:.001,x:1,y:1},(t=>""+new nt(t)))}),this.sizePosition(e),this.setDblAdjust(n),this.setDamping(r),this.setDblScale(i),this.setRotation(o),this.setScalation(a),this.setTranslation(l)}reset(t=0){const e=ht(0,this.getRotation()),n=ht(1,this.getScalation()),s=ht(0,this.getXTranslation(n)),r=ht(0,this.getYTranslation(n));this.apply(new L({a:e,k:n,x:s,y:r}),i({},Z,{duration:t}))}sizePosition(t){if(t){const{containerCenter:e,containerWidth:n,containerHeight:i,naturalWidth:s,naturalHeight:r}=t,o=s/r;let a=s;a=n/i>o?1/2.2>o?Math.min(n,s):i*o:n;this._sizePosition={containerCenter:e,containerWidth:n,containerHeight:i,naturalWidth:s,naturalHeight:r,elementWidth:a||0,elementHeight:a/o||0},this.reset()}return this._sizePosition}setRotation(t){this._rotation=!t||"number"!=typeof t[0]||"number"!=typeof t[1]||t[0]>t[1]?()=>[0,0]:t}getRotation(){return at(this._rotation)}setScalation(t){this._scalation=t&&"number"==typeof t[0]&&"number"==typeof t[1]&&t[1]>=t[0]&&t[0]>0?t:()=>[1,2*this.getDblScale()]}getScalation(){return at(this._scalation)}setTranslation(t){this.setXTranslation(t&&t[0]),this.setYTranslation(t&&t[1])}getTranslation(t){return[this.getXTranslation(t),this.getYTranslation()]}setXTranslation(t){this._translation[0]=!t||"number"!=typeof t[0]||"number"!=typeof t[1]||t[0]>t[1]?t=>{const{containerWidth:e,elementWidth:n}=this.sizePosition(),i=Math.max((n*t-e)/2,0);return[-i,i]}:t}getXTranslation(t){return at(this._translation[0],t||this.value().transform.k||1)}setYTranslation(t){this._translation[1]=!t||"number"!=typeof t[0]||"number"!=typeof t[1]||t[0]>t[1]?t=>{const{containerHeight:e,elementHeight:n}=this.sizePosition(),i=Math.max((n*t-e)/2,0);return[-i,i]}:t}getYTranslation(t){return at(this._translation[1],t||this.value().transform.k||1)}setDblScale(t){this._dblScale="number"==typeof t&&t>0?t:()=>{const{containerWidth:t,containerHeight:e,naturalWidth:n,naturalHeight:i,elementWidth:s,elementHeight:r}=this.sizePosition();return Math.max(2,Math.max(t/s,e/r),Math.min(n/t,i/e))||1}}getDblScale(){return at(this._dblScale)}setDblAdjust(t=!0){this._dblAdjust=t}getDblAdjust(){return this._dblAdjust}isDamping(t){var e;return-1!==(null==(e=this._damping)?void 0:e.indexOf(t))}setDamping(t){this._damping=t||["scale","translate"]}rotate(t){return this.transform(new nt({a:t}))}rotateTo(t){return this.transformTo(new nt({a:t}))}scale(t,e){return this.transform(new nt({k:t}),e)}scaleTo(t,e){return this.transformTo(new nt({k:t}),e)}translate(t,e){return this.transform(new nt({x:t,y:e}))}translateTo(t,e){return this.transformTo(new nt({x:t,y:e}))}translateX(t){return this.transform(new nt({x:t}))}translateXTo(t){return this.transformTo(new nt({x:t}))}translateY(t){return this.transform(new nt({y:t}))}translateYTo(t){return this.transformTo(new nt({y:t}))}transform(t,e,n){const i=this.value().transform;let{a:s,k:r,x:o,y:a}=t;return"number"==typeof s&&(s+=i.a||0),"number"==typeof r&&(r*=i.k||1),"number"==typeof o&&(o+=i.x||0),"number"==typeof a&&(a+=i.y||0),this.transformTo(new nt({a:s,k:r,x:o,y:a}),e,n)}transformTo(t,e,n){let s=e,r=n;n||Array.isArray(e)||(r=e,s=void 0);const{a:o,k:a,x:l,y:h}=t,c=new nt;if("number"==typeof o&&(c.a=ht(o,this.getRotation())),"number"==typeof a){const t=c.k=ht(a,this.getScalation());if(Array.isArray(s)){const[e,n]=this.computeOffset(s,t),i=this.value().transform;c.x=ht(("number"==typeof l?l:i.x)+e,this.getXTranslation(t)),c.y=ht(("number"==typeof h?h:i.y)+n,this.getYTranslation(t))}else"number"==typeof l&&(c.x=ht(l,this.getXTranslation(t))),"number"==typeof h&&(c.y=ht(h,this.getYTranslation(t)))}else"number"==typeof l&&(c.x=ht(l,this.getXTranslation())),"number"==typeof h&&(c.y=ht(h,this.getYTranslation()));return this.apply(new L(c.toRaw()),i({},Z,r))}computeOffset(t,e,n=!1){const{containerCenter:i,containerWidth:s,containerHeight:r,elementWidth:o,elementHeight:a}=this.sizePosition(),l=this.value().transform,h=e/l.k,[c,u]=i;let p=("number"==typeof t[0]?t[0]:c)-(c+l.x),d=("number"==typeof t[1]?t[1]:u)-(u+l.y);if(n){const t=s/1,e=r/1,n=o/l.k,i=a/l.k;p=ht(n-(t-n)/(h-1),[0,n])*ot(p/n,h,ht(t/n,[1,2]))||0,d=ht(i-(e-i)/(h-1),[0,i])*ot(d/i,h,ht(e/i,[1,2]))||0}return p*=1-h,d*=1-h,[p,d]}moveBounce(t,e,n,i,s=[]){let{a:r,k:o,x:a,y:l}=this.value().transform;const h=this.getRotation();if(this.isDamping("rotate")){let e=ht(r,h);r=e+rt(r-e,{max:180}),e=ht(r+=t,h),r=e+st(r-e,{max:180})}else r=ht(r+=t,h);const c=this.getScalation();if(this.isDamping("scale")){let t=ht(o,c);o=t*rt(o/t,{max:2,mode:1}),t=ht(o*=e,c),o=t*st(o/t,{max:2,mode:1})}else o=ht(o*=e,c);const[u,p]=this.computeOffset(s,o);if(this.isDamping("scale")){const{containerWidth:t,containerHeight:e}=this.sizePosition();let s=ht(a,this.getXTranslation());a=s+rt(a-s,{max:t}),s=ht(a+=u+n,this.getXTranslation(o)),a=s+st(a-s,{max:t});let r=ht(l,this.getYTranslation());l=r+rt(l-r,{max:e}),r=ht(l+=p+i,this.getYTranslation(o)),l=r+st(l-r,{max:e})}else a=ht(a+=u+n,this.getXTranslation(o)),l=ht(l+=p+i,this.getYTranslation(o));this.apply(new L({a:r,k:o,x:a,y:l}))}resetBounce(t=[],e=!1){let{a:n,k:i,x:s,y:r}=this.value().transform;if(this.isDamping("rotate")){const t=ht(n,this.getRotation());n=t+rt(n-t,{max:180})}if(this.isDamping("scale")){const t=ht(i,this.getScalation());i=t*rt(i/t,{max:2,mode:1})}if(this.isDamping("translate")){const{containerWidth:t,containerHeight:e}=this.sizePosition(),n=ht(s,this.getXTranslation());s=n+rt(s-n,{max:t});const i=ht(r,this.getYTranslation());r=i+rt(r-i,{max:e})}this.transformTo(new nt({a:n,k:i,x:s,y:r}),t,{cancel:e})}dblScale(t=[]){const e=this.value().transform.k||1,n=ht(this.getDblScale(),this.getScalation()),i=ht(1,this.getScalation());if(n>i&&i>=e||i>n&&e>=i)if(this.getDblAdjust()){const[e,i]=this.computeOffset(t,n,this.getDblAdjust()),s=this.value().transform;this.transformTo(new nt({a:0,k:n,x:s.x+e,y:s.y+i}),{cancel:!1})}else this.transformTo(new nt({k:n}),t,{cancel:!1});else this.getDblAdjust()?this.transformTo(new nt({a:0,k:i,x:0,y:0}),{cancel:!1}):this.transformTo(new nt({k:i}),t,{cancel:!1})}swipeBounce(t,e,n,s){const r=this.sizePosition()["x"===n?"containerWidth":"containerHeight"],o=1.2*this.getDblScale(),a=this.value().transform[n]||0,l=this.getTranslation()["x"===n?0:1],h=e>0?1:-1,c=Math.max(1,Math.min(Math.abs(e),o*r))*h,u=Math.max(800,Math.min(2500,t));if(lt(a+c,l))"function"==typeof s?s(n,c,0,(()=>({duration:u,easing:U}))):this.apply(new L({[n]:a+c}),i({},Z,{easing:U,duration:u}));else{const t=ht(a+c,l)-a;let e=0;if(this.isDamping("translate")){const n=(lt(a,l)?Math.sqrt(1-Math.abs(t/c)):1)*(2*Math.abs(c)/u);e=Math.min(30*n,r/4)*h}if("function"==typeof s)s(n,t,e,(t=>({duration:(1-Math.sqrt(1-Math.abs(t/c)))*u,easing:U})));else{const s=Math.max((t+e)*h,0)*h,r=1-Math.sqrt(1-Math.abs(s/c));0===s?this.apply(new L({[n]:ht(a+s,l)}),i({},Z)):this.apply(new L({[n]:a+s}),i({},Z,{duration:r*u,easing:U})).then((()=>{this.apply(new L({[n]:ht(a+s,l)}),i({},Z))}))}}}}var pt,dt;function ft(){return ft=Object.assign?Object.assign.bind():function(t){for(var e=1;arguments.length>e;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ft.apply(this,arguments)}var mt,gt=function(e){return t.createElement("svg",ft({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 80 80",width:"1em",height:"1em"},e),pt||(pt=t.createElement("defs",null,t.createElement("linearGradient",{id:"loading_svg__a",x1:"94.087%",x2:"94.087%",y1:"0%",y2:"90.559%"},t.createElement("stop",{offset:"0%",stopColor:"#fff",stopOpacity:0}),t.createElement("stop",{offset:"100%",stopColor:"#fff",stopOpacity:.3})),t.createElement("linearGradient",{id:"loading_svg__b",x1:"100%",x2:"100%",y1:"8.674%",y2:"90.629%"},t.createElement("stop",{offset:"0%",stopColor:"#fff"}),t.createElement("stop",{offset:"100%",stopColor:"#fff",stopOpacity:.3})))),dt||(dt=t.createElement("g",{fill:"none",fillRule:"evenodd",opacity:.9},t.createElement("path",{fill:"url(#loading_svg__a)",d:"M40 0c22.091 0 40 17.909 40 40S62.091 80 40 80v-7c18.225 0 33-14.775 33-33S58.225 7 40 7V0Z"}),t.createElement("path",{fill:"url(#loading_svg__b)",d:"M40 0v7C21.775 7 7 21.775 7 40s14.775 33 33 33v7C17.909 80 0 62.091 0 40S17.909 0 40 0Z"}),t.createElement("circle",{cx:40.5,cy:3.5,r:3.5,fill:"#fff"}),t.createElement("animateTransform",{attributeName:"transform",begin:"0s",dur:"1s",repeatCount:"indefinite",type:"rotate",values:"0 40 40;360 40 40"}))))};function vt(){return vt=Object.assign?Object.assign.bind():function(t){for(var e=1;arguments.length>e;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},vt.apply(this,arguments)}var _t=function(e){return t.createElement("svg",vt({xmlns:"http://www.w3.org/2000/svg",fill:"#fff",viewBox:"0 0 24 24",width:"1em",height:"1em"},e),mt||(mt=t.createElement("path",{d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-.763-15.864.11 7.596h1.305l.11-7.596h-1.525zm.759 10.967c.512 0 .902-.383.902-.882 0-.5-.39-.882-.902-.882a.878.878 0 0 0-.896.882c0 .499.396.882.896.882z"})))};const yt=()=>e.createElement("div",{className:"preview-image__image__error"},e.createElement("span",null,e.createElement(_t,{width:"100%",height:"100%"})),e.createElement("span",{style:{marginTop:16}},"图片加载失败")),wt=()=>e.createElement("span",{className:"preview-image__image__loading"},e.createElement(gt,{width:"100%",height:"100%"}));var bt=e.forwardRef((({src:t="",alt:n="",style:s,imgStyle:r,className:o,viewBox:a,loading:l,error:h,active:u=!0},p)=>{const d=e.useRef(null),f=e.useRef(null),m=e.useRef(null),[g,v]=C(0,(function(e){let n=e;return I(t)&&(n=0),0===n&&u&&(n=1),n}));z((()=>{m.current=new ut({transitionEl:()=>f.current,rotation:c()?void 0:[-Number.MAX_VALUE,Number.MAX_VALUE],scalation:c()?void 0:[.1,10]})}),[]),e.useImperativeHandle(p,(()=>({findImageElement:()=>2===g?f.current:null,findDOMElement:()=>2===g?d.current:null,getInstance:()=>2===g?m.current:null})),[g]);const _=e.useMemo((()=>{const t={containerCenter:[0,0],containerWidth:0,containerHeight:0,naturalWidth:0,naturalHeight:0},e=f.current;if(e&&2===g){const n=e.naturalWidth,i=e.naturalHeight,{left:s=0,top:r=0,width:o=0,height:l=0}=a||{};t.containerCenter=[s+o/2,r+l/2],t.containerWidth=o,t.containerHeight=l,t.naturalWidth=n,t.naturalHeight=i}const n=m.current,i={width:0,height:0};if(n){const{elementWidth:e,elementHeight:s}=n.sizePosition(t);i.width=e,i.height=s}return i}),[a,g]);return e.createElement("div",{ref:d,className:"preview-image__image__wrapper"+(o?" "+o:""),style:i({alignItems:_.height>((a||{}).height||0)?"flex-start":"center"},s||{})},e.createElement("img",i({ref:f,style:i({},r),alt:n,onLoad:()=>v(2),onError:()=>v(3)},g>0?{src:t}:{},_)),1>=g&&!1!==l&&(l||wt)(),3===g&&!1!==h&&(h||yt)())}));function Tt(t){if(!1===t)return!1;if(!A())return null;let e=t;return"string"==typeof t&&(e=document.querySelector(t)),"function"==typeof t&&(e=t()),e||null}var xt=({container:t,destroy:i,lockOverflow:s,children:r})=>{const[o,a]=e.useState((()=>Tt(t))),[l]=e.useState((()=>A()?document.createElement("div"):null));z((()=>a(Tt(t))),[t]);const h=!i&&null===o;z((()=>{var t;h?l&&document.body.appendChild(l):null==l||null==(t=l.parentElement)||t.removeChild(l);return()=>{var t;null==l||null==(t=l.parentElement)||t.removeChild(l)}}),[l,h]);const c=null!=o?o:l,u=s&&A()&&(c===l||c===document.body),p=e.useRef("");return z((()=>{const t=document.body,e=t.parentElement;if(u){const n=document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth,i=function(t){if("boolean"==typeof t){const e=P(t);return{width:e,height:e}}if(!("undefined"!=typeof document&&t&&t instanceof Element))return{width:0,height:0};const{width:e,height:n}=getComputedStyle(t,"::-webkit-scrollbar");return{width:S(e),height:S(n)}}(t).width,s=n?`calc(100% - ${i}px)`:"",r=[];r[0]=t.style.overflow,t.style.overflow="hidden",r[1]=t.style.width,t.style.width=s,e&&(r[2]=e.style.overflow,e.style.overflow="hidden",r[3]=e.style.width,e.style.width=s),p.current=r.join("-")}else{const n=p.current.split("-");p.current="",t.style.overflow=n[0],t.style.width=n[1],e&&(e.style.overflow=n[2],e.style.width=n[3])}return()=>{const n=p.current.split("-");p.current="",t.style.overflow=n[0],t.style.width=n[1],e&&(e.style.overflow=n[2],e.style.width=n[3])}}),[u]),i||!A()||null===c?null:e.createElement(e.Fragment,null,!1===c?r:n.createPortal(r,c))};function Mt(t){const n=e.useRef({data:t});return n.current.data=t,e.useMemo((()=>n.current),[])}function Et(t){if(c())return;const e=this.currentItem();if(this.running()||null!=e&&e.running())return;const n=-this.activeIndex()*this.itemSize();if(0===Math.round(this.value().transform.default-n)){const{angle:n=0}=t;isNaN(n)?null==e||e.resetBounce():null==e||e.moveBounce(n,1,0,0)}}function Pt(t){if(c())return;const e=this.currentItem();if(this.running()||null!=e&&e.running())return;const n=-this.activeIndex()*this.itemSize();if(0===Math.round(this.value().transform.default-n)){const{scale:n=1}=t;isNaN(n)?null==e||e.resetBounce():null==e||e.moveBounce(0,n,0,0)}}function St(t,{popupMenu:e}){const n=this.currentItem();this.running()||null!=n&&n.running()||null==e||e(t)}function Dt(t,{internalClose:e}){const n=this.currentItem();this.running()||null!=n&&n.running()||null==e||e(t)}function kt(t,{internalClose:e,slideBefore:n,slideAfter:s}){const r=this.currentItem();if(this.running()||null!=r&&r.running())return;const{direction:o}=t,a="Right"===o&&this.isHorizontal()||"Down"===o&&this.isVertical(),l=-this.activeIndex()*this.itemSize(),h=this.value().transform.default-l,c=(a&&0>h||!a&&h>0)&&0!==Math.round(h)?-h:0;if("inside"===this._moveTarget){if(r){const{velocity:e=0,swipeComputed:n}=t;if(e>0&&n){const t=this,e=(e,n,s,o)=>{if(0!==n){const{duration:a,easing:h}=o(n+s);0!==s?Promise.all([0!==c?t.apply(new L(l),i({},Z,{duration:a,easing:h,before:t=>Math.min(Math.abs(c+n+s)*t/Math.abs(c),1)})):Promise.resolve(),r.apply(new L({[e]:(r.value().transform[e]||0)+n}),i({},Z,{duration:a,easing:h,before:t=>Math.min(Math.max((Math.abs(c+n+s)*t-Math.abs(c))/Math.abs(n),0),1)})),t.apply(new L(l+s),i({},Z,{duration:a,easing:h,before:t=>Math.max((Math.abs(c+n+s)*t-Math.abs(c)-Math.abs(n))/Math.abs(s),0)}))]).then((()=>{t.apply(new L(l),i({},Z))})):(0!==c&&t.apply(new L(l),i({},Z,{duration:a,easing:h,before:t=>Math.min(Math.abs(c+n)*t/Math.abs(c),1)})),r.apply(new L({[e]:(r.value().transform[e]||0)+n}),i({},Z,{duration:a,easing:h,before:t=>Math.max((Math.abs(c+n)*t-Math.abs(c))/Math.abs(n),0)})))}else{const e=h>0?1:-1,n=Math.max((s-h)*e,0)*e,{duration:r,easing:a}=o(n);0===n?t.apply(new L(l),i({},Z)):t.apply(new L(l+h+n),i({},Z,{duration:r,easing:a})).then((()=>{t.apply(new L(l),i({},Z))}))}},{duration:s,stretchX:o,stretchY:a}=n(.003);if(this.isVertical()){const t=r.getXTranslation();0===t[0]&&0===t[1]||r.swipeBounce(s,o,"x"),r.swipeBounce(s,a-c,"y",e)}else{r.swipeBounce(s,o-c,"x",e);const t=r.getYTranslation();0===t[0]&&0===t[1]||r.swipeBounce(s,a,"y")}}}else this.slide(this.activeIndex(),{before:n,after:s});return}if("closures"===this._moveTarget){this._moveTarget="none";const n="Down"===o&&this.isHorizontal()||"Right"===o&&this.isVertical();return void(this.swipeClose()&&n&&(null==e||e(t)))}const u=this.itemSize(),p=0===u?0:-this.value().transform.default/u;this.slide(Math[a?"floor":"ceil"](p),{before:n,after:s})}function It(t){const e=this.currentItem();if(this.running()||null!=e&&e.running())return;const n=-this.activeIndex()*this.itemSize();0===Math.round(this.value().transform.default-n)&&(null==e||e.dblScale(t.getPoint()))}const Ct=["x","y"];function At(t,{preventAllTap:e}){0===this._fgBehavior&&t.pointers.length>1&&(this._fgBehavior=2);let n=0;n+=this.cancel();const r=this.currentItem();if(n+=(null==r?void 0:r.cancel())||0,n>0){if(r){const t=r.value().transform,{x:e=0,y:n=0}=t,o=s(t,Ct),[a,l]=r.getTranslation(),h=0===this.activeIndex(),c=this.activeIndex()===this.countItems()-1;this.isVertical()?lt(e,a)||(n>l[0]||c)&&(l[1]>n||h)||r.apply(new L(i({x:ht(e,a),y:n},o))):lt(n,l)||(e>a[0]||c)&&(a[1]>e||h)||r.apply(new L(i({x:e,y:ht(n,l)},o)))}null==e||e()}}const zt=(t,[e,n],[i,s])=>t?Math.abs(e-i)>4*Math.abs(n-s)&&0>=e-i:Math.abs(n-s)>4*Math.abs(e-i)&&0>=n-s;function Ot(t,{openStyleChange:e}){0===this._fgBehavior&&1===t.pointers.length&&(this._fgBehavior=1);const n=this.currentItem();if(this.running()||null!=n&&n.running())return;const i=1===t.pointers.length||1===this._fgBehavior,s={max:this.itemSize()},{getPoint:r,direction:o,angle:a=0,scale:l=1,deltaX:h=0,deltaY:c=0,moveX:u=0,moveY:p=0}=t,d=r();if("none"===this._moveTarget){const t=r("previous");if(n){if(this._moveTarget="inside",i){const e=0===this.activeIndex(),i=this.activeIndex()===this.countItems()-1,s=zt(this.isVertical(),t,d),{x:r=0,y:a=0}=n.value().transform,[l,u]=n.getTranslation();if(this.isVertical())if(this.swipeClose()&&r>=l[1]&&s)this._moveTarget="closures";else{const t=0===l[0]&&0===l[1];(u[0]>=a&&(t?0>c:"Up"===o)&&!i||a>=u[1]&&(t?c>0:"Down"===o)&&!e)&&(this._moveTarget="outside")}else if(this.swipeClose()&&a>=u[1]&&s)this._moveTarget="closures";else{const t=0===u[0]&&0===u[1];(l[0]>=r&&(t?0>h:"Left"===o)&&!i||r>=l[1]&&(t?h>0:"Right"===o)&&!e)&&(this._moveTarget="outside")}}}else this._moveTarget=this.swipeClose()&&zt(this.isVertical(),t,d)?"closures":"outside"}if("inside"===this._moveTarget){if(n){const t=-this.activeIndex()*this.itemSize(),e=rt(this.value().transform.default-t,s);let r=h,o=c;if(this.isVertical()?o+=e:r+=e,i){const{x:e=0,y:i=0}=n.value().transform,[a,l]=n.getTranslation();let h=0;if(this.isVertical()){h=o,r=0===a[0]&&0===a[1]?0:r,o=ht(o+i,l)-i,h-=o}else{const t=0===l[0]&&0===l[1];h=r,r=ht(r+e,a)-e,o=t?0:o,h-=r}n.moveBounce(0,1,r,o,d),this.apply(new L(t+st(h,s)))}else n.moveBounce(a,l,r,o,d),0!==e&&this.apply(new L(t))}return}if("closures"===this._moveTarget)return void(null==e||e(((t,e)=>{const{width:n=0,height:i=0,left:s=0,top:r=0}=e,o=Math.min(Math.max(1-((this.isVertical()?u/n:p/i)||0),.3),1),a=.01+.99*(o-.3)/.7,{k:l=1,x:f=0,y:m=0}=t;return{o:a,k:o,x:f+h+(d[0]-(f+s+n/2))*(1-o/l),y:m+c+(d[1]-(m+r+i/2))*(1-o/l)}})));const f=[(1-this.countItems())*this.itemSize(),0];let m=ht(this.value().transform.default,f),g=m+rt(this.value().transform.default-m,s);m=ht(g+=this.isVertical()?c:h,f),g=m+st(g-m,s),this.apply(new L(g))}function Xt(t,{openStyleChange:e,slideBefore:n,slideAfter:i}){const s=this._moveTarget,r=1===t.leavePointers.length||1===this._fgBehavior;if(0===t.pointers.length)this._fgBehavior=0,this._moveTarget="none";else if(1===this._fgBehavior){if(!this.running()&&"outside"===s){const t=this.itemSize(),e=0===t?0:-this.value().transform.default/t;this.slide(Math.round(e),{before:n,after:i})}return}const o=this.currentItem();if(this.running()||null!=o&&o.running())return;if("closures"===s)return void(null==e||e((()=>({o:1,k:1,x:0,y:0,t:300}))));null==o||o.resetBounce(t.getPoint(),r);let a=this.activeIndex();if("outside"===s){const t=this.itemSize();a=Math.round(0===t?0:-this.value().transform.default/t)}this.slide(a,{before:n,after:i})}var Yt=e.forwardRef((({style:t,className:n,backdropStyle:s,backdropClassName:r,wrapperStyle:o,wrapperClassName:a,indicatorStyle:l,indicatorClassName:h,open:c=!1,current:u=0,container:p,originBox:d,imageUrls:f=[],itemGap:m=20,direction:g="horizontal",isLazy:v=!0,hasLoading:_=!0,renderLoading:y,hasError:w=!0,renderError:b,hasIndicator:T=!0,destroyOnClose:x=!1,enableSwipeClose:E=!0,onPopupMenu:P,onChange:S,onAfterChange:D,onClose:I,onAfterClose:A,onAfterOpenChange:O},X)=>{const Y=f.length,j=u&&u>=0&&Y>u?u:0,B=e.useRef(null),R=e.useRef(null),H=e.useRef(null),[N,W]=e.useState(0),[L,F]=e.useState({}),[$,V]=e.useState({}),[q,G]=C(j);e.useImperativeHandle(X,(()=>({findDOMElement:()=>{var t;return null==(t=B.current)?void 0:t.findDOMElement()},getInstance:()=>R.current})),[]),z((()=>{R.current=new Q({transitionEl:()=>H.current})}),[]);const U=Mt(i({},c&&2===N?{}:{duration:0},{before:S,after:D}));z((()=>{const t=R.current;t&&t.slide(q,i({},U.data))}),[q,U]),z((()=>{var t;c&&0===N&&(V(k(null==(t=B.current)?void 0:t.findDOMElement())),W(1));c||2!==N||W(1)}),[c]);const Z=Mt({viewBox:$,originBox:d});z((()=>{if(1===N){var t;const e=null==(t=R.current)?void 0:t.currentItem();null==e||e.reset();const{elementWidth:n=0,elementHeight:s=0}=(null==e?void 0:e.sizePosition())||{},{left:r=0,top:o=0,width:a=0,height:l=0}=Z.data.originBox||{},{left:h=0,top:u=0,width:p=0,height:d=0}=Z.data.viewBox;let f=.001,m=0,g=0,v=0,_=0;if(p>0&&d>0&&a>0&&l>0&&(m=r+a/2-(h+p/2),g=o+l/2-(u+d/2)),n>0&&s>0&&a>0&&l>0){const t=n/s>a/l;f=t?l/s:a/n,v=t?s*(a/l):n,_=t?s:n/(a/l)}const y={o:0,k:f,x:m,y:g,w:v,h:_},w={o:1,k:1,x:0,y:0,w:n,h:s};F((t=>i({},c?y:i({},w,t)))),Promise.resolve().then((()=>{var t;k(null==(t=B.current)?void 0:t.findDOMElement()),F(i({},c?w:y,{t:300}))}))}}),[c,N,Z]),z((()=>{const t=R.current;t&&t.swipeClose(E)}),[E]),z((()=>{const t=R.current;t&&t.direction(g)}),[g]),z((()=>{const t=R.current;if(t){const{width:e,height:n}=$;let i="horizontal"!==g?n:e;i=i?i+m:0,t.itemSize(i)}}),[g,m,$]),z((()=>{const t=t=>{t.preventDefault(),t.stopPropagation()},e=()=>{var t;return V(k(null==(t=B.current)?void 0:t.findDOMElement()))};return window.addEventListener("resize",e),window.addEventListener("contextmenu",t),()=>{window.removeEventListener("resize",e),window.removeEventListener("contextmenu",t)}}),[]);const J=e.useMemo((()=>{let{width:t=0,height:e=0}=$;const n=(Y-1)*m;return"horizontal"!==g?e=e*Y+n:t=t*Y+n,{width:t,height:e}}),[g,m,$,Y]);function K(t,e){const n=R.current;n&&t.call(n,e,{preventAllTap:()=>{var t;const e=null==(t=B.current)?void 0:t.getInstance();e&&e.preventAllTap()},popupMenu:t=>{null==P||P(t)},internalClose:t=>{null==I||I(t)},openStyleChange:t=>{F((e=>t(e,$)))},slideBefore:t=>{G(t),null==S||S(t)},slideAfter:t=>null==D?void 0:D(t)})}return x&&!c&&0===N?null:e.createElement(xt,{lockOverflow:c&&2===N,container:p},e.createElement(M,{ref:B,onPointerStart:t=>K(At,t),onPointerMove:t=>K(Ot,t),onPointerEnd:t=>K(Xt,t),onDoubleTap:t=>K(It,t),onSingleTap:t=>K(Dt,t),onLongTap:t=>K(St,t),onRotate:t=>K(Et,t),onScale:t=>K(Pt,t),onSwipe:t=>K(kt,t)},e.createElement("div",{className:`preview-image__gallery__container preview-image__gallery__container-${g}${n?" "+n:""}${c||0!==N?" visible":""}`,style:t},e.createElement("div",{className:"preview-image__gallery__backdrop"+(r?" "+r:""),style:i({backgroundColor:"#000f"},s||{},{opacity:L.o,transition:L.t?`opacity ${L.t}ms`:""}),onTransitionEnd:t=>{"opacity"===t.nativeEvent.propertyName&&(1===N&&(W(c?2:0),c||null==A||A(),null==O||O(c)),F((({o:t,k:e,x:n,y:i})=>({o:t,k:e,x:n,y:i}))))}}),e.createElement("div",{ref:H,className:"preview-image__gallery__wrapper"+(a?" "+a:""),style:i({},o||{},J)},f.map(((t,n)=>e.createElement(bt,{ref:t=>{var e;return null==(e=R.current)?void 0:e.itemModels(t&&t.getInstance(),n)},key:n,style:i({},n===q?{transform:`translate(${L.x}px,${L.y}px) scale(${L.k})`,transition:L.t?`transform ${L.t}ms`:"",overflow:1>(L.k||1)||L.t?"visible":void 0}:{},{marginTop:"horizontal"!==g&&0!==n?m:0,marginLeft:"horizontal"!==g||0===n?0:m}),imgStyle:n===q?{width:L.w||void 0,height:L.h||void 0,transition:L.t&&L.w&&L.h?`width ${L.t}ms, height ${L.t}ms`:"",objectFit:L.w&&L.h?"cover":void 0}:{},src:t,error:!!w&&b,loading:!!_&&y,active:!v||q===n,viewBox:$})))),T&&Y>1&&e.createElement("div",{className:`preview-image__gallery__indicator${h?" "+h:""}${c&&2===N?" visible":""}`,style:l},f.map(((t,n)=>e.createElement("span",{key:n,className:"preview-image__gallery__indicator-item"+(q===n?" active":"")})))))))}));function jt({open:t=!1,urls:n=[],current:i="",onClose:s,showMenu:r,originBox:o}){const a=n.indexOf(i);return e.createElement(Yt,{open:t,current:a,imageUrls:n,enableSwipeClose:!0,destroyOnClose:!0,onPopupMenu:r,onClose:s,originBox:o})}export{Yt as Gallery,bt as Image,xt as Portal,jt as default};
//# sourceMappingURL=react-preview-image.min.js.map
