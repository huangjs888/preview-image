{"version":3,"file":"react-preview-image.min.js","sources":["../src/modules/gesture/react/useIsomorphicLayoutEffect.ts","../src/modules/gesture/react/useEvents.ts","../src/modules/gesture/emitter/index.ts","../src/modules/gesture/utils/index.ts","../src/modules/gesture/core/index.ts","../src/modules/gesture/events/started.ts","../src/modules/gesture/events/moved.ts","../src/modules/gesture/events/ended.ts","../src/modules/gesture/events/canceled.ts","../src/modules/gesture/events/downed.ts","../src/modules/gesture/events/wheeled.ts","../src/modules/gesture/react/index.tsx","../src/modules/lightdom/index.ts","../src/react/useChanged.ts","../src/react/useDerivedState.ts","../src/react/useIsomorphicLayoutEffect.ts","../src/modules/transition/animation/raf.ts","../src/modules/transition/animation/index.ts","../src/modules/transition/core/value.ts","../src/modules/transition/core/index.ts","../src/modules/transition/core/method.ts","../src/modules/transition/native/index.ts","../src/modules/transition/easing/index.ts","../src/core/defaultAnimationExtendOptions.ts","../src/core/swiper.ts","../src/modules/transform/matrix.ts","../src/modules/transform/transform.ts","../src/modules/damping/index.ts","../src/utils/index.ts","../src/core/item.ts","../src/svg/loading.svg","../src/svg/error.svg","../src/react/image.tsx","../src/react/portal.tsx","../src/react/useStableMemo.ts","../src/events/rotate.ts","../src/events/scale.ts","../src/events/longTap.ts","../src/events/singleTap.ts","../src/events/swipe.ts","../src/events/doubleTap.ts","../src/events/pointerStart.ts","../src/events/pointerMove.ts","../src/events/pointerEnd.ts","../src/react/gallery.tsx","../src/react/index.tsx"],"sourcesContent":["/*\n * @Author: Huangjs\n * @Date: 2023-08-24 16:40:36\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-08-24 16:40:43\n * @Description: ******\n */\n\nimport React from 'react';\n\nexport const canUseDOM = !!(\n  typeof window !== 'undefined' &&\n  typeof window.document !== 'undefined' &&\n  typeof window.document.createElement !== 'undefined'\n);\n\nexport const useIsomorphicLayoutEffect = canUseDOM ? React.useLayoutEffect : React.useEffect;\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-22 16:15:47\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-08 14:23:08\n * @Description: ******\n */\n\nimport { useIsomorphicLayoutEffect } from './useIsomorphicLayoutEffect';\nimport type Core from '../core';\nimport { type IGestureEvent, type IGestureEventType } from '../core';\nimport { type IHandler, type IGestureHandler } from './index';\n\nfunction useEvent(core: Core | null, type: IGestureEventType, onEvent?: IHandler): void {\n  useIsomorphicLayoutEffect(() => {\n    if (core) {\n      const handler = (e: IGestureEvent) => {\n        if (typeof onEvent === 'function') {\n          onEvent.apply(null, [e]);\n        }\n      };\n      core.on(type, handler);\n      return () => {\n        core.off(type, handler);\n      };\n    }\n    return () => {};\n  }, [onEvent, core]);\n}\nexport function useEvents(events: IGestureHandler, core: Core | null): void {\n  const {\n    onPan,\n    onTap,\n    onSwipe,\n    onSingleTap,\n    onLongTap,\n    onDoubleTap,\n    onMultiPan,\n    onScale,\n    onRotate,\n    onPointerStart,\n    onPointerMove,\n    onPointerEnd,\n    onPointerCancel,\n    onGestureStart,\n    onGestureMove,\n    onGestureEnd,\n  } = events;\n  useEvent(core, 'pan', onPan);\n  useEvent(core, 'tap', onTap);\n  useEvent(core, 'swipe', onSwipe);\n  useEvent(core, 'singleTap', onSingleTap);\n  useEvent(core, 'longTap', onLongTap);\n  useEvent(core, 'doubleTap', onDoubleTap);\n  useEvent(core, 'multiPan', onMultiPan);\n  useEvent(core, 'scale', onScale);\n  useEvent(core, 'rotate', onRotate);\n  useEvent(core, 'pointerStart', onPointerStart);\n  useEvent(core, 'pointerMove', onPointerMove);\n  useEvent(core, 'pointerEnd', onPointerEnd);\n  useEvent(core, 'pointerCancel', onPointerCancel);\n  useEvent(core, 'gestureStart', onGestureStart);\n  useEvent(core, 'gestureMove', onGestureMove);\n  useEvent(core, 'gestureEnd', onGestureEnd);\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-02-13 15:22:58\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-14 09:46:11\n * @Description: ******\n */\n\ntype IEventHandler<E, T> = (event: E, type?: T) => boolean | void;\n\nexport default class EventEmitter<T extends string, E> {\n  events: {\n    [key in T]?: {\n      pool: Array<IEventHandler<E, T>>;\n      single: number;\n    };\n  } = {};\n  constructor() {\n    this.events = {};\n  }\n  one(type: T, handler: IEventHandler<E, T>, single?: boolean) {\n    const onceHandler =\n      typeof handler === 'function'\n        ? (...args: [E, T?]) => {\n            // 该事件只执行一次，执行完就解除事件\n            handler.apply(null, args);\n            this.off(type, onceHandler, single);\n          }\n        : handler;\n    this.on(type, onceHandler, single);\n  }\n  on(type: T, handler: IEventHandler<E, T>, single?: boolean) {\n    const events = this.events[type] || {\n      pool: [],\n      single: -1,\n    };\n    if (typeof handler === 'function') {\n      if (single) {\n        // 该事件只能注册一次，每次注册都会替换上次注册的，类似于dom属性事件赋值注册比如element.onclick = ()=>{}\n        if (events.single === -1) {\n          // 记录该单独事件在所有事件的位置\n          events.single = events.pool.push(handler) - 1;\n        } else {\n          events.pool[events.single] = handler;\n        }\n      } else {\n        // 该事件可以注册多次，执行时，会遍历全部事件全部执行，类似于dom的addEventListener\n        // 注册进去之前会检查是否有相同的处理程序，如果有，则不再添加（独立程序不参与）\n        let unregistered = true;\n        for (let i = 0, len = events.pool.length; i < len; i++) {\n          if (events.pool[i] === handler && i !== events.single) {\n            unregistered = false;\n            break;\n          }\n        }\n        if (unregistered) {\n          events.pool.push(handler);\n        }\n      }\n    } else if (single && events.single !== -1) {\n      // 需要把独立事件删除，相当于解绑独立事件\n      events.pool.splice(events.single, 1);\n      events.single = -1;\n    }\n    this.events[type] = events;\n  }\n  off(type?: T, handler?: IEventHandler<E, T>, single?: boolean) {\n    if (typeof type === 'undefined') {\n      // 没有type则删除全部事件\n      this.events = {};\n    } else if (typeof handler === 'undefined') {\n      // 删除type下的所有事件\n      delete this.events[type];\n    } else if (single) {\n      const events = this.events[type];\n      if (events && events.single !== -1) {\n        // 删除独立程序事件\n        events.pool.splice(events.single, 1);\n        events.single = -1;\n      }\n    } else {\n      const events = this.events[type];\n      if (events) {\n        // 检查并删除事件池内事件\n        for (let i = events.pool.length - 1; i >= 0; i--) {\n          if (events.pool[i] === handler && i !== events.single) {\n            events.pool.splice(i, 1);\n            // 因为相同事件只会有一个，所以删除后不需要再检查了\n            break;\n          }\n        }\n      }\n    }\n  }\n  emit(type: T, event: E) {\n    const events = this.events[type];\n    if (events) {\n      // 循环执行事件池里的事件\n      for (let i = 0, len = events.pool.length; i < len; i++) {\n        const handler = events.pool[i];\n        if (typeof handler === 'function') {\n          const immediatePropagation = handler.apply(null, [event, type]);\n          // 返回值为false，则阻止后于该事件注册的同类型事件触发\n          if (immediatePropagation === false) {\n            break;\n          }\n        }\n      }\n    }\n  }\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-02-13 15:22:58\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-12 11:41:28\n * @Description: ******\n */\n\nconst isCurrentTarget = (target: HTMLElement, currentTarget: HTMLElement) => {\n  let _target: HTMLElement | null = target;\n  while (_target && _target !== currentTarget) {\n    _target = _target.parentNode as HTMLElement;\n  }\n  return !!_target;\n};\n\nexport function fixOption(value: number | undefined, defaultValue: number, minVal: number) {\n  return typeof value !== 'number' || value < minVal ? defaultValue : value;\n}\n\nexport function isTouchable() {\n  return window.navigator.maxTouchPoints || 'ontouchstart' in window.document;\n}\n\nexport function getEventPoints(\n  event: any,\n  started: boolean = false,\n): {\n  points: { pageX: number; pageY: number; identifier: number }[];\n  isFirst?: boolean;\n} {\n  if (event.touches) {\n    if (started) {\n      const points = Array.prototype.filter\n        .call(event.touches, (t: any) =>\n          isCurrentTarget(t.target as HTMLElement, event.currentTarget as HTMLElement),\n        )\n        .map((t: any) => ({\n          pageX: t.pageX,\n          pageY: t.pageY,\n          identifier: t.identifier,\n        }));\n      return {\n        points,\n        isFirst: event.changedTouches.length === points.length,\n      };\n    }\n\n    return {\n      points: Array.prototype.slice.call(event.changedTouches || []).map((t: any) => ({\n        pageX: t.pageX,\n        pageY: t.pageY,\n        identifier: t.identifier,\n      })),\n    };\n  }\n  return {\n    points: [{ pageX: event.pageX, pageY: event.pageY, identifier: -1 }],\n    isFirst: started,\n  };\n}\n\nexport function getDistance([x0, y0]: number[], [x1, y1]: number[]) {\n  if (\n    typeof x0 === 'number' &&\n    typeof x1 === 'number' &&\n    typeof y0 === 'number' &&\n    typeof y1 === 'number'\n  ) {\n    return Math.sqrt(Math.pow(x1 - x0, 2) + Math.pow(y1 - y0, 2));\n  }\n  return 0;\n}\n\nexport function getAngle([x0, y0]: number[], [x1, y1]: number[]) {\n  if (\n    typeof x0 === 'number' &&\n    typeof x1 === 'number' &&\n    typeof y0 === 'number' &&\n    typeof y1 === 'number'\n  ) {\n    return (Math.atan2(y1 - y0, x1 - x0) * 180) / Math.PI;\n  }\n  return 0;\n}\n\nexport function getCenter([x0, y0]: number[], [x1, y1]: number[]) {\n  const ok0 = typeof x0 === 'number' && typeof y0 === 'number';\n  const ok1 = typeof x1 === 'number' && typeof y1 === 'number';\n  return !ok0 && !ok1\n    ? [0, 0]\n    : ok0 && !ok1\n    ? [x0, y0]\n    : !ok0 && ok1\n    ? [x1, y1]\n    : [(x0 + x1) / 2, (y0 + y1) / 2];\n}\n\nexport function getDirection([x0, y0]: number[], [x1, y1]: number[]) {\n  if (\n    typeof x0 === 'number' &&\n    typeof x1 === 'number' &&\n    typeof y0 === 'number' &&\n    typeof y1 === 'number'\n  ) {\n    const x = x0 - x1;\n    const y = y0 - y1;\n    if (x !== y) {\n      return Math.abs(x) >= Math.abs(y)\n        ? x0 - x1 > 0\n          ? 'Left'\n          : 'Right'\n        : y0 - y1 > 0\n        ? 'Up'\n        : 'Down';\n    }\n  }\n  return 'None';\n}\n\nexport function getVelocity(deltaTime: number, distance: number) {\n  if (\n    typeof distance !== 'number' ||\n    distance === 0 ||\n    typeof deltaTime !== 'number' ||\n    deltaTime === 0\n  ) {\n    return 0;\n  }\n  return distance / deltaTime;\n}\n\n//根据数值，与水平夹角，计算x和y的分量值\nexport function getVector(value: number, angle: number) {\n  if (typeof value !== 'number' || typeof angle !== 'number') {\n    return [0, 0];\n  }\n  const rad = (angle * Math.PI) / 180;\n  return [value * Math.cos(rad), value * Math.sin(rad)];\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-23 09:36:07\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-14 09:43:35\n * @Description: ******\n */\n\nimport EventEmitter from '../emitter';\nimport { fixOption } from '../utils';\n\nclass Gesture extends EventEmitter<IGestureEventType, IGestureEvent> {\n  wheelDelay: number = 350;\n  longTapInterval: number = 750;\n  doubleTapInterval: number = 250;\n  doubleTapDistance: number = 30;\n  touchMoveDistance: number = 3;\n  swipeVelocity: number = 0.3;\n  swipeDuration: number = 100;\n  raiseDuration: number = 100;\n  _rotateAngle: number = 0;\n  _singleTapTimer: number = 0;\n  _longTapTimer: number = 0;\n  _wheelTimerEnd: {\n    scale: number;\n    timer: number;\n    wheelEnd: () => void;\n  } | null = null;\n  _preventTap: boolean = true;\n  _swipePoints: any[] | null = null;\n  _preventSingleTap: boolean = true;\n  _preventDoubleTap: boolean = true;\n  _firstPointer: IGesturePointer | null = null;\n  _pointer0: IGesturePointer | null = null;\n  _pointer1: IGesturePointer | null = null;\n  constructor(options?: IGestureOptions) {\n    super();\n    this.resetOptions(options);\n  }\n  resetOptions(options?: IGestureOptions) {\n    const {\n      wheelDelay,\n      longTapInterval,\n      doubleTapInterval,\n      doubleTapDistance,\n      touchMoveDistance,\n      swipeVelocity,\n      swipeDuration,\n      raiseDuration,\n    } = options || {};\n    this.wheelDelay = fixOption(wheelDelay, 350, 1);\n    this.longTapInterval = fixOption(longTapInterval, 750, 1);\n    this.doubleTapInterval = fixOption(doubleTapInterval, 250, 1);\n    this.doubleTapDistance = fixOption(doubleTapDistance, 30, 1);\n    this.touchMoveDistance = fixOption(touchMoveDistance, 3, 0);\n    this.swipeVelocity = fixOption(swipeVelocity, 0.3, 0);\n    this.swipeDuration = fixOption(swipeDuration, 100, 1);\n    this.raiseDuration = fixOption(raiseDuration, 100, 1);\n  }\n  preventAllTap(fp: boolean = true) {\n    this._preventTap = true;\n    this._preventSingleTap = true;\n    this._preventDoubleTap = true;\n    if (fp) {\n      this._firstPointer = null;\n    }\n    if (this._longTapTimer) {\n      clearTimeout(this._longTapTimer);\n      this._longTapTimer = 0;\n    }\n  }\n}\n\nexport type IGestureOptions = {\n  wheelDelay?: number; // 设置wheel等待时间，超时则认为结束滚动，单位ms\n  longTapInterval?: number; // 设置长按等待时间阈值，单位ms\n  doubleTapInterval?: number; // 设置双击时间间隔，单位ms\n  doubleTapDistance?: number; // 双击两次点击的位置距离触发阈值\n  touchMoveDistance?: number; // 移动阈值，超过这个值才算移动\n  swipeVelocity?: number; // swipe阶段的速率大于这个值才会触发swipe\n  swipeDuration?: number; // 移动过程中计入swipe的时间范围，即：最后一次移动事件向前推swipeDuration时间内，作为swipe阶段\n  raiseDuration?: number; // 最后一次移动到手指（点）抬起的时间间隔，小于这个值才会触发swipe\n};\n\nexport type IGestureDirection = 'Left' | 'Right' | 'Up' | 'Down' | 'None';\n\nexport type IGestureEventType =\n  | 'pan' // 平移\n  | 'tap' // 轻点（快，双击时会触发）\n  | 'swipe' // 快速滑动\n  | 'singleTap' // 点击（有延迟，双击时不触发）\n  | 'longTap' // 长按\n  | 'doubleTap' // 双击\n  | 'multiPan' // 平移\n  | 'scale' // 缩放\n  | 'rotate' // 旋转\n  | 'pointerStart' // 开始\n  | 'pointerMove' // 移动\n  | 'pointerEnd' // 抬起\n  | 'pointerCancel' // 触摸取消\n  | 'gestureStart' // 双（多）指开始\n  | 'gestureMove' // 双（多）指移动\n  | 'gestureEnd'; // 双（多）指结束\n\nexport type IGesturePointer = {\n  start: number[]; // 开始点\n  previous: number[]; // 上一个点\n  current: number[]; // 当前点\n  identifier: number; // 手指（点）id\n  changed: boolean; // 手指（点）是否变化\n};\n\nexport type IGestureEvent = {\n  pointers: IGesturePointer[]; // 当前停留在界面上的所有手指（点）\n  leavePointers: IGesturePointer[]; // 已经离开界面的所有手指（点）\n  getPoint: (whichOne?: 'start' | 'previous' | 'current') => number[]; // 获取当前点（两个点取中心值）参数是获取起点，还是当前点，还是移动时的上个点\n  scale?: number; // 缩放比例（和上一个点比较）\n  angle?: number; // 旋转角度（和上一个点比较）swipe角度\n  deltaX?: number; // x方向距离（和上一个点比较）\n  deltaY?: number; // y方向距离（和上一个点比较）\n  direction?: IGestureDirection; // 移动时的方向（和上一个点比较）swipe方向\n  moveScale?: number; // 缩放比例（和起点比较）\n  moveAngle?: number; // 旋转角度（和起点比较）\n  moveX?: number; // x方向距离（和起点比较）\n  moveY?: number; // y方向距离（和起点比较）\n  moveDirection?: IGestureDirection; // 移动时的方向（和起点比较）\n  velocity?: number; // swipe阶段速率（不是从起点到终点的速率）\n  waitTime?: number; // 长按等待时间\n  delayTime?: number; // 点击延迟时间\n  intervalTime?: number; // 双击间隔时间\n  swipeComputed?: (\n    factor: number,\n    _velocity?: number,\n  ) => {\n    duration: number; // swipe速率减到0花费的时间\n    stretchX: number; // x方向swipe惯性距离（抬起后，继续移动的距离）\n    stretchY: number; // y方向swipe惯性距离（抬起后，继续移动的距离）\n    deceleration: number; // swipe速率减到0的减速度\n  };\n  timestamp: number;\n  sourceEvent: any;\n};\n\nexport default Gesture;\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-23 11:27:38\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-06 12:01:41\n * @Description: ******\n */\n\nimport { getEventPoints, getDistance, getCenter } from '../utils';\nimport type Core from '../core';\nimport { type IGestureEvent } from '../core';\n\nexport default function started(this: Core, event: any) {\n  const newEvent: IGestureEvent = {\n    sourceEvent: event,\n    timestamp: Date.now(),\n    pointers: [],\n    leavePointers: [],\n    getPoint: () => [0, 0],\n  };\n  const { points, isFirst } = getEventPoints(event, true);\n  // 表示第一次放入手指（点）\n  if (isFirst) {\n    // 第一次点击，如果存在wheel没执行，需要执行掉\n    if (this._wheelTimerEnd) {\n      clearTimeout(this._wheelTimerEnd.timer);\n      this._wheelTimerEnd.wheelEnd();\n      this._wheelTimerEnd = null;\n    }\n    this._pointer0 = null;\n    this._pointer1 = null;\n  } else {\n    if (this._pointer0) {\n      this._pointer0.changed = false;\n    }\n    if (this._pointer1) {\n      this._pointer1.changed = false;\n    }\n  }\n  // 如果当前事件元素之外的屏幕上有手指（点），此时在事件元素上放一个手指（点），points会包含该手指（点）\n  // 循环保存放在屏幕上的手指（点），这里只会保存最多两个，忽略超过三个的手指（点）（只对单指和双指情形处理）\n  for (let i = 0, len = points.length; i < len; ++i) {\n    const t = points[i];\n    const p = [t.pageX, t.pageY];\n    const pointer = {\n      start: p,\n      previous: p,\n      current: p,\n      identifier: t.identifier,\n      changed: true,\n    };\n    if (!this._pointer0) {\n      this._pointer0 = pointer;\n    } else if (!this._pointer1 && this._pointer0.identifier !== t.identifier) {\n      this._pointer1 = pointer;\n    }\n  }\n  // 每次进入时先阻止所有单指事件\n  this.preventAllTap(false);\n  this._swipePoints = null;\n  this._rotateAngle = 0;\n  // 双指start\n  const pointer0 = this._pointer0;\n  const pointer1 = this._pointer1;\n  if (pointer1 && pointer0) {\n    this._firstPointer = null;\n    newEvent.pointers = [pointer0, pointer1];\n    newEvent.getPoint = () => getCenter(pointer0.current, pointer1.current);\n    this.emit('gestureStart', newEvent);\n  }\n  // 单指start\n  else if (pointer0) {\n    newEvent.pointers = [pointer0];\n    newEvent.getPoint = () => pointer0.current;\n    this._preventTap = false;\n    // 设置一个长按定时器\n    this._longTapTimer = +setTimeout(() => {\n      // 当前点击一旦长按超过longTapInterval则触发longTap，则松开后不会再触发所有单指事件\n      this._preventTap = true;\n      this._preventSingleTap = true;\n      this._preventDoubleTap = true;\n      this._longTapTimer = 0;\n      this._firstPointer = null;\n      newEvent.waitTime = this.longTapInterval;\n      this.emit('longTap', newEvent);\n    }, this.longTapInterval);\n    const firstPointer = this._firstPointer;\n    const singleTapTimer = this._singleTapTimer;\n    if (\n      singleTapTimer &&\n      firstPointer &&\n      getDistance(firstPointer.current, pointer0.current) < this.doubleTapDistance\n    ) {\n      // 1，只要连续两次点击时间在doubleTapInterval之内，距离在doubleTapDistance内，无论第二次作何操作，都不会触发第一次的singleTap，但第一次的tap会触发\n      // 2，如果满足第一条时，第二次的点击有多根手指（点），或者长按触发longTap，则不会再触发doubleTap，第二次的tap，singleTap也不会触发\n      clearTimeout(singleTapTimer);\n      this._singleTapTimer = 0;\n      this._preventSingleTap = true;\n      this._preventDoubleTap = false;\n      newEvent.getPoint = () => firstPointer.current;\n    } else {\n      this._firstPointer = pointer0;\n      // 表示是第一次点击或该次点击距离上一次点击时间超过doubleTapInterval，距离超过doubleTapDistance\n      this._preventSingleTap = false;\n      this._preventDoubleTap = true;\n    }\n  }\n  // 无指没有start\n  else {\n    return;\n  }\n  this.emit('pointerStart', newEvent);\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-23 11:27:38\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-13 12:34:31\n * @Description: ******\n */\n\nimport { getEventPoints, getDirection, getDistance, getAngle, getCenter } from '../utils';\nimport type Core from '../core';\nimport { type IGestureEvent } from '../core';\n\nexport default function moved(this: Core, event: any) {\n  const newEvent: IGestureEvent = {\n    sourceEvent: event,\n    timestamp: Date.now(),\n    pointers: [],\n    leavePointers: [],\n    getPoint: () => [0, 0],\n  };\n  if (this._pointer0) {\n    this._pointer0.changed = false;\n  }\n  if (this._pointer1) {\n    this._pointer1.changed = false;\n  }\n  // 循环更新手指（点）\n  const { points } = getEventPoints(event);\n  for (let i = 0, len = points.length; i < len; ++i) {\n    const t = points[i];\n    const p = [t.pageX, t.pageY];\n    if (this._pointer0 && this._pointer0.identifier === t.identifier) {\n      this._pointer0.changed = true;\n      this._pointer0.previous = this._pointer0.current;\n      this._pointer0.current = p;\n    } else if (this._pointer1 && this._pointer1.identifier === t.identifier) {\n      this._pointer1.changed = true;\n      this._pointer1.previous = this._pointer1.current;\n      this._pointer1.current = p;\n    }\n  }\n  // 手指（点）移动至少要有一个手指（点）移动超过touchMoveDistance才会触发移动事件\n  const pointer0 = this._pointer0;\n  const pointer1 = this._pointer1;\n  if (\n    (pointer0 && getDistance(pointer0.start, pointer0.current) > this.touchMoveDistance) ||\n    (pointer1 && getDistance(pointer1.start, pointer1.current) > this.touchMoveDistance)\n  ) {\n    // 一旦移动，则阻止所有单指点击相关事件（除了swipe）\n    this.preventAllTap();\n    // 双指移动情况\n    if (pointer1 && pointer0) {\n      newEvent.pointers = [pointer0, pointer1];\n      const { start: start0, previous: previous0, current: current0 } = pointer0;\n      const { start: start1, previous: previous1, current: current1 } = pointer1;\n      // 双指平移\n      const eCenter = getCenter(current0, current1);\n      const mCenter = getCenter(previous0, previous1);\n      const sCenter = getCenter(start0, start1);\n      newEvent.getPoint = (whichOne) =>\n        whichOne === 'start' ? sCenter : whichOne === 'previous' ? mCenter : eCenter;\n      newEvent.direction = getDirection(mCenter, eCenter);\n      newEvent.moveDirection = getDirection(sCenter, eCenter);\n      newEvent.deltaX = eCenter[0] - mCenter[0];\n      newEvent.moveX = eCenter[0] - sCenter[0];\n      newEvent.deltaY = eCenter[1] - mCenter[1];\n      newEvent.moveY = eCenter[1] - sCenter[1];\n      // 只有双指滑动时才会触发下面事件\n      const eDistance = getDistance(current0, current1);\n      const mDistance = getDistance(previous0, previous1);\n      const sDistance = getDistance(start0, start1);\n      if (sDistance > 0 && eDistance > 0 && mDistance > 0) {\n        // 双指缩放\n        newEvent.scale = eDistance / mDistance;\n        newEvent.moveScale = eDistance / sDistance;\n      }\n      const eAngle = getAngle(current0, current1);\n      const mAngle = getAngle(previous0, previous1);\n      // const sAngle = getAngle(start0, start1);\n      // 这里计算的三个angle均是向量（第一个参数为起点，第二个为终点）与x正半轴之间的夹角\n      // 方向朝向y轴正半轴的为正值[0,180]，朝向y轴负半轴的为负值[-180,0]\n      // 注意，这里坐标轴是页面坐标，x轴向右正方向，y轴向下正方向，原点在左上角\n      let angle = eAngle - mAngle;\n      if (angle < -180) {\n        // 此种情况属于顺时针转动时mAngle突然由正变为负值（比如由178度顺时针旋转4度都-178度）\n        // 这种情况，因为eAngle和mAngle是两次相邻的移动事件，间隔角度很小（4度）而不会是很大的（-356度）\n        angle += 360;\n      } else if (angle > 180) {\n        // 和上面相反逆时针转动（比如由-178逆时针旋转4度到178）\n        angle -= 360;\n      }\n      // 双指旋转本次和上一次的角度，正值顺时针，负值逆时针\n      newEvent.angle = angle;\n      // 双指旋转起点到终点的总旋转角度，正值顺时针，负值逆时针\n      // 这里不能直接使用eAngle-sAngle，否则顺逆时针分不清，需要通过angle累加\n      this._rotateAngle += angle;\n      newEvent.moveAngle = this._rotateAngle;\n      this.emit('rotate', newEvent);\n      if (sDistance > 0 && eDistance > 0 && mDistance > 0) {\n        this.emit('scale', newEvent);\n      }\n      this.emit('multiPan', newEvent);\n      this.emit('gestureMove', newEvent);\n    }\n    // 单指移动\n    else if (pointer0) {\n      newEvent.pointers = [pointer0];\n      const { start, previous, current } = pointer0;\n      newEvent.getPoint = (whichOne) =>\n        whichOne === 'start' ? start : whichOne === 'previous' ? previous : current;\n      newEvent.direction = getDirection(previous, current);\n      newEvent.moveDirection = getDirection(start, current);\n      newEvent.deltaX = current[0] - previous[0];\n      newEvent.moveX = current[0] - start[0];\n      newEvent.deltaY = current[1] - previous[1];\n      newEvent.moveY = current[1] - start[1];\n      const _timestamp = Date.now();\n      // 第一次移动this._swipePoints为null\n      const _swipePoints = this._swipePoints || [[], []];\n      const _duration = _timestamp - ((_swipePoints[1][0] ? _swipePoints[1][0].timestamp : 0) || 0);\n      // 当前时间与本阶段初始时间之差大于计入swipe的时间(swipeDuration)，则本阶段过时，下阶段开启\n      if (_duration > this.swipeDuration) {\n        // 将本阶段作为上一阶段，开启下一阶段作为本阶段\n        _swipePoints[0] = _swipePoints[1];\n        _swipePoints[1] = [];\n      }\n      // 将当前移动点和时间存入本阶段\n      _swipePoints[1].push({\n        point: current,\n        timestamp: _timestamp,\n      });\n      this._swipePoints = _swipePoints;\n      // 触发单指平移事件\n      this.emit('pan', newEvent);\n    }\n    // 无指无移动\n    else {\n      return;\n    }\n    this.emit('pointerMove', newEvent);\n  }\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-23 11:27:38\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-06 14:45:49\n * @Description: ******\n */\n\nimport {\n  getEventPoints,\n  getDirection,\n  getDistance,\n  getAngle,\n  getCenter,\n  getVelocity,\n  getVector,\n} from '../utils';\nimport type Core from '../core';\nimport { type IGestureEvent, type IGesturePointer } from '../core';\n\nexport default function ended(this: Core, event: any) {\n  const newEvent: IGestureEvent = {\n    sourceEvent: event,\n    timestamp: Date.now(),\n    pointers: [],\n    leavePointers: [],\n    getPoint: () => [0, 0],\n  };\n  // 临时保存当前手指（点）\n  let pointer0: IGesturePointer | null = null;\n  let pointer1: IGesturePointer | null = null;\n  if (this._pointer0) {\n    this._pointer0.changed = false;\n  }\n  if (this._pointer1) {\n    this._pointer1.changed = false;\n  }\n  // 循环删除已经拿开的手指（点）\n  const { points } = getEventPoints(event);\n  for (let i = 0, len = points.length; i < len; ++i) {\n    const t = points[i];\n    if (this._pointer0 && this._pointer0.identifier === t.identifier) {\n      this._pointer0.changed = true;\n      pointer0 = this._pointer0;\n      this._pointer0 = null;\n    } else if (this._pointer1 && this._pointer1.identifier === t.identifier) {\n      this._pointer1.changed = true;\n      pointer1 = this._pointer1;\n      this._pointer1 = null;\n    }\n  }\n  // 双指变单指\n  if (this._pointer1 && !this._pointer0) {\n    this._pointer0 = this._pointer1;\n    this._pointer1 = null;\n    pointer1 = pointer0;\n    pointer0 = null;\n  }\n  // 松开时清除longTapTimer（一旦松开就不存在长按，当然有可能已经发生过了）\n  if (this._longTapTimer) {\n    clearTimeout(this._longTapTimer);\n    this._longTapTimer = 0;\n  }\n  // 仍然存在至少一根手指（点）\n  if (this._pointer0) {\n    newEvent.pointers = [this._pointer0];\n    if (this._pointer1) {\n      // 剩余两指\n      newEvent.pointers.push(this._pointer1);\n    } else if (pointer1) {\n      // 剩余一指\n      newEvent.leavePointers = [pointer1];\n      this._rotateAngle = 0;\n    }\n    const start = getCenter(\n      this._pointer0.start,\n      this._pointer1 ? this._pointer1.start : pointer1 ? pointer1.start : [],\n    );\n    const previous = getCenter(\n      this._pointer0.previous,\n      this._pointer1 ? this._pointer1.previous : pointer1 ? pointer1.previous : [],\n    );\n    const current = getCenter(\n      this._pointer0.current,\n      this._pointer1 ? this._pointer1.current : pointer1 ? pointer1.current : [],\n    );\n    newEvent.getPoint = (whichOne) =>\n      whichOne === 'start' ? start : whichOne === 'previous' ? previous : current;\n    this.emit('gestureEnd', newEvent);\n  }\n  // 全部拿开\n  else if (pointer0) {\n    // 多指的最后一指抬起，仅仅一指抬起\n    newEvent.leavePointers = [pointer0];\n    if (pointer1) {\n      // 双指同时抬起\n      newEvent.leavePointers.push(pointer1);\n    }\n    const start = pointer1 ? getCenter(pointer0.start, pointer1.start) : pointer0.start;\n    const previous = pointer1 ? getCenter(pointer0.previous, pointer1.previous) : pointer0.previous;\n    const current = pointer1 ? getCenter(pointer0.current, pointer1.current) : pointer0.current;\n    newEvent.getPoint = (whichOne) =>\n      whichOne === 'start' ? start : whichOne === 'previous' ? previous : current;\n    if (!this._preventTap) {\n      this.emit('tap', newEvent);\n      this._preventTap = true;\n    }\n    if (!this._preventSingleTap) {\n      // 等待doubleTapInterval，如果时间内没有点击第二次，则触发\n      this._singleTapTimer = +setTimeout(() => {\n        this._singleTapTimer = 0;\n        newEvent.delayTime = this.doubleTapInterval;\n        this.emit('singleTap', newEvent);\n      }, this.doubleTapInterval);\n      this._preventSingleTap = true;\n    }\n    if (!this._preventDoubleTap) {\n      // 双击点使用第一次的点\n      const firstPointer = this._firstPointer;\n      if (firstPointer) {\n        newEvent.getPoint = () => firstPointer.current;\n      }\n      newEvent.intervalTime = this.doubleTapInterval;\n      this.emit('doubleTap', newEvent);\n      this._firstPointer = null;\n      this._preventDoubleTap = true;\n    }\n    // this._swipePoints存在表示开始了swipe行为\n    if (this._swipePoints) {\n      const [prev, next] = this._swipePoints;\n      // 最后一次移动的点即为swipe终点\n      const endPos = next[next.length - 1];\n      // 最后一次移动点的时间减去手指（点）抬起的时间，此间隔时间需小于等待时间raiseDuration，否则视为停止swipe\n      if (Date.now() - endPos.timestamp <= this.raiseDuration) {\n        // 找到计入swipe的时间(swipeDuration)内的swipe起点\n        let startPos = next[0];\n        for (let i = prev.length - 1; i >= 0; i--) {\n          if (endPos.timestamp - prev[i].timestamp <= this.swipeDuration) {\n            startPos = prev[i];\n          } else {\n            break;\n          }\n        }\n        // 根据swipe起点和终点的距离差与时间差算出swipe抬起时速率\n        const velocity = getVelocity(\n          endPos.timestamp - startPos.timestamp,\n          getDistance(startPos.point, endPos.point),\n        );\n        // swipe速率需要大于swipeVelocity，否则忽略不计，不视为swipe\n        if (velocity > this.swipeVelocity) {\n          // 滑动方向与x夹角\n          const angle = getAngle(startPos.point, endPos.point);\n          // 惯性的方向\n          newEvent.direction = getDirection(startPos.point, endPos.point);\n          newEvent.angle = angle;\n          newEvent.velocity = velocity;\n          // 给出按照velocity速度滑动，当速度减到0时的计算函数：\n          // 当给出时间t，即在t时间内速度减到0，求出滑动的距离：\n          // 当给出减速度a，即在减速度a的作用下，速度减到0，求出滑动的距离，和消耗的时间：\n          // 减速度某个时间的位移：s = v0 * t - (a * t * t) / 2\n          // 减速度某个时间的速度：v = v0 - a * t\n          // s为滑动距离，v末速度为0，v0初速度为velocity\n          newEvent.swipeComputed = (factor: number, _velocity: number = velocity) => {\n            // 因子大于1可以认为传入的是时间毫秒数\n            let duration = 0;\n            let deceleration = 0;\n            let distance = 0;\n            if (factor > 1) {\n              duration = factor;\n              deceleration = _velocity / duration;\n              distance = (_velocity * duration) / 2;\n            }\n            // 因子小于1可以认为传入的是减速度（减速如果大于1一般太大了，不符合使用场景）\n            else if (factor > 0) {\n              deceleration = factor;\n              duration = _velocity / deceleration;\n              distance = (_velocity * _velocity) / (2 * deceleration);\n            }\n            const [stretchX, stretchY] = getVector(distance, angle);\n            return {\n              duration, // swipe速率减到0花费的时间\n              stretchX, // x方向swipe惯性距离（抬起后，继续移动的距离）\n              stretchY, // y方向swipe惯性距离（抬起后，继续移动的距离）\n              deceleration, // swipe速率减到0的减速度\n            };\n          };\n          /**\n           * swipe思路:\n           * 根据移动停止前swipeDuration时间内移动的距离和时间算出速度，\n           * 速度大于swipeVelocity，并且移动停止后到手指（点）抬起时间间隔小于raiseDuration即为swipe\n           * 移动停止就是最后一次触发move事件\n           * 0. start 清空_swipePoints\n           * 1. move 每swipeDuration时间内所移动的点分为一组，只保留上一次swipeDuration时间组和这一次swipeDuration时间组，存储在_swipePoints内\n           * 2. end 松开手时, 在_swipePoints内找到起终点，根据起终点距离和时间差算出速度，然后算出其他值\n           */\n          this.emit('swipe', newEvent);\n          this._swipePoints = null;\n        }\n      }\n    }\n  }\n  this.emit('pointerEnd', newEvent);\n  /* // 只剩下一根在上面了，以下事件交给用户自行放在pointerEnd事件里自行判断\n  if (this._pointer0 && !this._pointer1) {\n    // 双指抬起，只剩下一指，此时就认为该点是移动的起点（否则会把双指移动的起点作为起点，移动时会出现跳跃）\n    this._pointer0.start = this._pointer0.previous = this._pointer0.current;\n    // 同时可以触发一次start事件\n    newEvent.pointers = [this._pointer0];\n    newEvent.pointer = this._pointer0;\n    this.emit('pointerStart', newEvent);\n  } */\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-23 11:27:38\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-06 15:23:25\n * @Description: ******\n */\n\nimport ended from './ended';\nimport type Core from '../core';\n\nexport default function canceled(this: Core, event: any) {\n  this.emit('pointerCancel', {\n    sourceEvent: event,\n    timestamp: Date.now(),\n    pointers: [],\n    leavePointers: [],\n    getPoint: () => [0, 0],\n  });\n  ended.apply(this, [event]);\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-23 11:27:38\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-06 15:22:21\n * @Description: ******\n */\n\nimport started from './started';\nimport moved from './moved';\nimport ended from './ended';\nimport { getDirection } from '../utils';\nimport type Core from '../core';\nimport { type IGestureEvent } from '../core';\n\nexport default function downed(this: Core, event: any) {\n  const that = this;\n  if (typeof window !== 'undefined') {\n    window.addEventListener('mousemove', mousemoved);\n    window.addEventListener('mouseup', mouseupped);\n    window.addEventListener('blur', blured);\n    window.addEventListener('dragstart', dragstarted, {\n      capture: true,\n      passive: false,\n    });\n    if ('onselectstart' in window.document.documentElement) {\n      window.addEventListener('selectstart', dragstarted, {\n        capture: true,\n        passive: false,\n      });\n    }\n  }\n  function unbind() {\n    if (typeof window !== 'undefined') {\n      window.removeEventListener('mousemove', mousemoved);\n      window.removeEventListener('mouseup', mouseupped);\n      window.removeEventListener('blur', blured);\n      window.removeEventListener('dragstart', dragstarted);\n      if ('onselectstart' in window.document.documentElement) {\n        window.removeEventListener('selectstart', dragstarted);\n      }\n    }\n  }\n  function blured(e: Event) {\n    e.preventDefault();\n    e.stopPropagation();\n    unbind();\n  }\n  function dragstarted(e: Event) {\n    e.preventDefault();\n    e.stopPropagation();\n  }\n  function mousemoved(e: MouseEvent) {\n    if (event.button === 0) {\n      moved.apply(that, [e]);\n    } else {\n      const newEvent: IGestureEvent = {\n        sourceEvent: event,\n        timestamp: Date.now(),\n        pointers: [],\n        leavePointers: [],\n        getPoint: () => [0, 0],\n      };\n      const point = [e.pageX, e.pageY];\n      if (that._pointer0) {\n        that._pointer0.previous = that._pointer0.current;\n        that._pointer0.current = point;\n        newEvent.pointers = [that._pointer0];\n        const { start, previous, current } = that._pointer0;\n        newEvent.getPoint = (whichOne) =>\n          whichOne === 'start' ? start : whichOne === 'previous' ? previous : current;\n        newEvent.direction = getDirection(previous, current);\n        newEvent.moveDirection = getDirection(start, current);\n        newEvent.deltaX = current[0] - previous[0];\n        newEvent.moveX = current[0] - start[0];\n        newEvent.deltaY = current[1] - previous[1];\n        newEvent.moveY = current[1] - start[1];\n        // 根据移动距离计算：1度 = 4px; 正值顺时针，负值逆时针\n        newEvent.angle = newEvent.deltaX / 4;\n        newEvent.moveAngle = newEvent.moveX / 4;\n        that.emit('rotate', newEvent);\n      }\n    }\n  }\n  function mouseupped(e: MouseEvent) {\n    unbind();\n    if (event.button === 0) {\n      ended.apply(that, [e]);\n    } else {\n      const newEvent: IGestureEvent = {\n        sourceEvent: event,\n        timestamp: Date.now(),\n        pointers: [],\n        leavePointers: [],\n        getPoint: () => [0, 0],\n      };\n      const point = [e.pageX, e.pageY];\n      if (that._pointer0) {\n        const pointer0 = that._pointer0;\n        that._pointer0 = null;\n        pointer0.previous = pointer0.current;\n        pointer0.current = point;\n        newEvent.leavePointers = [pointer0];\n        const { start, previous, current } = pointer0;\n        newEvent.getPoint = (whichOne) =>\n          whichOne === 'start' ? start : whichOne === 'previous' ? previous : current;\n      }\n      newEvent.angle = 0 / 0;\n      that.emit('rotate', newEvent);\n    }\n  }\n  if (event.button === 0) {\n    started.apply(that, [event]);\n  } else {\n    // 如果存在wheel没执行，需要执行掉\n    if (that._wheelTimerEnd) {\n      clearTimeout(that._wheelTimerEnd.timer);\n      that._wheelTimerEnd.wheelEnd();\n      that._wheelTimerEnd = null;\n    }\n    const point = [event.pageX, event.pageY];\n    that._pointer0 = {\n      start: point,\n      previous: point,\n      current: point,\n      identifier: -1,\n      changed: true,\n    };\n  }\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-23 11:27:38\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-06 15:38:35\n * @Description: ******\n */\n\nimport type Core from '../core';\nimport { type IGestureEvent } from '../core';\n\nexport default function wheeled(this: Core, event: any) {\n  const newEvent: IGestureEvent = {\n    sourceEvent: event,\n    timestamp: Date.now(),\n    pointers: [],\n    leavePointers: [],\n    getPoint: () => [0, 0],\n  };\n  const point = [event.pageX, event.pageY];\n  if (this._wheelTimerEnd) {\n    if (this._pointer0) {\n      this._pointer0.previous = this._pointer0.current;\n      this._pointer0.current = point;\n    }\n    clearTimeout(this._wheelTimerEnd.timer);\n    // wheelRoll\n  } else {\n    this._pointer0 = {\n      start: point,\n      previous: point,\n      current: point,\n      identifier: -1,\n      changed: true,\n    };\n    // wheelstart\n  }\n  const wheelEnd = () => {\n    this._pointer0 = null;\n    this._wheelTimerEnd = null;\n    newEvent.timestamp = Date.now();\n    // 表示滚轮结束，不参与计算\n    newEvent.scale = 0 / 0;\n    this.emit('scale', newEvent);\n    // wheelEnd\n  };\n  this._wheelTimerEnd = {\n    wheelEnd,\n    timer: +setTimeout(wheelEnd, this.wheelDelay),\n    scale: this._wheelTimerEnd ? this._wheelTimerEnd.scale : 1,\n  };\n  if (this._pointer0) {\n    newEvent.pointers = [this._pointer0];\n    const { start, previous, current } = this._pointer0;\n    newEvent.getPoint = (whichOne) =>\n      whichOne === 'start' ? start : whichOne === 'previous' ? previous : current;\n    const scale = Math.pow(\n      2,\n      -event.deltaY * (event.deltaMode === 1 ? 0.05 : event.deltaMode ? 1 : 0.002),\n    );\n    this._wheelTimerEnd.scale *= scale;\n    newEvent.moveScale = this._wheelTimerEnd.scale;\n    newEvent.scale = scale;\n    this.emit('scale', newEvent);\n  }\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-22 16:15:47\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-28 09:45:09\n * @Description: ******\n */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { useEvents } from './useEvents';\nimport { useIsomorphicLayoutEffect } from './useIsomorphicLayoutEffect';\nimport Core, { type IGestureOptions, type IGestureEvent } from '../core';\nimport { started, moved, ended, canceled, downed, wheeled } from '../events';\nimport { isTouchable } from '../utils';\n\nexport type IGestureRef = {\n  findDOMElement: () => Element | null | undefined;\n  getInstance: () => Core | null | undefined;\n};\n\nexport type IHandler = ((e: IGestureEvent) => void) | null;\nexport type IGestureHandler = {\n  onPan?: IHandler;\n  onTap?: IHandler;\n  onSwipe?: IHandler;\n  onSingleTap?: IHandler;\n  onLongTap?: IHandler;\n  onDoubleTap?: IHandler;\n  onMultiPan?: IHandler;\n  onScale?: IHandler;\n  onRotate?: IHandler;\n  onPointerStart?: IHandler;\n  onPointerMove?: IHandler;\n  onPointerEnd?: IHandler;\n  onPointerCancel?: IHandler;\n  onGestureStart?: IHandler;\n  onGestureMove?: IHandler;\n  onGestureEnd?: IHandler;\n};\n\nexport type IGestureProps = {\n  preventAllTap?: boolean;\n  options?: IGestureOptions;\n  children?: React.ReactNode;\n} & IGestureHandler;\n\nexport default React.forwardRef<IGestureRef, IGestureProps>(\n  ({ children, options, preventAllTap, ...events }, ref) => {\n    const elementRef = React.useRef<Element | null>(null);\n    const coreRef = React.useRef<Core | null>(null);\n\n    useIsomorphicLayoutEffect(() => {\n      coreRef.current = new Core();\n    }, []);\n\n    useIsomorphicLayoutEffect(() => {\n      if (coreRef.current) {\n        coreRef.current.resetOptions(options);\n      }\n    }, [options]);\n\n    useIsomorphicLayoutEffect(() => {\n      if (preventAllTap && coreRef.current) {\n        coreRef.current.preventAllTap();\n      }\n    }, [preventAllTap]);\n\n    useEvents(events, coreRef.current);\n\n    React.useImperativeHandle(\n      ref,\n      (): IGestureRef => ({\n        findDOMElement: () => elementRef.current,\n        getInstance: () => coreRef.current,\n      }),\n      [],\n    );\n\n    // 这里ref函数使用useCallback，为了使每次渲染ref函数为同一个函数\n    // 如果函数直接写在下面的ref里，如下所示，则箭头函数在每次渲染都相当于重新创建\n    // 此时react里会比较发现ref函数变化，就会先执行变化前的函数，传入null，再执行变化后的函数，传入实际值\n    // React.cloneElement(children, {\n    //   ref: (a)=>{\n    //     ...\n    //   },\n    // })\n    const refFun = React.useCallback((_ref: React.ReactInstance) => {\n      let element: any = _ref;\n      // ref是Element的时候不需要查找，只有是React.Component的时候才可以查找\n      if (!(_ref instanceof Element) && _ref instanceof React.Component) {\n        element = ReactDOM.findDOMNode(_ref);\n      }\n      if (!(element instanceof Element)) {\n        element = null;\n      }\n      elementRef.current = element;\n    }, []);\n\n    if (!children) {\n      console.warn('Warning: Gesture children must exist.');\n      return null;\n    }\n    return React.Children.only(\n      React.cloneElement(children as any, {\n        ref: refFun,\n        ...(isTouchable()\n          ? {\n              onTouchStart: coreRef.current && started.bind(coreRef.current),\n              onTouchMove: coreRef.current && moved.bind(coreRef.current),\n              onTouchEnd: coreRef.current && ended.bind(coreRef.current),\n              onTouchCancel: coreRef.current && canceled.bind(coreRef.current),\n            }\n          : {\n              onMouseDown: coreRef.current && downed.bind(coreRef.current),\n              onWheel: coreRef.current && wheeled.bind(coreRef.current),\n            }),\n      }),\n    );\n  },\n);\n","/*\n * @Author: Huangjs\n * @Date: 2023-02-13 15:22:58\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-28 09:36:43\n * @Description: ******\n */\n\nlet cached: number;\nfunction measureScrollBarSize(fresh?: boolean) {\n  if (typeof document === 'undefined') {\n    return 0;\n  }\n  if (fresh || cached === undefined) {\n    const inner = document.createElement('div');\n    inner.style.width = '100%';\n    inner.style.height = '200px';\n    const outer = document.createElement('div');\n    const outerStyle = outer.style;\n    outerStyle.position = 'absolute';\n    outerStyle.top = '0';\n    outerStyle.left = '0';\n    outerStyle.pointerEvents = 'none';\n    outerStyle.visibility = 'hidden';\n    outerStyle.width = '200px';\n    outerStyle.height = '150px';\n    outerStyle.overflow = 'hidden';\n    outer.appendChild(inner);\n    document.body.appendChild(outer);\n    const widthContained = inner.offsetWidth;\n    outer.style.overflow = 'scroll';\n    let widthScroll = inner.offsetWidth;\n    if (widthContained === widthScroll) {\n      widthScroll = outer.clientWidth;\n    }\n    document.body.removeChild(outer);\n    cached = widthContained - widthScroll;\n  }\n  return cached;\n}\nfunction ensureSize(str: string) {\n  const match = str.match(/^(.*)px$/);\n  const value = Number(match?.[1]);\n  return Number.isNaN(value) ? measureScrollBarSize() : value;\n}\nexport function getScrollBarSize(target: Element | boolean) {\n  if (typeof target === 'boolean') {\n    const size = measureScrollBarSize(target);\n    return {\n      width: size,\n      height: size,\n    };\n  }\n  if (typeof document === 'undefined' || !target || !(target instanceof Element)) {\n    return { width: 0, height: 0 };\n  }\n  const { width, height } = getComputedStyle(target, '::-webkit-scrollbar');\n  return {\n    width: ensureSize(width),\n    height: ensureSize(height),\n  };\n}\n\nexport function isBodyOverflowing() {\n  return (\n    document.body.scrollHeight > (window.innerHeight || document.documentElement.clientHeight) &&\n    window.innerWidth > document.body.offsetWidth\n  );\n}\n\nexport function cssInject(id: string, cssText: string) {\n  let style = document.querySelector(`#${id}`);\n  if (!style) {\n    style = document.createElement('style');\n    style.id = id;\n    style.appendChild(document.createTextNode(cssText));\n    (document.head || document.getElementsByTagName('head')[0]).appendChild(style);\n  }\n}\n\nexport type ICSSStyle = { [key: string]: string | number | undefined };\nconst autoPxReg =\n  /^(?:-border(?:-top|-right|-bottom|-left)?(?:-width|)|(?:-margin|-padding)?(?:-top|-right|-bottom|-left)?|(?:-min|-max)?(?:-width|-height))$/;\nexport function setStyle(el?: Element | null, style?: ICSSStyle) {\n  if (el && style) {\n    let cssText = '';\n    Object.keys(style).forEach((key: string) => {\n      // 转连字符\n      const name = key.replace(/([A-Z])/g, '-$1').toLocaleLowerCase();\n      // 转驼峰\n      // const key = name.replace(/-(.?)/g, (t) => t.replace('-', '').toLocaleUpperCase());\n      const value = style[key];\n      if (value || value === 0) {\n        const suffix =\n          typeof value === 'number' && /^[a-z]/.test(name) && autoPxReg.test(`-${name}`)\n            ? 'px'\n            : '';\n        cssText += `${name}: ${value}${suffix};`;\n      } else {\n        (el as HTMLElement | SVGElement).style.removeProperty(name);\n      }\n    });\n    (el as HTMLElement | SVGElement).style.cssText += cssText;\n  }\n  return el;\n}\n\nexport function hasClass(el?: Element | null, className?: string) {\n  if (el && className) {\n    return el.classList.contains(className);\n  }\n  return false;\n}\n\nexport function addClass(el?: Element | null, className?: string | string[]) {\n  if (el && className) {\n    (Array.isArray(className) ? className : className.split(' ')).forEach(\n      (c) => c && el.classList.add(c),\n    );\n  }\n  return el;\n}\n\nexport function removeClass(el?: Element | null, className?: string | string[]) {\n  if (el && className) {\n    (Array.isArray(className) ? className : className.split(' ')).forEach(\n      (c) => c && el.classList.remove(c),\n    );\n  }\n  return el;\n}\n\nexport type IElement = string | Element | (() => Element | null | undefined) | null | undefined;\n\nexport function getElement(container?: IElement) {\n  let _container: any = container;\n  if (typeof container === 'string') {\n    _container = document.querySelector(container);\n  }\n  if (typeof container === 'function') {\n    _container = container();\n  }\n  return (_container || null) as Element | null;\n}\ntype IChildren = string | number | boolean | null | undefined | Element;\ntype IProps = {\n  className?: string | string[];\n  style?: ICSSStyle;\n  attrs?: {\n    [key: string]: string;\n  };\n};\nexport function createElement(\n  type?: string | IProps,\n  props?: IProps | IChildren | IChildren[],\n  children?: IChildren | IChildren[] | IElement,\n  parent?: Element,\n) {\n  let _type: string;\n  let _props: IProps;\n  let _children: IChildren[];\n  let _parent: IElement;\n  if (typeof type === 'string') {\n    _type = type;\n    _props = (props || {}) as IProps;\n    _children = (Array.isArray(children) ? children : [children]) as IChildren[];\n    _parent = parent as IElement;\n  } else {\n    // 没有type的情况，参数向前推一个位置\n    _type = 'div';\n    _props = type || {};\n    _children = (Array.isArray(props) ? props : [props]) as IChildren[];\n    _parent = children as IElement;\n  }\n  const element = setStyle(\n    addClass(document.createElement(_type), _props.className),\n    _props.style,\n  ) as Element;\n  const _attrs = _props.attrs || {};\n  Object.keys(_attrs).forEach((key) => {\n    if (key !== 'innerHTML' && key !== 'className' && key !== 'style' && key in element) {\n      (element as any)[key] = _attrs[key];\n    }\n  });\n  _children.forEach((child) => {\n    if (child instanceof Element) {\n      element?.appendChild(child);\n    } else if (element && typeof child !== 'undefined' && child !== null) {\n      element.innerHTML = String(child);\n    }\n  });\n  getElement(_parent)?.appendChild(element);\n  return element;\n}\n\nexport function getBBox(element?: Element | null) {\n  if (element) {\n    const { left, top, width, height } = element.getBoundingClientRect();\n    return { left, top, width, height };\n  }\n  return { left: 0, top: 0, width: 0, height: 0 };\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-08 16:47:13\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-13 15:31:35\n * @Description: ******\n */\n\nimport React from 'react';\n\nexport function useChanged<T>(\n  value: T,\n  compare = (prev: T | void, next: T) => prev !== next,\n): boolean {\n  const propsRef = React.useRef<T>(value);\n  const changed = compare(propsRef.current, value);\n  if (changed) {\n    propsRef.current = value;\n  }\n  return changed;\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-08 16:47:13\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-13 15:35:55\n * @Description: ******\n */\n\nimport React from 'react';\nimport { useChanged } from './useChanged';\n\nexport function useForceUpdate() {\n  const setState = React.useState({})[1];\n  return React.useCallback(() => setState({}), [setState]);\n}\n\ntype Updater<T> = (updater: T | ((origin: T) => T)) => void;\nexport function useDerivedState<T>(\n  value: T | (() => T),\n  useCompare = (prev: T, next: T) => (useChanged(next) ? next : prev),\n): [T, Updater<T>] {\n  const _value = typeof value === 'function' ? (value as () => T)() : value;\n  const nowValueRef = React.useRef<T>(_value);\n  nowValueRef.current = useCompare(nowValueRef.current, _value);\n  const forceUpdate = useForceUpdate();\n  const updateValue: Updater<T> = React.useCallback(\n    (v) => {\n      const val = typeof v === 'function' ? (v as (origin: T) => T)(nowValueRef.current) : v;\n      // 是否需要比较？\n      if (val !== nowValueRef.current) {\n        nowValueRef.current = val;\n        forceUpdate();\n      }\n    },\n    [forceUpdate],\n  );\n  return [nowValueRef.current, updateValue];\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-24 16:40:36\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-20 14:29:15\n * @Description: ******\n */\n\nimport React from 'react';\n\nexport function canUseDOM() {\n  return !!(typeof window !== 'undefined' && window.document && window.document.createElement);\n}\n\nexport const useIsomorphicLayoutEffect = canUseDOM() ? React.useLayoutEffect : React.useEffect;\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-23 17:02:10\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-01 15:18:11\n * @Description: ******\n */\n\nconst root: any = typeof window === 'undefined' ? global : window;\nconst vendors = ['moz', 'webkit'];\nlet raf = root.requestAnimationFrame;\nlet caf = root.cancelAnimationFrame || root.cancelRequestAnimationFrame;\nif (!raf || !caf) {\n  for (var i = 0; i < vendors.length; i++) {\n    raf = root[`${vendors[i]}RequestAnimationFrame`];\n    caf =\n      root[`${vendors[i]}CancelAnimationFrame`] || root[`${vendors[i]}CancelRequestAnimationFrame`];\n  }\n}\nif (!raf || !caf) {\n  raf = (function () {\n    let last = 0;\n    // setTimeout时间并不精确，这里做了校准\n    return function (fn: () => void) {\n      const now = Date.now();\n      const delay = Math.max(0, 16 - (now - last));\n      last = now + delay;\n      return window.setTimeout(fn, delay);\n    };\n  })();\n  caf = function (id: number) {\n    return window.clearTimeout(id);\n  };\n}\n\nexport const requestAnimationFrame = raf;\nexport const cancelAnimationFrame = caf;\n","/*\n * @Author: Huangjs\n * @Date: 2023-02-13 15:22:58\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-14 09:42:52\n * @Description: ******\n */\n\nimport { requestAnimationFrame, cancelAnimationFrame } from './raf';\n\nconst delayCall = (callback: IAnimationCallBack, delay: number) => {\n  if (delay > 0) {\n    return +setTimeout(callback, delay);\n  }\n  callback(Math.abs(delay));\n  return 0;\n};\n\nclass Animation {\n  duration: number; // 动画执行持续时间\n  easing: IAnimationEasing; // 动画执行时变换函数\n  delay: number; // 动画延迟多久执行\n  _delay: number = 0; // 延迟执行剩余delay时间\n  _frameId: number = 0; // 当前正在执行帧的id\n  _elapsed: number = 0; // 本次动画已经消耗的时间\n  _sleepId: number = 0; // 当前正在休眠计时id\n  _delayId: number = 0; // 当前delay计时id\n  _tick: IAnimationCallBack | null = null; // 每一帧动画执行函数\n  _delayFn: IAnimationCallBack | null = null; // 延迟执行需要执行的函数\n  constructor({ duration, easing, delay }: IAnimationOptions = {}) {\n    this.duration = typeof duration !== 'number' || duration <= 0 ? 0 : duration;\n    this.easing = typeof easing !== 'function' ? (v) => v : easing;\n    this.delay = typeof delay !== 'number' ? 0 : delay;\n  }\n  start(frameFn: IAnimationCallBack) {\n    // 只有从未开始过或着已经结束了的动画可以再开始\n    if (!this._tick && !this._delayFn) {\n      const { duration, easing, delay } = this;\n      this._delayFn = (elapsed) => {\n        this._delayId = 0;\n        this._delayFn = null;\n        this._delay = 0;\n        if (duration > 0) {\n          const tick: IAnimationCallBack = (last) => {\n            // 本帧时间戳，last：上一帧时间戳\n            const now = Date.now();\n            // 累计已经耗用的时间\n            this._elapsed += now - last;\n            if (this._elapsed < duration) {\n              // 开启下一帧\n              this._frameId = requestAnimationFrame(() => tick(now));\n              // 每一帧的进度\n              frameFn(easing(this._elapsed / duration));\n            } else {\n              // 执行完毕后清除\n              this._tick = null;\n              this._frameId = 0;\n              this._elapsed = 0;\n              frameFn(1);\n            }\n          };\n          this._tick = tick;\n          // 第一次直接用掉这些时间\n          this._elapsed = elapsed || 0;\n          tick(Date.now());\n        } else {\n          // duration为0，直接运行到最后\n          frameFn(1);\n        }\n      };\n      // 记录延迟开始时间戳\n      this._delay = Date.now();\n      // 延迟执行\n      this._delayId = delayCall(this._delayFn, delay);\n    }\n  }\n  restart() {\n    if (this._tick || this._delayFn) {\n      // 只有动画在延迟、动画、休眠，停止的时候可以restart\n      // 重启之前先停止一切\n      this.stop();\n      if (this._tick) {\n        // 动画、休眠，停止状态，停止后，启动帧继续运行\n        this._tick(Date.now());\n      }\n      if (this._delayFn) {\n        const delay = this.delay + this._delay;\n        // 更新时间戳\n        this._delay += Date.now();\n        // 延迟状态，停止后，开启新的延迟\n        this._delayId = delayCall(this._delayFn, delay);\n      }\n    }\n  }\n  sleep(time: number) {\n    if (!time || time <= 0) {\n      // 没有设置休眠时间，则不做任何操作\n      return;\n    }\n    if (this._tick || this._delayFn) {\n      // 只有动画在延迟、动画、休眠，停止的时候可以进行休眠\n      // 这里注意，停止状态的时候点休眠，相当于延迟restart，时间一到会重启动画\n      // sleep之前先停止一切\n      this.stop();\n      // 启动本次休眠\n      this._sleepId = +setTimeout(() => {\n        this._sleepId = 0;\n        // 到时间后重启动画\n        this.restart();\n      }, time);\n    }\n  }\n  stop() {\n    if (this._tick || this._delayFn) {\n      if (this._delayId) {\n        // 如果正在delay，则停止delay\n        clearTimeout(this._delayId);\n        this._delayId = 0;\n        // 停止延迟时，已耗用时间\n        this._delay -= Date.now();\n      }\n      if (this._frameId) {\n        // 如果正在运行，即正在动画，则停止动画\n        cancelAnimationFrame(this._frameId);\n        this._frameId = 0;\n      }\n      if (this._sleepId) {\n        // 如果正在sleep，则停止sleep\n        clearTimeout(this._sleepId);\n        this._sleepId = 0;\n      }\n    }\n  }\n  end() {\n    if (this._tick || this._delayFn) {\n      // 只有动画在延迟、动画、休眠，停止的时候可以直接end\n      // end之前先停止一切\n      this.stop();\n      if (this._tick) {\n        // 动画、休眠，停止状态，停止后，启动帧运行到最后\n        this._tick(Date.now() + this._elapsed - this.duration);\n      }\n      if (this._delayFn) {\n        // 延迟状态，停止后，直接运行到最后\n        this._delayFn(this.duration);\n      }\n    }\n  }\n}\n\ntype IAnimationCallBack = (v: number) => void;\n\nexport type IAnimationEasing = (v: number) => number;\n\nexport type IAnimationOptions = {\n  duration?: number; // 动画持续时间\n  easing?: IAnimationEasing; // 动画变换函数\n  delay?: number; // 动画延迟多久执行，负数的话，会在第一次把这个时间内的变化一次性用掉，具体看css3-transition-delay\n};\n\nexport default Animation;\n","/*\n * @Author: Huangjs\n * @Date: 2023-02-13 15:22:58\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-06 15:57:42\n * @Description: ******\n */\n\nimport { type ICSSValue } from './index';\n\nexport default class Value {\n  value: ICSSValue; // 传入css属性值，对象或值的形式\n  precision?: ICSSValue; // 传入精度，与value对应\n  transform?: (v: ICSSValue) => string; // 传入实现该value转变为style的字符串方法\n  constructor(\n    value: number | ICSSValue,\n    precision?: number | ICSSValue,\n    transform?: (v: ICSSValue) => string,\n  ) {\n    const _value = (this.value = typeof value === 'number' ? { default: value } : value);\n    if (typeof precision === 'number') {\n      const _precision: ICSSValue = {};\n      Object.keys(_value).forEach((k) => {\n        _precision[k] = precision || 0;\n      });\n      this.precision = _precision;\n    } else if (precision) {\n      this.precision = precision;\n    }\n    if (typeof transform === 'function') {\n      this.transform = transform;\n    }\n  }\n  toRaw() {\n    const raw: {\n      value: ICSSValue;\n      precision?: ICSSValue;\n      transform?: (v: ICSSValue) => string;\n    } = { value: this.value };\n    if (this.precision) {\n      raw.precision = this.precision;\n    }\n    if (this.transform) {\n      raw.transform = this.transform;\n    }\n    return raw;\n  }\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-02-13 15:22:58\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-14 15:39:45\n * @Description: ******\n */\n\nimport Animation, { type IAnimationOptions } from '../animation';\nimport type ICSSOptionValue from './value';\nimport { union, delta } from './method';\n\nclass Transition {\n  cssProperties: ICSSProperties = {}; // 元素的css属性信息，和元素实际css结果保持同步\n  _cssProperties: ICSSProperties | null = null; // 每次动画开启前缓存的css信息，不会和元素实际css结果保持同步，是执行动画后的最终结果\n  _animations: {\n    animation: Animation; // 当前正在执行的过渡动画\n    remain: ICSSProperties; // 剩余未执行的值\n    cancel: boolean; // 该过渡动画是否可以停止\n  }[] = []; // 该属性执行所有过渡的动画集合\n  _apply: (style: ICSSStyle) => void;\n  constructor({ cssProperties, apply }: ITransitionOptions = {}) {\n    this._apply = apply || (() => {});\n    if (cssProperties) {\n      this.apply(cssProperties);\n    }\n  }\n  update() {\n    // 动画全部结束后将当前值更新为最终缓存值\n    if (!this.running() && this._cssProperties) {\n      this.cssProperties = this._cssProperties;\n      this._cssProperties = null;\n    }\n    // 更新样式\n    const { cssProperties } = this;\n    const style: ICSSStyle = {};\n    Object.keys(cssProperties).forEach((name) => {\n      const { value, transform } = cssProperties[name];\n      // 将驼峰转换为 - 连字符，style.setProperty只支持 - 连字符，不支持驼峰（不生效）\n      style[name.replace(/([A-Z])/g, '-$1').toLocaleLowerCase()] = transform(value);\n    });\n    this._apply(style);\n  }\n  value() {\n    // 正在动画的时候取_cssProperties\n    const cssProperties = this._cssProperties || this.cssProperties;\n    const value: ICSSLikeStyle = {};\n    Object.keys(cssProperties).forEach((k) => {\n      value[k] = cssProperties[k].value;\n    });\n    return value;\n  }\n  apply(cssProperties: ICSSOptionProperties, extendOptions?: IAnimationExtendOptions) {\n    if (!this._cssProperties) {\n      // 初始没有缓存值的情况，取当前值\n      this._cssProperties = this.cssProperties;\n    }\n    // 修正合并\n    const unionCSSProperties = union(this._cssProperties, cssProperties);\n    // 计算出动画需要的增量\n    const deltaCSSProperties = delta(this._cssProperties, unionCSSProperties);\n    // 缓存动画最终值\n    this._cssProperties = unionCSSProperties;\n    // 动画增量的键集合\n    const deltaCSSNames = Object.keys(deltaCSSProperties);\n    // 存储每一帧动画后还有多少剩余没有执行\n    const remainCSSProperties: ICSSProperties = {};\n    // 初始的时候是全部值\n    deltaCSSNames.forEach((name) => {\n      const { value, ...restItem } = deltaCSSProperties[name];\n      remainCSSProperties[name] = {\n        value: { ...value },\n        ...restItem,\n      };\n      // 更新除了value之外的其它值\n      this.cssProperties[name] = {\n        ...this.cssProperties[name],\n        ...restItem,\n      };\n    });\n    // 如果没有传入extendOptions或者没有需要执行动画的增量，则无动画配置（动画会默认duration为0，按进度100%一次执行完毕）\n    const _extendOptions = !extendOptions || deltaCSSNames.length === 0 ? {} : extendOptions;\n    return new Promise<ICSSLikeStyle>((resolve) => {\n      const { before = () => {}, after = () => {}, cancel = true, ...restOptions } = _extendOptions;\n      const animation = new Animation(restOptions);\n      this._animations.push({ animation, cancel, remain: remainCSSProperties });\n      // 开启动画\n      animation.start((progress) => {\n        const next = before(progress, this.value());\n        if (next !== false) {\n          let _progress = progress;\n          if (typeof next === 'number') {\n            _progress = next;\n          }\n          deltaCSSNames.forEach((name) => {\n            const thisCSSValue = this.cssProperties[name].value;\n            const deltaCSSValue = deltaCSSProperties[name].value;\n            const remainCSSValue = remainCSSProperties[name].value;\n            Object.keys(deltaCSSValue).forEach((key) => {\n              // 总的需要消费数减去已经消费的部分，即为这一帧之后未消费的部分，_progress为已消费的进度\n              const remainValue = deltaCSSValue[key] * (1 - _progress);\n              // 上一帧未消费的部分减去这一帧之后未消费的部分，即为本次需要消费的部分\n              thisCSSValue[key] += remainCSSValue[key] - remainValue;\n              // 更新最新剩余未消费的\n              remainCSSValue[key] = remainValue;\n            });\n          });\n          this.update();\n        }\n        after(progress, this.value());\n        if (progress === 1) {\n          // 动画结束后删除集合中的这个动画对象\n          const index = this._animations.findIndex((a) => animation === a.animation);\n          // 一般情况不出出现-1，这里强判断（防止动画出现了两次progress为1的情况）\n          if (index !== -1) {\n            this._animations.splice(index, 1);\n          }\n          this.update();\n          resolve(this.value());\n        }\n      });\n    });\n  }\n  cancel(end: boolean = false) {\n    // end是告诉动画取消时是停留在当前还是执行到终点\n    let count = 0;\n    this._animations = this._animations.filter(({ animation, remain, cancel }) => {\n      if (cancel) {\n        animation[end ? 'end' : 'stop']();\n        count += 1;\n        // 动画停止后，_cssProperties里面必须把停止的动画未完成的部分减掉\n        const _cssProperties = this._cssProperties;\n        if (_cssProperties) {\n          Object.keys(remain).forEach((name) => {\n            if (_cssProperties[name]) {\n              const remainCSSValue = remain[name].value;\n              const tempCSSValue = _cssProperties[name].value;\n              Object.keys(remainCSSValue).forEach((key) => {\n                tempCSSValue[key] -= remainCSSValue[key];\n              });\n            }\n          });\n        }\n        return false;\n      }\n      return true;\n    });\n    this.update();\n    return count;\n  }\n  running() {\n    return this._animations.length !== 0;\n  }\n}\n\nexport type ICSSName = string;\n\nexport type ICSSValue = {\n  [key: string]: number;\n};\n\nexport type ICSSStyle = {\n  [key: ICSSName]: string;\n};\n\nexport type ICSSLikeStyle = {\n  [key: ICSSName]: ICSSValue;\n};\n\nexport type ICSSProperties = {\n  [key: ICSSName]: {\n    value: ICSSValue; // 传入css属性值，对象或值的形式\n    precision: ICSSValue; // 传入精度，与value对应\n    transform: (v: ICSSValue) => string; // 传入实现该value转变为style的字符串方法\n  };\n};\n\nexport type IAnimationExtendOptions = IAnimationOptions & {\n  cancel?: boolean; // 该过渡过程是否可以取消\n  // 过渡时每一帧执行之前（只针对过渡动画，对于精度值小于precision的变化，由于不会开启Animation，所以不会调用该函数）\n  // 返回false，则该帧不执行即丢帧，返回其它则按照原来的继续向下执行（若返回是数字，则会达到篡改progress目的）\n  before?: (p: number, v?: ICSSLikeStyle) => void | boolean | number;\n  // 过渡时每一帧执行之后（只针对过渡动画，对于精度值小于precision的变化，由于不会开启Animation，所以不会调用该函数）\n  after?: (p: number, v?: ICSSLikeStyle) => void;\n};\n\nexport type ICSSOptionProperties =\n  | ICSSOptionValue\n  | {\n      [key: ICSSName]: ICSSOptionValue;\n    };\n\nexport type ITransitionOptions = {\n  cssProperties?: ICSSOptionProperties; // 过渡的css属性信息\n  apply?: (style: ICSSStyle) => void;\n};\n\nexport default Transition;\n","/*\n * @Author: Huangjs\n * @Date: 2023-02-13 15:22:58\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-04 14:42:32\n * @Description: ******\n */\n\nimport Value from './value';\nimport { type ICSSValue, type ICSSProperties, type ICSSOptionProperties } from '.';\n\nexport function delta(\n  startCSSProperties: ICSSProperties,\n  endCSSProperties: ICSSProperties,\n): ICSSProperties {\n  const finalCSSProperties: ICSSProperties = {};\n  Object.keys(startCSSProperties).forEach((name) => {\n    const startCSSValue = startCSSProperties[name].value;\n    const { value: endCSSValue, precision, ...restItem } = endCSSProperties[name];\n    let deltaCSSValue: ICSSValue | null = null;\n    Object.keys(startCSSValue).forEach((key) => {\n      const deltaValue = endCSSValue[key] - startCSSValue[key];\n      if (Math.abs(deltaValue) > (precision[key] || 0)) {\n        if (!deltaCSSValue) {\n          deltaCSSValue = {};\n        }\n        deltaCSSValue[key] = deltaValue;\n      }\n    });\n    if (deltaCSSValue) {\n      finalCSSProperties[name] = { value: deltaCSSValue, precision, ...restItem };\n    }\n  });\n  return finalCSSProperties;\n}\nexport function union(\n  oldCSSProperties: ICSSProperties,\n  newCSSProperties: ICSSOptionProperties,\n): ICSSProperties {\n  const finalCSSProperties: ICSSProperties = {\n    ...oldCSSProperties,\n  };\n  if (newCSSProperties instanceof Value) {\n    const oldCSSName = Object.keys(oldCSSProperties)[0];\n    if (oldCSSName) {\n      const oldCSSValue = oldCSSProperties[oldCSSName];\n      const newCSSValue = newCSSProperties.toRaw();\n      finalCSSProperties[oldCSSName] = {\n        ...oldCSSValue,\n        ...newCSSValue,\n        value: {\n          ...oldCSSValue.value,\n          ...newCSSValue.value,\n        },\n      };\n    }\n  } else {\n    Object.keys(newCSSProperties).forEach((name) => {\n      const oldCSSValue = oldCSSProperties[name];\n      const newCSSValue = newCSSProperties[name].toRaw();\n      if (oldCSSValue) {\n        finalCSSProperties[name] = {\n          ...oldCSSValue,\n          ...newCSSValue,\n          value: {\n            ...oldCSSValue.value,\n            ...newCSSValue.value,\n          },\n        };\n      } else {\n        finalCSSProperties[name] = {\n          transform: (v) =>\n            Object.keys(v)\n              .map((k) => v[k])\n              .join(' '),\n          precision: {},\n          ...newCSSValue,\n        };\n      }\n    });\n  }\n  return finalCSSProperties;\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-23 09:36:07\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-28 10:06:48\n * @Description: ******\n */\n\nimport { type IElement, setStyle, getElement } from '../../lightdom';\nimport Core, { type ITransitionOptions } from '../core';\n\nclass Transition extends Core {\n  constructor(element: IElement, options?: ITransitionOptions) {\n    super({\n      apply: (style) => setStyle(getElement(element), style),\n      ...(options || {}),\n    });\n  }\n}\n\nexport default Transition;\n","/*\n * @Author: Huangjs\n * @Date: 2023-02-13 15:22:58\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-08-23 16:55:13\n * @Description: ******\n */\n\n// 对于函数 s = f(t)\n// 函数平移(x,y)（函数自变量t变为t-x，整体结果f(t)+y）\n// 函数缩放 k 倍（函数自变量t变为t/k，整体结果f(t)*k）\n// 先平移再缩放：s = (f((t/k)-x)+y)*k\n// 先缩放再平移：s = (f((t-x)/k)*k)+y\n\nexport type EaseFn = (t: number) => number;\n\nconst baseEase: { [key in string]: EaseFn } = {\n  linear: (t) => t,\n  inQuad: (t) => t * t,\n  outQuad: (t) => 1 - (1 - t) * (1 - t),\n  inCubic: (t) => t * t * t,\n  outCubic: (t) => 1 - (1 - t) * (1 - t) * (1 - t),\n  inQuart: (t) => t * t * t * t,\n  outQuart: (t) => 1 - (1 - t) * (1 - t) * (1 - t) * (1 - t),\n  inQuint: (t) => t * t * t * t * t,\n  outQuint: (t) => 1 - (1 - t) * (1 - t) * (1 - t) * (1 - t) * (1 - t),\n};\n// 取值easeFn函数变量的某一段转成easing函数，a为开始变量值，b为结束变量值\nexport function createEase(a: number = 0, b: number = 1, easeFn: EaseFn = baseEase.linear): EaseFn {\n  const k = 1 / (b - a);\n  if (!k || k <= 0) {\n    return () => 0;\n  }\n  // easeFn先平移( -a , -easeFn(a) )，再缩放 k 倍\n  // 接着使函数值也在(0,1)之间，即：经上述变换之后的函数，另变量为1，求函数值，函数再除以该函数值得到最终的函数\n  return (t: number) =>\n    ((easeFn(t / k + a) - easeFn(a)) * k) / ((easeFn(1 / k + a) - easeFn(a)) * k);\n}\n// 把两个easing函数连接转成新的easing函数，k为比例\nexport function createEaseInOut(\n  k: number = 1 / 2,\n  easeIn: EaseFn = baseEase.linear,\n  easeOut: EaseFn = baseEase.linear,\n): EaseFn {\n  if (k <= 0) {\n    return easeOut;\n  }\n  if (k >= 1) {\n    return easeIn;\n  }\n  return (t: number) =>\n    t <= k\n      ? // easeIn直接缩放k\n        easeIn(t / k) * k\n      : // easeOut衔接easeIn，需要先平移( k/(1-k) , k/(1-k) )，再缩放 1-k\n        (easeOut(t / (1 - k) - k / (1 - k)) + k / (1 - k)) * (1 - k);\n}\nconst easeInOutQuad = createEaseInOut(1 / 2, baseEase.outQuad, baseEase.inQuad);\nconst easeOutInQuad = createEaseInOut(1 / 2, baseEase.inQuad, baseEase.outQuad);\nconst easeOutQuad = baseEase.outQuad;\nconst easeOutQuart = baseEase.outQuart;\n\nexport { easeInOutQuad, easeOutInQuad, easeOutQuad, easeOutQuart };\n","/*\n * @Author: Huangjs\n * @Date: 2023-02-13 15:22:58\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-13 15:26:18\n * @Description: ******\n */\n\nimport { easeOutQuart, type IAnimationExtendOptions } from '../modules/transition';\n\nexport const defaultAnimationExtendOptions: IAnimationExtendOptions = {\n  cancel: true,\n  duration: 500,\n  easing: easeOutQuart,\n};\n","/*\n * @Author: Huangjs\n * @Date: 2023-02-13 15:22:58\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-26 10:39:10\n * @Description: ******\n */\n\nimport Transition, {\n  Value,\n  type ITransitionOptions,\n  type IAnimationExtendOptions,\n} from '../modules/transition';\nimport { type IElement } from '../modules/lightdom';\nimport { defaultAnimationExtendOptions } from './defaultAnimationExtendOptions';\n\nexport type IBBox = {\n  left?: number;\n  top?: number;\n  width?: number;\n  height?: number;\n};\n\nexport type ICallback = {\n  [key: string]: Function;\n};\n\nexport type IOpenStyle = {\n  o?: number;\n  k?: number;\n  x?: number;\n  y?: number;\n  w?: number;\n  h?: number;\n  t?: number;\n};\n\nclass SwiperModel<T extends Object | null> extends Transition {\n  _direction: IDirection = 'horizontal';\n  _itemModels: T[] = [];\n  _itemSize: number = 0;\n  _activeIndex: number = -1;\n  _enableSwipeClose: boolean = true;\n  _fgBehavior: number = 0; // 当第一根手指放上去后，接着有三种行为：0: 直接拿开 1: 直接移动 2: 再放一根手指\n  _moveTarget: 'closures' | 'outside' | 'inside' | 'none' = 'none'; // 判断是内部的图片移动，还是外部swiper移动，还是进入swipeClose\n  constructor({\n    direction,\n    itemModels,\n    itemSize,\n    enableSwipeClose,\n    transitionEl,\n    ...transitionOption\n  }: SwiperOption<T> = {}) {\n    super(transitionEl || null, transitionOption);\n    this.apply({\n      transform: new Value(0, 1, (v) => `translateX(${v.default}px)`),\n    });\n    this.swipeClose(enableSwipeClose);\n    this.direction(direction);\n    this.itemSize(itemSize);\n    this.itemModels(itemModels);\n  }\n  activeIndex() {\n    return this._activeIndex;\n  }\n  isHorizontal() {\n    return this._direction === 'horizontal';\n  }\n  isVertical() {\n    return this._direction === 'vertical';\n  }\n  swipeClose(enableSwipeClose?: boolean) {\n    if (typeof enableSwipeClose !== 'undefined') {\n      this._enableSwipeClose = enableSwipeClose;\n    }\n    return this._enableSwipeClose;\n  }\n  direction(direction?: IDirection) {\n    if (direction) {\n      this._direction = direction;\n      const xy = direction === 'vertical' ? 'Y' : 'X';\n      // 方向改变了要重置transform函数\n      this.apply(new Value(0, 1, (v) => `translate${xy}(${v.default}px)`));\n    }\n    return this._direction;\n  }\n  itemSize(itemSize?: number) {\n    if (typeof itemSize !== 'undefined') {\n      this._itemSize = itemSize;\n      // 单位尺寸变了，需要调整一下位移\n      this.apply(new Value(-this.activeIndex() * itemSize));\n    }\n    return this._itemSize;\n  }\n  itemModels(itemModels?: number | T | T[], index?: number) {\n    if (typeof itemModels === 'undefined') {\n      return this._itemModels;\n    } else if (typeof itemModels === 'number') {\n      return this._itemModels[itemModels];\n    } else if (Array.isArray(itemModels)) {\n      this._itemModels = itemModels;\n      return itemModels;\n    } else {\n      this._itemModels[index || 0] = itemModels;\n      return itemModels;\n    }\n  }\n  currentItem(): T | null {\n    return this.itemModels(this.activeIndex()) as T;\n  }\n  countItems() {\n    return (this.itemModels() as T[]).length;\n  }\n  slide(index: number, options: IAnimationExtendOptions = {}) {\n    const { before, after, ...restOptions } = options;\n    const activeIndex = Math.max(Math.min(index, this.countItems() - 1), 0);\n    const isChanged = this.activeIndex() !== activeIndex;\n    if (isChanged) {\n      this._activeIndex = activeIndex;\n      before?.(activeIndex);\n    }\n    const translate = -activeIndex * this.itemSize();\n    return this.apply(new Value(translate), {\n      ...defaultAnimationExtendOptions,\n      ...restOptions,\n    }).then(() => {\n      if (isChanged) {\n        after?.(activeIndex);\n      }\n      return activeIndex;\n    });\n  }\n  next(options?: IAnimationExtendOptions) {\n    return this.slide(this._activeIndex + 1, options);\n  }\n  prev(options?: IAnimationExtendOptions) {\n    return this.slide(this._activeIndex - 1, options);\n  }\n}\n\nexport type IDirection = 'vertical' | 'horizontal';\n\nexport type SwiperOption<T> = {\n  direction?: IDirection;\n  enableSwipeClose?: boolean;\n  itemModels?: T | T[];\n  itemSize?: number;\n} & ITransitionOptions & { transitionEl?: IElement };\n\nexport default SwiperModel;\n","/*\n * @Author: Huangjs\n * @Date: 2023-02-13 15:22:58\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-06-14 16:40:44\n * @Description: ******\n */\n\nconst DEG_TO_RAD = Math.PI / 180;\n\nconst Matrix = {\n  // 将矩阵 lhm 与矩阵 rhm 相乘，然后保存到矩阵 rm 中\n  multiply: function multiply(rm: Float32Array, lhm: Float32Array, rhm: Float32Array) {\n    const a11 = lhm[0];\n    const a12 = lhm[4];\n    const a13 = lhm[8];\n    const a14 = lhm[12];\n    const a21 = lhm[1];\n    const a22 = lhm[5];\n    const a23 = lhm[9];\n    const a24 = lhm[13];\n    const a31 = lhm[2];\n    const a32 = lhm[6];\n    const a33 = lhm[10];\n    const a34 = lhm[14];\n    const a41 = lhm[3];\n    const a42 = lhm[7];\n    const a43 = lhm[11];\n    const a44 = lhm[15];\n    const b11 = rhm[0];\n    const b12 = rhm[1];\n    const b13 = rhm[2];\n    const b14 = rhm[3];\n    const b21 = rhm[4];\n    const b22 = rhm[5];\n    const b23 = rhm[6];\n    const b24 = rhm[7];\n    const b31 = rhm[8];\n    const b32 = rhm[9];\n    const b33 = rhm[10];\n    const b34 = rhm[11];\n    const b41 = rhm[12];\n    const b42 = rhm[13];\n    const b43 = rhm[14];\n    const b44 = rhm[15];\n    rm[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\n    rm[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\n    rm[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\n    rm[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\n    rm[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\n    rm[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\n    rm[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\n    rm[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\n    rm[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\n    rm[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\n    rm[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\n    rm[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\n    rm[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\n    rm[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\n    rm[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\n    rm[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\n  },\n  // 将矩阵 m 设置为初始矩阵\n  identity: function identity(m: Float32Array) {\n    for (let i = 0; i < 16; i++) {\n      m[i] = 0;\n    }\n    for (let i = 0; i < 16; i += 5) {\n      m[i] = 1;\n    }\n  },\n  // 将矩阵 m 按照 x, y, z 平移\n  translate: function translate(m: Float32Array, x: number, y: number, z: number) {\n    for (let i = 0; i < 4; i++) {\n      m[12 + i] += m[i] * x + m[4 + i] * y + m[8 + i] * z;\n    }\n  },\n  // 将矩阵 m 按照 x, y, z 缩放\n  scale: function scale(m: Float32Array, x: number, y: number, z: number) {\n    for (let i = 0; i < 4; i++) {\n      m[i] *= x;\n      m[4 + i] *= y;\n      m[8 + i] *= z;\n    }\n  },\n  // 将矩阵 m 围绕 x, y, z 旋转a度\n  rotate: function rotate(m: Float32Array, a: number, x: number, y: number, z: number) {\n    const rm = new Float32Array(16);\n    rm[3] = 0;\n    rm[7] = 0;\n    rm[11] = 0;\n    rm[12] = 0;\n    rm[13] = 0;\n    rm[14] = 0;\n    rm[15] = 1;\n    const ra = a * DEG_TO_RAD;\n    const s = Math.sin(ra);\n    const c = Math.cos(ra);\n    if (x === 1 && y === 0 && z === 0) {\n      // x轴\n      rm[5] = c;\n      rm[10] = c;\n      rm[6] = s;\n      rm[9] = -s;\n      rm[1] = 0;\n      rm[2] = 0;\n      rm[4] = 0;\n      rm[8] = 0;\n      rm[0] = 1;\n    } else if (x === 0 && y === 0 && z === 0) {\n      // y轴\n      rm[0] = c;\n      rm[10] = c;\n      rm[8] = s;\n      rm[2] = -s;\n      rm[1] = 0;\n      rm[4] = 0;\n      rm[6] = 0;\n      rm[9] = 0;\n      rm[5] = 1;\n    } else if (x === 0 && y === 0 && z === 1) {\n      // z轴\n      rm[0] = c;\n      rm[5] = c;\n      rm[1] = s;\n      rm[4] = -s;\n      rm[2] = 0;\n      rm[6] = 0;\n      rm[8] = 0;\n      rm[9] = 0;\n      rm[10] = 1;\n    } else {\n      const len = Math.sqrt(x * x + y * y + z * z);\n      if (len !== 1) {\n        const recipLen = 1 / len;\n        x *= recipLen;\n        y *= recipLen;\n        z *= recipLen;\n      }\n      const nc = 1 - c;\n      const xy = x * y;\n      const yz = y * z;\n      const zx = z * x;\n      const xs = x * s;\n      const ys = y * s;\n      const zs = z * s;\n      rm[0] = x * x * nc + c;\n      rm[4] = xy * nc - zs;\n      rm[8] = zx * nc + ys;\n      rm[1] = xy * nc + zs;\n      rm[5] = y * y * nc + c;\n      rm[9] = yz * nc - xs;\n      rm[2] = zx * nc - ys;\n      rm[6] = yz * nc + xs;\n      rm[10] = z * z * nc + c;\n    }\n    Matrix.multiply(m, m, rm);\n  },\n  // 将矩阵 m 按照欧拉角 xa, ya, za 旋转\n  rotateEuler: function rotateEuler(m: Float32Array, xa: number, ya: number, za: number) {\n    const rm = new Float32Array(16);\n    const xra = xa * DEG_TO_RAD;\n    const yra = ya * DEG_TO_RAD;\n    const zra = za * DEG_TO_RAD;\n    const cx = Math.cos(xra);\n    const sx = Math.sin(xra);\n    const cy = Math.cos(yra);\n    const sy = Math.sin(yra);\n    const cz = Math.cos(zra);\n    const sz = Math.sin(zra);\n    const cxsy = cx * sy;\n    const sxsy = sx * sy;\n    rm[0] = cy * cz;\n    rm[1] = -cy * sz;\n    rm[2] = sy;\n    rm[3] = 0;\n    rm[4] = cxsy * cz + cx * sz;\n    rm[5] = -cxsy * sz + cx * cz;\n    rm[6] = -sx * cy;\n    rm[7] = 0;\n    rm[8] = -sxsy * cz + sx * sz;\n    rm[9] = sxsy * sz + sx * cz;\n    rm[10] = cx * cy;\n    rm[11] = 0;\n    rm[12] = 0;\n    rm[13] = 0;\n    rm[14] = 0;\n    rm[15] = 1;\n    Matrix.multiply(m, m, rm);\n  },\n  // 将矩阵 m 进行perspective变换\n  perspective: function perspective(\n    m: Float32Array,\n    fovy: number,\n    aspect: number,\n    zNear: number,\n    zFar: number,\n  ) {\n    const f = 1 / Math.tan(fovy * (Math.PI / 360.0));\n    const rangeReciprocal = 1 / (zNear - zFar);\n    m[0] = f / aspect;\n    m[1] = 0;\n    m[2] = 0;\n    m[3] = 0;\n    m[4] = 0;\n    m[5] = f;\n    m[6] = 0;\n    m[7] = 0;\n    m[8] = 0;\n    m[9] = 0;\n    m[10] = (zFar + zNear) * rangeReciprocal;\n    m[11] = -1;\n    m[12] = 0;\n    m[13] = 0;\n    m[14] = 2 * zFar * zNear * rangeReciprocal;\n    m[15] = 0;\n  },\n};\n\nexport default Matrix;\n","/*\n * @Author: Huangjs\n * @Date: 2023-04-27 18:24:36\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-12 16:44:49\n * @Description: ******\n */\n\nimport Matrix from './matrix';\n\ntype Raw = {\n  a?: number;\n  k?: number;\n  x?: number;\n  y?: number;\n};\n\nexport default class Transform {\n  a?: number;\n  k?: number;\n  x?: number;\n  y?: number;\n\n  constructor(t: Raw = {}) {\n    if (typeof t.a === 'number') {\n      this.a = t.a;\n    }\n    if (typeof t.k === 'number') {\n      this.k = t.k;\n    }\n    if (typeof t.x === 'number') {\n      this.x = t.x;\n    }\n    if (typeof t.y === 'number') {\n      this.y = t.y;\n    }\n  }\n  static identity() {\n    return new Transform({ a: 0, k: 1, x: 0, y: 0 });\n  }\n  toRaw() {\n    const raw: Raw = {};\n    if (typeof this.a === 'number') {\n      raw.a = this.a;\n    }\n    if (typeof this.k === 'number') {\n      raw.k = this.k;\n    }\n    if (typeof this.x === 'number') {\n      raw.x = this.x;\n    }\n    if (typeof this.y === 'number') {\n      raw.y = this.y;\n    }\n    return raw;\n  }\n  toString() {\n    const { a = 0, k = 1, x = 0, y = 0 } = this;\n    const matrix = new Float32Array(16);\n    Matrix.identity(matrix);\n    Matrix.translate(matrix, x, y, 0);\n    Matrix.scale(matrix, k, k, k);\n    // 这里使用负值，实际matrix3d里负值为顺时针\n    Matrix.rotate(matrix, -a, 0, 0, 1);\n    return `matrix3d(${Array.prototype.slice.call(matrix).join(',')})`;\n  }\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-02-13 15:22:58\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-07-27 14:59:57\n * @Description: ******\n */\n\nfunction damping(value: number, max: number, expo: number, revoke: boolean = false) {\n  if (\n    value < 1 ||\n    max < 1 ||\n    // 反算的时候value必须小于max\n    (revoke && value > max) ||\n    expo <= 0 ||\n    expo > 1\n  ) {\n    return value;\n  }\n  if (revoke) {\n    return Math.pow(((max - 1) * value) / (max - value), 1 / expo);\n  }\n  return max / (1 + (max - 1) / Math.pow(value, expo));\n}\n\ntype DampingOption = {\n  max?: number;\n  mode?: number;\n  expo?: number;\n};\n// 阻尼值\nexport function performDamping(value: number, option: DampingOption = {}) {\n  if (value === 0) {\n    return 0;\n  }\n  const { max = 9999, mode = 0, expo = 0.88 } = option;\n  let _value = Math.abs(value);\n  if (_value < 1) {\n    if (mode === 1) {\n      // 倒数模式\n      _value = 1 / damping(1 / _value, max, expo);\n    } else {\n      // 加1模式\n      _value = damping(_value + 1, max, expo) - 1;\n    }\n  } else {\n    _value = damping(_value, max, expo);\n  }\n  return _value * (value > 0 ? 1 : -1);\n}\n// 阻尼原值\nexport function revokeDamping(value: number, option: DampingOption = {}) {\n  if (value === 0) {\n    return 0;\n  }\n  const { max = 9999, mode = 0, expo = 0.88 } = option;\n  let _value = Math.abs(value);\n  if (_value < 1) {\n    if (mode === 1) {\n      // 倒数模式\n      _value = 1 / damping(1 / _value, max, expo, true);\n    } else {\n      // 加1模式\n      _value = damping(_value + 1, max, expo, true) - 1;\n    }\n  } else {\n    _value = damping(_value, max, expo, true);\n  }\n  return _value * (value > 0 ? 1 : -1);\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-06-26 09:46:00\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-25 11:55:27\n * @Description: ******\n */\n\n// 解决0.1+0.2不等于0.3的问题\nexport function fixDecimal(value: number, places: number = 15) {\n  const multiple = Math.pow(10, places);\n  return Math.round(value * multiple) / multiple;\n}\n// 算出双击时offset的比例\nexport function ratioOffset(v: number, k: number, t: number) {\n  if (v <= (1 - k) / (2 * k)) {\n    return -1 / 2;\n  } else if (v >= (1 + k - 2 * t) / (2 * k)) {\n    return 1 / 2;\n  } else {\n    return (v - (1 - t) / (2 * k)) / (1 - t / k);\n  }\n}\n// 传入的a是函数，就返回函数执行结果，否则直接返回a\nexport function effectuate(fn: any, ...args: any) {\n  return typeof fn === 'function' ? fn(...args) : fn;\n}\n// 判断v是否在min和max之间\nexport function isBetween(v: number, [min, max]: number[]) {\n  return min <= v && v <= max;\n}\n// 若v在min和max之间，则返回v值，否则，返回边缘值min或max\nexport function between(v: number, [min, max]: number[], _?: boolean) {\n  return Math.max(Math.min(v, max), min);\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-02-13 15:22:58\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-26 10:37:28\n * @Description: ******\n */\n\nimport Transition, {\n  Value,\n  easeOutQuad,\n  type ITransitionOptions,\n  type IAnimationExtendOptions,\n} from '../modules/transition';\nimport Transform from '../modules/transform';\nimport { revokeDamping, performDamping } from '../modules/damping';\nimport { type IElement } from '../modules/lightdom';\nimport { defaultAnimationExtendOptions } from './defaultAnimationExtendOptions';\nimport { between, isBetween, effectuate, ratioOffset } from '../utils';\n\nclass ItemModel extends Transition {\n  _dblAdjust: boolean = true;\n  _dblScale: number | (() => number) = 0; // 双击放大比例和是否调整放大时的中心点\n  _damping: IDamping[] = []; // 可以进行阻尼的变换\n  _rotation: number[] | (() => number[]) = []; // 旋转范围\n  _scalation: number[] | (() => number[]) = []; // 缩放范围\n  _translation: (number[] | ((v: number) => number[]))[] = []; // 平移范围\n  _sizePosition: ISizePosition & {\n    elementWidth: number;\n    elementHeight: number;\n  } = {\n    containerCenter: [0, 0],\n    containerWidth: 0,\n    containerHeight: 0,\n    naturalWidth: 0,\n    naturalHeight: 0,\n    elementWidth: 0,\n    elementHeight: 0,\n  };\n  constructor({\n    sizePosition,\n    dblAdjust,\n    dblScale,\n    damping,\n    rotation,\n    scalation,\n    translation,\n    transitionEl,\n    ...transitionOption\n  }: IItemModelOption = {}) {\n    super(transitionEl || null, transitionOption);\n    this.apply({\n      transform: new Value({ a: 0, k: 1, x: 0, y: 0 }, { a: 0.001, k: 0.001, x: 1, y: 1 }, (v) =>\n        new Transform(v).toString(),\n      ),\n    });\n    this.sizePosition(sizePosition);\n    this.setDblAdjust(dblAdjust); // 设置双击是否调整中心点\n    this.setDamping(damping); // 设置[]，则全都不阻尼\n    this.setDblScale(dblScale); // 设置1，则不进行双击缩放，但可双击归位\n    this.setRotation(rotation); // 设置相同数字（比如0），则不允许旋转，该数字为初始旋转\n    this.setScalation(scalation); // 设置相同数字（比如1），则不允许缩放，该数为初始缩放\n    this.setTranslation(translation); // 设置相同数字（比如0），则不允许平移，该数为初始位置\n  }\n  reset(duration: number = 0) {\n    const a = between(0, this.getRotation()); // 初始角度a\n    const k = between(1, this.getScalation()); // 初始比例k\n    const x = between(0, this.getXTranslation(k)); // 初始位移x\n    const y = between(0, this.getYTranslation(k)); //初始位移y\n    this.apply(new Value({ a, k, x, y }), { ...defaultAnimationExtendOptions, duration });\n  }\n  sizePosition(sizePosition?: ISizePosition) {\n    if (sizePosition) {\n      const { containerCenter, containerWidth, containerHeight, naturalWidth, naturalHeight } =\n        sizePosition;\n      const aspectRatio = naturalWidth / naturalHeight;\n      const boxAspectRatio = containerWidth / containerHeight;\n      let width = naturalWidth;\n      if (aspectRatio >= boxAspectRatio) {\n        width = containerWidth;\n      } else if (aspectRatio >= 1 / 2.2) {\n        // 0.4545454545...\n        //微信 iphone 横竖屏和微信 android 竖屏时\n        width = containerHeight * aspectRatio;\n      } /* else if (aspectRatio >= 0.4) {\n        // 微信 android 横屏时\n        width = containerHeight * aspectRatio;\n      } */ else {\n        // 微信 iphone 是取 containerWidth 和 naturalWidth 最小值\n        width = Math.min(containerWidth, naturalWidth);\n        // 微信 android 直接是取 containerWidth;\n        // width = containerWidth;\n      }\n      const height = width / aspectRatio;\n      this._sizePosition = {\n        containerCenter,\n        containerWidth,\n        containerHeight,\n        naturalWidth,\n        naturalHeight,\n        elementWidth: width || 0,\n        elementHeight: height || 0,\n      };\n      this.reset();\n    }\n    return this._sizePosition;\n  }\n  setRotation(a?: number[]) {\n    if (a && typeof a[0] === 'number' && typeof a[1] === 'number' && a[1] >= a[0]) {\n      // 最大范围 -Infinity 到 + Infinity\n      this._rotation = a;\n      return;\n    }\n    // 测微信得到的结论，是不给旋转的\n    // 如果设置不合理，则取默认\n    this._rotation = () => [0, 0];\n  }\n  getRotation() {\n    return effectuate(this._rotation);\n  }\n  setScalation(k?: number[]) {\n    if (k && typeof k[0] === 'number' && typeof k[1] === 'number' && k[1] >= k[0] && k[0] > 0) {\n      this._scalation = k; // 最大范围 0 到 +Infinity (不等于0)\n      return;\n    }\n    // 测微信得到的结论，最小值为1，最大值永远是双击值放大值的2倍\n    // 如果设置不合理，则取默认\n    this._scalation = () => [1, 2 * this.getDblScale()];\n  }\n  getScalation() {\n    return effectuate(this._scalation);\n  }\n  setTranslation(xy?: number[][]) {\n    this.setXTranslation(xy && xy[0]);\n    this.setYTranslation(xy && xy[1]);\n  }\n  getTranslation(k?: number) {\n    return [this.getXTranslation(k), this.getYTranslation()];\n  }\n  setXTranslation(x?: number[]) {\n    if (x && typeof x[0] === 'number' && typeof x[1] === 'number' && x[1] >= x[0]) {\n      this._translation[0] = x; // 最大范围 -Infinity 到 + Infinity\n      return;\n    }\n    // 测微信得到的结论，边界范围是元素按照当前比例缩放后宽度和容器宽度之差，左右各一半的范围\n    this._translation[0] = (k: number) => {\n      const { containerWidth, elementWidth } = this.sizePosition();\n      const bx = Math.max((elementWidth * k - containerWidth) / 2, 0);\n      return [-bx, bx];\n    };\n  }\n  getXTranslation(k?: number) {\n    return effectuate(this._translation[0], k || this.value().transform.k || 1);\n  }\n  setYTranslation(y?: number[]) {\n    if (y && typeof y[0] === 'number' && typeof y[1] === 'number' && y[1] >= y[0]) {\n      this._translation[1] = y; // 最大范围 -Infinity 到 +Infinity\n      return;\n    }\n    // 测微信得到的结论，边界范围是元素按照当前比例缩放后高度和容器高度之差，上下各一半的范围\n    this._translation[1] = (k: number) => {\n      const { containerHeight, elementHeight } = this.sizePosition();\n      const by = Math.max((elementHeight * k - containerHeight) / 2, 0);\n      return [-by, by];\n    };\n  }\n  getYTranslation(k?: number) {\n    return effectuate(this._translation[1], k || this.value().transform.k || 1);\n  }\n  setDblScale(k?: number) {\n    if (typeof k === 'number' && k > 0) {\n      this._dblScale = k;\n      return;\n    }\n    // 测微信得到的结论，双击放大比例是\n    // 1，容器宽/元素宽 和 容器高/元素高 的最大值\n    // 2，元素实际宽/容器宽 和 元素实际高/容器高 的最小值\n    // 3，在1、2两个值和数值2这三个之中的最大值\n    this._dblScale = () => {\n      const {\n        containerWidth,\n        containerHeight,\n        naturalWidth,\n        naturalHeight,\n        elementWidth,\n        elementHeight,\n      } = this.sizePosition();\n      return (\n        Math.max(\n          2,\n          Math.max(containerWidth / elementWidth, containerHeight / elementHeight),\n          Math.min(naturalWidth / containerWidth, naturalHeight / containerHeight),\n        ) || 1\n      );\n    };\n  }\n  getDblScale() {\n    return effectuate(this._dblScale);\n  }\n  setDblAdjust(aj: boolean = true) {\n    this._dblAdjust = aj;\n  }\n  getDblAdjust() {\n    return this._dblAdjust;\n  }\n  isDamping(key: IDamping) {\n    return this._damping?.indexOf(key) !== -1;\n  }\n  setDamping(damping?: IDamping[]) {\n    if (damping) {\n      this._damping = damping;\n      return;\n    }\n    // 如果不设置，默认只对缩放比例和位移进行阻尼\n    this._damping = ['scale', 'translate'];\n  }\n  rotate(a: number) {\n    // 负数顺时针，正数逆时针\n    // 在原来的基础上再旋转 a\n    return this.transform(new Transform({ a }));\n  }\n  rotateTo(a: number) {\n    // 负数顺时针，正数逆时针\n    // 直接旋转到 a\n    return this.transformTo(new Transform({ a }));\n  }\n  scale(k: number, point?: number[]) {\n    // 在原来的基础上相对 point 点缩放 k\n    return this.transform(new Transform({ k }), point);\n  }\n  scaleTo(k: number, point?: number[]) {\n    // 直接相对 point 点缩放到 k\n    return this.transformTo(new Transform({ k }), point);\n  }\n  translate(x: number, y: number) {\n    // 在原来的基础上平移 x, y\n    return this.transform(new Transform({ x, y }));\n  }\n  translateTo(x: number, y: number) {\n    // 直接平移到 x, y\n    return this.transformTo(new Transform({ x, y }));\n  }\n  translateX(x: number) {\n    // 在原来的基础上横向平移 x\n    return this.transform(new Transform({ x }));\n  }\n  translateXTo(x: number) {\n    // 直接横向平移到 x\n    return this.transformTo(new Transform({ x }));\n  }\n  translateY(y: number) {\n    // 在原来的基础上竖向平移  y\n    return this.transform(new Transform({ y }));\n  }\n  translateYTo(y: number) {\n    // 直接竖向平移到 y\n    return this.transformTo(new Transform({ y }));\n  }\n  transform(\n    transform: Transform,\n    point?: number[] | IAnimationExtendOptions,\n    options?: IAnimationExtendOptions,\n  ) {\n    const t = this.value().transform;\n    let { a, k, x, y } = transform;\n    if (typeof a === 'number') {\n      a += t.a || 0;\n    }\n    if (typeof k === 'number') {\n      k *= t.k || 1;\n    }\n    if (typeof x === 'number') {\n      x += t.x || 0;\n    }\n    if (typeof y === 'number') {\n      y += t.y || 0;\n    }\n    return this.transformTo(new Transform({ a, k, x, y }), point, options);\n  }\n  transformTo(\n    transform: Transform,\n    point?: number[] | IAnimationExtendOptions,\n    options?: IAnimationExtendOptions,\n  ) {\n    let _point = point;\n    let _options = options;\n    if (!options && !Array.isArray(point)) {\n      _options = point;\n      _point = undefined;\n    }\n    const { a: _a, k: _k, x: _x, y: _y } = transform;\n    const _transform = new Transform();\n    if (typeof _a === 'number') {\n      _transform.a = between(_a, this.getRotation());\n    }\n    if (typeof _k === 'number') {\n      const k = (_transform.k = between(_k, this.getScalation()));\n      if (Array.isArray(_point)) {\n        const [ox, oy] = this.computeOffset(_point, k);\n        const t = this.value().transform;\n        _transform.x = between((typeof _x === 'number' ? _x : t.x) + ox, this.getXTranslation(k));\n        _transform.y = between((typeof _y === 'number' ? _y : t.y) + oy, this.getYTranslation(k));\n      } else {\n        if (typeof _x === 'number') {\n          _transform.x = between(_x, this.getXTranslation(k));\n        }\n        if (typeof _y === 'number') {\n          _transform.y = between(_y, this.getYTranslation(k));\n        }\n      }\n    } else {\n      if (typeof _x === 'number') {\n        _transform.x = between(_x, this.getXTranslation());\n      }\n      if (typeof _y === 'number') {\n        _transform.y = between(_y, this.getYTranslation());\n      }\n    }\n    return this.apply(new Value(_transform.toRaw()), {\n      ...defaultAnimationExtendOptions,\n      ..._options,\n    });\n  }\n  computeOffset(point: number[], k: number, adjust: boolean = false) {\n    const { containerCenter, containerWidth, containerHeight, elementWidth, elementHeight } =\n      this.sizePosition();\n    const t = this.value().transform;\n    const dk = k / t.k;\n    const [cx, cy] = containerCenter;\n    let ox = (typeof point[0] === 'number' ? point[0] : cx) - (cx + t.x);\n    let oy = (typeof point[1] === 'number' ? point[1] : cy) - (cy + t.y);\n    if (adjust) {\n      // 思路：对元素进行划线分界\n      // 1，在元素上边的时候，用元素实际高度一半(eh/2)的基础上在除以双击比例 k 即 eh/2k 作为上分界线，分界线到元素上边缘区域内点击，全部视为在元素上边缘线上点击，即放大后元素上边缘会紧贴在容器上边缘\n      // 2，在元素下边的时候，先用容器的高(ch)比上元素实际高(eh)，即ch/eh（但是这个比例值只能在1和2之间（即只针对元素高小于容器高且大于容器高一半的情况）），用这个比例减去1/2k，得到的结果乘以元素实际高(eh)，再以此作为下分界线，分界线到元素下边缘区域内点击，全部视为在元素下边缘线上点击，即放大后元素下边缘会紧贴在容器下边缘\n      // 3，找出元素在不受偏移量和边界限制的影响下，点击元素中心点放大后，元素上下各存在一条界线正好与容器边缘重合，计算出该界线到中心点的距离，该距离一定是在元素中心点到元素边缘之间即0,ew/2之间，并且两条界线等距\n      // 4，在1，2中算出的上下分界线之间内点击，计算均匀分布对应到在3中算出的上下界线之间内点击，分界线中点处对应元素中点处，最后得到对应的偏移量oy\n      // 5，元素左右计算方式如同上下方式一样得到ox\n      // 测微信得到的结论\n      // 这个偏移量需要要向着边缘点发散\n      const cw = containerWidth / 1;\n      const ch = containerHeight / 1;\n      const ew = elementWidth / t.k;\n      const eh = elementHeight / t.k;\n      ox =\n        between(ew - (cw - ew) / (dk - 1), [0, ew]) *\n          ratioOffset(ox / ew, dk, between(cw / ew, [1, 2])) || 0;\n      oy =\n        between(eh - (ch - eh) / (dk - 1), [0, eh]) *\n          ratioOffset(oy / eh, dk, between(ch / eh, [1, 2])) || 0;\n    }\n    ox *= 1 - dk;\n    oy *= 1 - dk;\n    return [ox, oy];\n  }\n  moveBounce(angle: number, scale: number, deltaX: number, deltaY: number, point: number[] = []) {\n    let { a, k, x, y } = this.value().transform;\n    const aRange = this.getRotation();\n    if (this.isDamping('rotate')) {\n      // 先把当前值反算出阻尼之前的原值\n      let ba = between(a, aRange);\n      a = ba + revokeDamping(a - ba, { max: 180 });\n      // 再对总值进行总体阻尼计算\n      ba = between((a += angle), aRange);\n      a = ba + performDamping(a - ba, { max: 180 });\n    } else {\n      a = between((a += angle), aRange);\n    }\n    const kRange = this.getScalation();\n    if (this.isDamping('scale')) {\n      // 先把当前值反算出阻尼之前的原值\n      let bk = between(k, kRange);\n      k = bk * revokeDamping(k / bk, { max: 2, mode: 1 });\n      // 再对总值进行总体阻尼计算\n      bk = between((k *= scale), kRange);\n      k = bk * performDamping(k / bk, { max: 2, mode: 1 });\n    } else {\n      k = between((k *= scale), kRange);\n    }\n    const [ox, oy] = this.computeOffset(point, k);\n    if (this.isDamping('scale')) {\n      const { containerWidth: xMax, containerHeight: yMax } = this.sizePosition();\n      // 先把当前值反算出阻尼之前的原值\n      let bx = between(x, this.getXTranslation());\n      x = bx + revokeDamping(x - bx, { max: xMax });\n      // 再对总值进行总体阻尼计算\n      bx = between((x += ox + deltaX), this.getXTranslation(k));\n      x = bx + performDamping(x - bx, { max: xMax });\n      // 先把当前值反算出阻尼之前的原值\n      let by = between(y, this.getYTranslation());\n      y = by + revokeDamping(y - by, { max: yMax });\n      // 再对总值进行总体阻尼计算\n      by = between((y += oy + deltaY), this.getYTranslation(k));\n      y = by + performDamping(y - by, { max: yMax });\n    } else {\n      x = between((x += ox + deltaX), this.getXTranslation(k));\n      y = between((y += oy + deltaY), this.getYTranslation(k));\n    }\n    this.apply(new Value({ a, k, x, y }));\n  }\n  resetBounce(point: number[] = [], cancel: boolean = false) {\n    let { a, k, x, y } = this.value().transform;\n    // 若允许阻尼，首先应该先把当前值反算出阻尼之前的原值\n    if (this.isDamping('rotate')) {\n      const ba = between(a, this.getRotation());\n      a = ba + revokeDamping(a - ba, { max: 180 });\n    }\n    if (this.isDamping('scale')) {\n      const bk = between(k, this.getScalation());\n      k = bk * revokeDamping(k / bk, { max: 2, mode: 1 });\n    }\n    if (this.isDamping('translate')) {\n      const { containerWidth: xMax, containerHeight: yMax } = this.sizePosition();\n      const bx = between(x, this.getXTranslation());\n      x = bx + revokeDamping(x - bx, { max: xMax });\n      const by = between(y, this.getYTranslation());\n      y = by + revokeDamping(y - by, { max: yMax });\n    }\n    // 重置之前是双指移动，是不允许取消动画的\n    this.transformTo(new Transform({ a, k, x, y }), point, { cancel });\n  }\n  dblScale(point: number[] = []) {\n    // 这三个比例都是用保留三位小数的结果进行比较\n    // 其实这里的3应该用1/屏幕的宽高算出的小数位数\n    // 此刻比例和位移\n    const tk = this.value().transform.k || 1;\n    // 双击变化的比例\n    const dk = between(this.getDblScale(), this.getScalation());\n    // 再次双击恢复的比例（初始比例）\n    const bk = between(1, this.getScalation());\n    // 双击变化（如果设置的双击比例大于初始比例并且此刻比例小于或等于初始比例\n    // 或者设置的双击比例小于初始比例且此刻比例大于或等于初始比例）\n    if ((dk > bk && tk <= bk) || (dk < bk && tk >= bk)) {\n      if (this.getDblAdjust()) {\n        // 需要调整的情况，自己算偏移量，并且旋转置为0\n        const [ox, oy] = this.computeOffset(point, dk, this.getDblAdjust());\n        const t = this.value().transform;\n        this.transformTo(new Transform({ a: 0, k: dk, x: t.x + ox, y: t.y + oy }), {\n          cancel: false,\n        });\n      } else {\n        // 交给transformTo\n        this.transformTo(new Transform({ k: dk }), point, { cancel: false });\n      }\n    } else {\n      // 再次双击恢复\n      if (this.getDblAdjust()) {\n        // 需要调整的情况，置为初始状态\n        this.transformTo(new Transform({ a: 0, k: bk, x: 0, y: 0 }), { cancel: false });\n      } else {\n        // 交给transformTo\n        this.transformTo(new Transform({ k: bk }), point, { cancel: false });\n      }\n    }\n  }\n  swipeBounce(\n    duration: number,\n    stretch: number,\n    key: 'x' | 'y',\n    transition?: (\n      key: 'x' | 'y',\n      xySwipe: number,\n      xyBounce: number,\n      option: (v: number) => IAnimationExtendOptions,\n    ) => void,\n  ) {\n    const sizeInfo = this.sizePosition();\n    const maxBounce = sizeInfo[key === 'x' ? 'containerWidth' : 'containerHeight'];\n    const xyScale = 1.2 * this.getDblScale();\n    const xyPos = this.value().transform[key] || 0;\n    const xyRange = this.getTranslation()[key === 'x' ? 0 : 1];\n    const sign = stretch > 0 ? 1 : -1;\n    // 对距离进行优化(最大值是当前双击比例下图片宽度)\n    const _stretch = Math.max(1, Math.min(Math.abs(stretch), xyScale * maxBounce)) * sign;\n    // 对时间进行优化\n    const _duration = Math.max(800, Math.min(2500, duration));\n    if (isBetween(xyPos + _stretch, xyRange)) {\n      if (typeof transition === 'function') {\n        // 交给调用者去计算分配如何transition，并使用回调计算transition配置\n        transition(key, _stretch, 0, () => ({\n          duration: _duration,\n          easing: easeOutQuad,\n        }));\n      } else {\n        // 如果加上惯性滑动距离之后图片未超出边界，则图片直接移动\n        this.apply(new Value({ [key]: xyPos + _stretch }), {\n          ...defaultAnimationExtendOptions,\n          easing: easeOutQuad,\n          duration: _duration,\n        });\n      }\n    } else {\n      // 根据边界算出到达边界要走的的距离，有可能松开时已经超出边界，此时xySwipe是需要减掉的超出部分距离\n      const xySwipe = between(xyPos + _stretch, xyRange) - xyPos;\n      let xyBounce = 0;\n      if (this.isDamping('translate')) {\n        // 计算速度时，如果松开时超出边界，xySwipe肯定为0，其实得到的就是初始速度\n        const velocity =\n          (isBetween(xyPos, xyRange) ? Math.sqrt(1 - Math.abs(xySwipe / _stretch)) : 1) *\n          ((2 * Math.abs(_stretch)) / _duration);\n        // 根据到达边界时速度的大小计算出将要Damping的距离（一个与速度成正比计算方式，最大值不能超过容器宽度的1/4）\n        xyBounce = Math.min(30 * velocity, maxBounce / 4) * sign;\n      }\n      if (typeof transition === 'function') {\n        // 交给调用者去计算分配如何transition，并使用回调计算transition配置\n        transition(key, xySwipe, xyBounce, (xyMove: number) => {\n          // 根据实际走的距离xyMove算出时间占比\n          const kt = 1 - Math.sqrt(1 - Math.abs(xyMove / _stretch));\n          return {\n            duration: kt * _duration,\n            easing: easeOutQuad,\n          };\n        });\n      } else {\n        // 如果松开时超出边界，相当于在xyBounce里减掉超出的部分得到的结果，如果超出很多，远远大于xyBounce，则直接就是0\n        const xyMove = Math.max((xySwipe + xyBounce) * sign, 0) * sign;\n        // 整个减速运动中，移动xyMove的时间占比\n        const kt = 1 - Math.sqrt(1 - Math.abs(xyMove / _stretch));\n        if (xyMove === 0) {\n          // 如果swipe抬起没有移动的距离，则直接归位\n          this.apply(new Value({ [key]: between(xyPos + xyMove, xyRange) }), {\n            ...defaultAnimationExtendOptions,\n          });\n        } else {\n          // 先移动xyMove距离\n          this.apply(new Value({ [key]: xyPos + xyMove }), {\n            ...defaultAnimationExtendOptions,\n            duration: kt * _duration,\n            easing: easeOutQuad,\n          }).then(() => {\n            // 移动后归位\n            this.apply(new Value({ [key]: between(xyPos + xyMove, xyRange) }), {\n              ...defaultAnimationExtendOptions,\n            });\n          });\n        }\n      }\n    }\n  }\n}\n\nexport type IDamping = 'rotate' | 'scale' | 'translate';\nexport type ISizePosition = {\n  containerCenter: number[];\n  containerWidth: number;\n  containerHeight: number;\n  naturalWidth: number;\n  naturalHeight: number;\n};\nexport type IItemModelOption = {\n  sizePosition?: ISizePosition; // 容器尺寸和元素实际尺寸\n  dblAdjust?: boolean; // 双击中心点是否调整\n  dblScale?: number; // 双击放大比例\n  damping?: IDamping[]; // 哪些操作超出边界可以进行阻尼效果，如果对rotate,scale,translate设置了无边界限制(Infinity)，则阻尼无效\n  scalation?: number[]; // 缩放范围 [0.1, 10]，最小比例0.1和最大比例10\n  translation?: number[][]; // 平移范围 [[-10, 20], [-20, 10]]，x最小-10，最大20，y最小-20，最大10\n  rotation?: number[]; // 旋转范围 [-10, 20]，逆时针可旋转20度和顺时针可旋转10度\n} & ITransitionOptions & { transitionEl?: IElement };\n\nexport default ItemModel;\n","<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 80 80\" xmlns=\"http://www.w3.org/2000/svg\">\n  <defs>\n    <linearGradient\n      x1=\"94.0869141%\"\n      y1=\"0%\"\n      x2=\"94.0869141%\"\n      y2=\"90.559082%\"\n      id=\"linearGradient-1\"\n    >\n      <stop stop-color=\"#fff\" stop-opacity=\"0\" offset=\"0%\" />\n      <stop stop-color=\"#fff\" stop-opacity=\"0.3\" offset=\"100%\" />\n    </linearGradient>\n    <linearGradient\n      x1=\"100%\"\n      y1=\"8.67370605%\"\n      x2=\"100%\"\n      y2=\"90.6286621%\"\n      id=\"linearGradient-2\"\n    >\n      <stop stop-color=\"#fff\" offset=\"0%\" />\n      <stop stop-color=\"#fff\" stop-opacity=\"0.3\" offset=\"100%\" />\n    </linearGradient>\n  </defs>\n  <g\n    stroke=\"none\"\n    stroke-width=\"1\"\n    fill=\"none\"\n    fill-rule=\"evenodd\"\n    opacity=\"0.9\"\n  >\n    <g>\n      <path\n        d=\"M40,0 C62.09139,0 80,17.90861 80,40 C80,62.09139 62.09139,80 40,80 L40,73 C58.2253967,73 73,58.2253967 73,40 C73,21.7746033 58.2253967,7 40,7 L40,0 Z\"\n        fill=\"url(#linearGradient-1)\"\n      />\n      <path\n        d=\"M40,0 L40,7 C21.7746033,7 7,21.7746033 7,40 C7,58.2253967 21.7746033,73 40,73 L40,80 C17.90861,80 0,62.09139 0,40 C0,17.90861 17.90861,0 40,0 Z\"\n        fill=\"url(#linearGradient-2)\"\n      />\n      <circle id=\"Oval\" fill=\"#fff\" cx=\"40.5\" cy=\"3.5\" r=\"3.5\" />\n    </g>\n    <animateTransform\n      attributeName=\"transform\"\n      begin=\"0s\"\n      dur=\"1s\"\n      type=\"rotate\"\n      values=\"0 40 40;360 40 40\"\n      repeatCount=\"indefinite\"\n    />\n  </g>\n</svg>\n","<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 24 24\" fill=\"#fff\" xmlns=\"http://www.w3.org/2000/svg\">\n  <path\n    d=\"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-.763-15.864l.11 7.596h1.305l.11-7.596h-1.525zm.759 10.967c.512 0 .902-.383.902-.882 0-.5-.39-.882-.902-.882a.878.878 0 00-.896.882c0 .499.396.882.896.882z\" />\n</svg>\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-08 16:47:13\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-28 09:47:51\n * @Description: ******\n */\n\nimport React from 'react';\nimport { isTouchable } from '../modules/gesture';\nimport { useChanged } from './useChanged';\nimport { useDerivedState } from './useDerivedState';\nimport { useIsomorphicLayoutEffect } from './useIsomorphicLayoutEffect';\nimport { ItemModel, type IBBox } from '../core';\nimport Loading from '../svg/loading.svg';\nimport Error from '../svg/error.svg';\nimport '../style/image.less';\n\ntype IImageRef = {\n  findImageElement: () => HTMLImageElement | null | undefined;\n  findDOMElement: () => HTMLDivElement | null | undefined;\n  getInstance: () => ItemModel | null | undefined;\n};\n\nexport interface IImageProps {\n  className?: string; // 样式类\n  style?: React.CSSProperties; // 样式\n  imgStyle?: React.CSSProperties; // 图片样式\n  src?: string; // 图片url地址\n  alt?: string; // 图片说明\n  error?: false | (() => React.ReactElement | null); // 是否显示错误提示\n  loading?: false | (() => React.ReactElement | null); // 是否显示loading信息\n  active?: boolean; // 是否准备加载\n  viewBox?: IBBox; // 装在image的容器的bbox\n}\n\nconst defaultRenderError = () => {\n  return (\n    <div className=\"preview-image__image__error\">\n      <span>\n        <Error width=\"100%\" height=\"100%\" />\n      </span>\n      <span style={{ marginTop: 16 }}>图片加载失败</span>\n    </div>\n  );\n};\nconst defaultRenderLoading = () => {\n  return (\n    <span className=\"preview-image__image__loading\">\n      <Loading width=\"100%\" height=\"100%\" />\n    </span>\n  );\n};\n\nexport default React.forwardRef<IImageRef, IImageProps>(\n  (\n    { src = '', alt = '', style, imgStyle, className, viewBox, loading, error, active = true },\n    ref,\n  ) => {\n    const wrapperRef = React.useRef<HTMLDivElement | null>(null);\n    const imageRef = React.useRef<HTMLImageElement | null>(null);\n    const itemModelRef = React.useRef<ItemModel | null>(null);\n    const [status, setStatus] = useDerivedState<number>(0, function useCompare(prev) {\n      let _status = prev;\n      if (useChanged(src)) {\n        _status = 0;\n      }\n      if (_status === 0 && active) {\n        _status = 1;\n      }\n      return _status;\n    });\n    useIsomorphicLayoutEffect(() => {\n      itemModelRef.current = new ItemModel({\n        transitionEl: () => imageRef.current,\n        rotation: !isTouchable() ? [-Number.MAX_VALUE, Number.MAX_VALUE] : undefined,\n        scalation: !isTouchable() ? [0.1, 10] : undefined,\n      });\n    }, []);\n\n    React.useImperativeHandle(\n      ref,\n      (): IImageRef => ({\n        findImageElement: () => (status === 2 ? imageRef.current : null),\n        findDOMElement: () => (status === 2 ? wrapperRef.current : null),\n        getInstance: () => (status === 2 ? itemModelRef.current : null),\n      }),\n      [status],\n    );\n\n    const imageSize = React.useMemo(() => {\n      const size = {\n        containerCenter: [0, 0],\n        containerWidth: 0,\n        containerHeight: 0,\n        naturalWidth: 0,\n        naturalHeight: 0,\n      };\n      const imageEl = imageRef.current;\n      if (imageEl && status === 2) {\n        const nWidth = imageEl.naturalWidth;\n        const nHeight = imageEl.naturalHeight;\n        const { left = 0, top = 0, width = 0, height = 0 } = viewBox || {};\n        size.containerCenter = [left + width / 2, top + height / 2];\n        size.containerWidth = width;\n        size.containerHeight = height;\n        size.naturalWidth = nWidth;\n        size.naturalHeight = nHeight;\n      }\n      const itemModel = itemModelRef.current;\n      const _imageSize = { width: 0, height: 0 };\n      if (itemModel) {\n        const { elementWidth, elementHeight } = itemModel.sizePosition(size);\n        _imageSize.width = elementWidth;\n        _imageSize.height = elementHeight;\n      }\n      return _imageSize;\n    }, [viewBox, status]);\n\n    return (\n      <div\n        ref={wrapperRef}\n        className={`preview-image__image__wrapper${!className ? '' : ` ${className}`}`}\n        style={{\n          alignItems: ((viewBox || {}).height || 0) < imageSize.height ? 'flex-start' : 'center',\n          ...(style || {}),\n        }}>\n        <img\n          ref={imageRef}\n          style={{ ...imgStyle }}\n          alt={alt}\n          onLoad={() => setStatus(2)}\n          onError={() => setStatus(3)}\n          {...(status > 0 ? { src } : {})}\n          {...imageSize}\n        />\n        {}\n        {status <= 1 && loading !== false && (loading || defaultRenderLoading)()}\n        {status === 3 && error !== false && (error || defaultRenderError)()}\n      </div>\n    );\n  },\n);\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-08 16:47:13\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-20 17:03:40\n * @Description: ******\n */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { canUseDOM, useIsomorphicLayoutEffect } from './useIsomorphicLayoutEffect';\nimport { getScrollBarSize, isBodyOverflowing } from '../modules/lightdom';\n\nfunction getContainer(container?: IContainer) {\n  if (container === false) {\n    return false;\n  }\n  if (!canUseDOM()) {\n    return null;\n  }\n  let _container: any = container;\n  if (typeof container === 'string') {\n    _container = document.querySelector(container);\n  }\n  if (typeof container === 'function') {\n    _container = container();\n  }\n  return _container || null;\n}\n\ntype IElement = Element | DocumentFragment | null;\n\nexport type IContainer = false | string | IElement | (() => IElement);\n\nexport type IPortalProps = {\n  container?: IContainer;\n  lockOverflow?: boolean;\n  destroy?: boolean;\n  children?: React.ReactNode;\n};\n\nexport default ({ container, destroy, lockOverflow, children }: IPortalProps) => {\n  const [specifyEle, setSpecifyEle] = React.useState<IElement | null | false>(() =>\n    getContainer(container),\n  );\n  const [defalutEle] = React.useState<IElement | null>(() => {\n    if (!canUseDOM()) {\n      return null;\n    }\n    return document.createElement('div');\n  });\n\n  useIsomorphicLayoutEffect(() => setSpecifyEle(getContainer(container)), [container]);\n\n  const defaultEleRender = !destroy && specifyEle === null;\n  useIsomorphicLayoutEffect(() => {\n    if (defaultEleRender) {\n      defalutEle && document.body.appendChild(defalutEle);\n    } else {\n      defalutEle?.parentElement?.removeChild(defalutEle);\n    }\n    return () => {\n      defalutEle?.parentElement?.removeChild(defalutEle);\n    };\n  }, [defalutEle, defaultEleRender]);\n\n  const finalEle = specifyEle ?? defalutEle;\n  const lock =\n    lockOverflow && canUseDOM() && (finalEle === defalutEle || finalEle === document.body);\n  const overflowRef = React.useRef<string>('');\n  useIsomorphicLayoutEffect(() => {\n    const body = document.body;\n    const html = body.parentElement;\n    if (lock) {\n      const isOverflow = isBodyOverflowing();\n      const scrollbarSize = getScrollBarSize(body).width;\n      const width = isOverflow ? `calc(100% - ${scrollbarSize}px)` : '';\n      const overflow = [];\n      overflow[0] = body.style.overflow;\n      body.style.overflow = 'hidden';\n      overflow[1] = body.style.width;\n      body.style.width = width;\n      if (html) {\n        overflow[2] = html.style.overflow;\n        html.style.overflow = 'hidden';\n        overflow[3] = html.style.width;\n        html.style.width = width;\n      }\n      overflowRef.current = overflow.join('-');\n    } else {\n      const overflow = overflowRef.current.split('-');\n      overflowRef.current = '';\n      body.style.overflow = overflow[0];\n      body.style.width = overflow[1];\n      if (html) {\n        html.style.overflow = overflow[2];\n        html.style.width = overflow[3];\n      }\n    }\n    return () => {\n      const overflow = overflowRef.current.split('-');\n      overflowRef.current = '';\n      body.style.overflow = overflow[0];\n      body.style.width = overflow[1];\n      if (html) {\n        html.style.overflow = overflow[2];\n        html.style.width = overflow[3];\n      }\n    };\n  }, [lock]);\n\n  if (destroy || !canUseDOM() || finalEle === null) {\n    return null;\n  }\n  return (\n    <React.Fragment>\n      {finalEle === false ? children : ReactDOM.createPortal(children, finalEle)}\n    </React.Fragment>\n  );\n};\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-24 16:40:36\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-07 13:16:35\n * @Description: ******\n */\n\nimport React from 'react';\n\n// 父组件传来的数据不断变化，但是最返回的包装数据是始终不变的，防止因为父组件传来的数据变化增加不必需要的渲染\nexport function useStableMemo<T>(data: T) {\n  const dataRef = React.useRef<{ data: T }>({ data });\n  dataRef.current.data = data;\n  return React.useMemo(() => dataRef.current, []);\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-07-28 09:57:17\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-13 15:28:46\n * @Description: ******\n */\n\nimport { isTouchable, type IGestureEvent } from '../modules/gesture';\nimport type { SwiperModel, ItemModel } from '../core';\n\nexport default function rotate(this: SwiperModel<ItemModel | null>, event: IGestureEvent) {\n  // 只有鼠标操作才可以，touch操作被放入到pointerMove中了\n  if (isTouchable()) {\n    return;\n  }\n  const item = this.currentItem();\n  if (this.running() || item?.running()) {\n    return;\n  }\n  // diff===0表示目前没有进行任何move操作（使用Math.round，因为像素精确到1）\n  const translate = -this.activeIndex() * this.itemSize();\n  const diff = Math.round(this.value().transform.default - translate);\n  if (diff === 0) {\n    const { angle: a = 0 } = event;\n    if (isNaN(a)) {\n      // 表示停止旋转，应该重置\n      item?.resetBounce();\n    } else {\n      item?.moveBounce(a, 1, 0, 0);\n    }\n  }\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-07-28 09:57:17\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-12 17:43:53\n * @Description: ******\n */\n\nimport { isTouchable, type IGestureEvent } from '../modules/gesture';\nimport type { SwiperModel, ItemModel } from '../core';\n\nexport default function scale(this: SwiperModel<ItemModel | null>, event: IGestureEvent) {\n  // 只有鼠标操作才可以，touch操作被放入到pointerMove中了\n  if (isTouchable()) {\n    return;\n  }\n  const item = this.currentItem();\n  if (this.running() || item?.running()) {\n    return;\n  }\n  // diff===0表示目前没有进行任何move操作（使用Math.round，因为像素精确到1）\n  const translate = -this.activeIndex() * this.itemSize();\n  const diff = Math.round(this.value().transform.default - translate);\n  if (diff === 0) {\n    // const point = event.getPoint();\n    const { scale: k = 1 } = event;\n    if (isNaN(k)) {\n      // 表示停止缩放，应该重置\n      item?.resetBounce();\n    } else {\n      item?.moveBounce(0, k, 0, 0 /* , point */);\n    }\n  }\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-07-28 09:57:17\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-18 17:25:24\n * @Description: ******\n */\n\nimport type { IGestureEvent } from '../modules/gesture';\nimport type { SwiperModel, ItemModel, ICallback } from '../core';\n\nexport default function longTap(\n  this: SwiperModel<ItemModel | null>,\n  event: IGestureEvent,\n  { popupMenu }: ICallback,\n) {\n  const item = this.currentItem();\n  if (this.running() || item?.running()) {\n    return;\n  }\n  popupMenu?.(event);\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-07-28 09:57:17\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-18 17:21:23\n * @Description: ******\n */\n\nimport type { IGestureEvent } from '../modules/gesture';\nimport type { SwiperModel, ItemModel, ICallback } from '../core';\n\nexport default function singleTap(\n  this: SwiperModel<ItemModel | null>,\n  event: IGestureEvent,\n  { internalClose }: ICallback,\n) {\n  const item = this.currentItem();\n  if (this.running() || item?.running()) {\n    return;\n  }\n  internalClose?.(event);\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-07-28 09:57:17\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-28 12:24:38\n * @Description: ******\n */\n\nimport type { IGestureEvent } from '../modules/gesture';\nimport { Value, type IAnimationExtendOptions } from '../modules/transition';\nimport {\n  type SwiperModel,\n  type ItemModel,\n  type ICallback,\n  defaultAnimationExtendOptions,\n} from '../core';\n\nexport default function swipe(\n  this: SwiperModel<ItemModel | null>,\n  event: IGestureEvent,\n  { internalClose, slideBefore, slideAfter }: ICallback,\n) {\n  const item = this.currentItem();\n  if (this.running() || item?.running()) {\n    return;\n  }\n  const { direction } = event;\n  const isForward =\n    (direction === 'Right' && this.isHorizontal()) || (direction === 'Down' && this.isVertical());\n  const translate = -this.activeIndex() * this.itemSize();\n  // 启动swipe时，已经Damping的部分\n  const diff = this.value().transform.default - translate;\n  const diffXY =\n    ((isForward && diff < 0) || (!isForward && diff > 0)) && Math.round(diff) !== 0 ? -diff : 0;\n  if (this._moveTarget === 'inside') {\n    if (item) {\n      const { velocity = 0, swipeComputed } = event;\n      if (velocity > 0 && swipeComputed) {\n        const that = this;\n        const transition = (\n          key: 'x' | 'y',\n          xySwipe: number,\n          xyBounce: number,\n          option: (v: number) => IAnimationExtendOptions,\n        ) => {\n          if (xySwipe !== 0) {\n            const { duration, easing } = option(xySwipe + xyBounce);\n            // 在未超出边界时启动swipe\n            if (xyBounce !== 0) {\n              // 超出边界\n              Promise.all([\n                // 外部damping反方向恢复\n                diffXY !== 0\n                  ? that.apply(new Value(translate), {\n                      ...defaultAnimationExtendOptions,\n                      duration,\n                      easing,\n                      // 先走 diffXY ，走完之后，后面就一直 1\n                      before: (progress) =>\n                        Math.min(\n                          (Math.abs(diffXY + xySwipe + xyBounce) * progress) / Math.abs(diffXY),\n                          1,\n                        ),\n                    })\n                  : Promise.resolve(),\n                // 图片走到边界距离xySwipe\n                item.apply(new Value({ [key]: (item.value().transform[key] || 0) + xySwipe }), {\n                  ...defaultAnimationExtendOptions,\n                  duration,\n                  easing,\n                  // 接着走 xySwipe ，没走到之前都是0，走完之后，后面就一直 1\n                  before: (progress) =>\n                    Math.min(\n                      Math.max(\n                        (Math.abs(diffXY + xySwipe + xyBounce) * progress - Math.abs(diffXY)) /\n                          Math.abs(xySwipe),\n                        0,\n                      ),\n                      1,\n                    ),\n                }),\n                // 外部走damping距离xyBounce\n                that.apply(new Value(translate + xyBounce), {\n                  ...defaultAnimationExtendOptions,\n                  duration,\n                  easing,\n                  // 后走 xyBounce ，没走之前，前面一直 0\n                  before: (progress) =>\n                    Math.max(\n                      (Math.abs(diffXY + xySwipe + xyBounce) * progress -\n                        Math.abs(diffXY) -\n                        Math.abs(xySwipe)) /\n                        Math.abs(xyBounce),\n                      0,\n                    ),\n                }),\n              ]).then(() => {\n                // 外部归位\n                that.apply(new Value(translate), {\n                  ...defaultAnimationExtendOptions,\n                });\n              });\n            } else {\n              // 未超出边界\n              if (diffXY !== 0) {\n                // 外部damping反方向恢复\n                that.apply(new Value(translate), {\n                  ...defaultAnimationExtendOptions,\n                  duration,\n                  easing,\n                  // 先走 diffXY ，走完之后，后面就一直 1\n                  before: (progress) =>\n                    Math.min((Math.abs(diffXY + xySwipe) * progress) / Math.abs(diffXY), 1),\n                });\n              }\n              // 图片走xySwipe\n              item.apply(new Value({ [key]: (item.value().transform[key] || 0) + xySwipe }), {\n                ...defaultAnimationExtendOptions,\n                duration,\n                easing,\n                // 后走 xySwipe ，没走之前，前面一直 0\n                before: (progress) =>\n                  Math.max(\n                    (Math.abs(diffXY + xySwipe) * progress - Math.abs(diffXY)) / Math.abs(xySwipe),\n                    0,\n                  ),\n              });\n            }\n          } else {\n            // 在超出边界时启动swipe，且swipe方向是远离超出边界的方向\n            const sign = diff > 0 ? 1 : -1;\n            // 如果松开时超出边界，相当于在xyBounce里减掉超出的部分得到的结果，如果超出很多，远远大于xyBounce，则直接就是0\n            const xyMove = Math.max((xyBounce - diff) * sign, 0) * sign;\n            const { duration, easing } = option(xyMove);\n            if (xyMove === 0) {\n              // 外部直接归位\n              that.apply(new Value(translate), {\n                ...defaultAnimationExtendOptions,\n              });\n            } else {\n              that\n                .apply(new Value(translate + diff + xyMove), {\n                  ...defaultAnimationExtendOptions,\n                  duration,\n                  easing,\n                })\n                .then(() => {\n                  // 外部归位\n                  that.apply(new Value(translate), {\n                    ...defaultAnimationExtendOptions,\n                  });\n                });\n            }\n          }\n        };\n        // 按照0.003的减速度减速运行得到减速到0时的时间和x，y方向的分量距离\n        const { duration, stretchX, stretchY } = swipeComputed(0.003);\n        if (this.isVertical()) {\n          const xRange = item.getXTranslation();\n          // 竖向的时候固定x\n          if (!(xRange[0] === 0 && xRange[1] === 0)) {\n            item.swipeBounce(duration, stretchX, 'x');\n          }\n          item.swipeBounce(duration, stretchY - diffXY, 'y', transition);\n        } else {\n          item.swipeBounce(duration, stretchX - diffXY, 'x', transition);\n          const yRange = item.getYTranslation();\n          // 横向的时候固定y\n          if (!(yRange[0] === 0 && yRange[1] === 0)) {\n            item.swipeBounce(duration, stretchY, 'y');\n          }\n        }\n      }\n    } else {\n      // 如果item不存在，却越界了，则抬起需要恢复\n      this.slide(this.activeIndex(), {\n        before: slideBefore as (v: number) => void,\n        after: slideAfter as (v: number) => void,\n      });\n    }\n    return;\n  }\n  if (this._moveTarget === 'closures') {\n    // 如果滑动方向是向下的或向右的，执行关闭操作\n    const isClose =\n      (direction === 'Down' && this.isHorizontal()) || (direction === 'Right' && this.isVertical());\n    if (this.swipeClose() && isClose && internalClose?.(event)) {\n      // 这里设置目的是真正关闭后不再执行end里的closures\n      this._moveTarget = 'none';\n    }\n    return;\n  }\n  const size = this.itemSize();\n  const index = size === 0 ? 0 : -this.value().transform.default / size;\n  this.slide(Math[isForward ? 'floor' : 'ceil'](index), {\n    before: slideBefore as (v: number) => void,\n    after: slideAfter as (v: number) => void,\n  });\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-07-28 09:57:17\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-28 11:03:05\n * @Description: ******\n */\n\nimport type { IGestureEvent } from '../modules/gesture';\nimport type { SwiperModel, ItemModel } from '../core';\n\nexport default function doubleTap(this: SwiperModel<ItemModel | null>, event: IGestureEvent) {\n  const item = this.currentItem();\n  if (this.running() || item?.running()) {\n    return;\n  }\n  // diff===0 表示目前没有进行任何move操作（使用Math.round，因为像素精确到1）\n  const translate = -this.activeIndex() * this.itemSize();\n  const diff = Math.round(this.value().transform.default - translate);\n  if (diff === 0) {\n    item?.dblScale(event.getPoint());\n  }\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-07-28 09:57:17\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-15 17:11:45\n * @Description: ******\n */\nimport type { IGestureEvent } from '../modules/gesture';\nimport { Value } from '../modules/transition';\nimport { between, isBetween } from '../utils';\nimport type { SwiperModel, ItemModel, ICallback } from '../core';\n\nexport default function pointerStart(\n  this: SwiperModel<ItemModel | null>,\n  event: IGestureEvent,\n  { preventAllTap }: ICallback,\n) {\n  if (this._fgBehavior === 0 && event.pointers.length > 1) {\n    // 第一根手指放上去，紧接着再放一根手指（或者直接一下子放了两个手指），此时标记为2\n    this._fgBehavior = 2;\n  }\n  let stopCount = 0;\n  stopCount += this.cancel();\n  const item = this.currentItem();\n  stopCount += item?.cancel() || 0;\n  if (stopCount > 0) {\n    // 如果有动画停止，此时处于内外部同时，则非边缘图片的内部damping需要立马恢复（微信这么干的）\n    if (item) {\n      const { x: tx = 0, y: ty = 0, ...rest } = item.value().transform;\n      const [xRange, yRange] = item.getTranslation();\n      // 是否是边缘图片\n      const isFirst = this.activeIndex() === 0;\n      const isLast = this.activeIndex() === this.countItems() - 1;\n      if (this.isVertical()) {\n        if (\n          !isBetween(tx, xRange) &&\n          ((ty <= yRange[0] && !isLast) || (ty >= yRange[1] && !isFirst))\n        ) {\n          // 非边缘图片，且y方向超出边界，x方向也超出边界的，x给予恢复到边界\n          item.apply(new Value({ x: between(tx, xRange), y: ty, ...rest }));\n        }\n      } else {\n        if (\n          !isBetween(ty, yRange) &&\n          ((tx <= xRange[0] && !isLast) || (tx >= xRange[1] && !isFirst))\n        ) {\n          // 非边缘图片，且x方向超出边界，y方向也超出边界的，y给予恢复到边界\n          item.apply(new Value({ x: tx, y: between(ty, yRange), ...rest }));\n        }\n      }\n    }\n    // 如果有动画停止，则阻止所有单指点击相关事件（就像是移动了一下一样）\n    preventAllTap?.();\n  }\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-07-28 09:57:17\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-19 14:17:12\n * @Description: ******\n */\n\nimport type { IGestureEvent } from '../modules/gesture';\nimport { Value } from '../modules/transition';\nimport { revokeDamping, performDamping } from '../modules/damping';\nimport { between } from '../utils';\nimport type { SwiperModel, ItemModel, ICallback, IOpenStyle, IBBox } from '../core';\n\nconst minScale = 0.3; // swipeClose下拉最小缩放比例\nconst minOpacity = 0.01; // swipeClose下拉最小透明度\nconst isRightDown = (isVertical: boolean, [x0, y0]: number[], [x1, y1]: number[]) => {\n  if (isVertical) {\n    return Math.abs(x0 - x1) > 4 * Math.abs(y0 - y1) && x0 - x1 <= 0;\n  } else {\n    return Math.abs(y0 - y1) > 4 * Math.abs(x0 - x1) && y0 - y1 <= 0;\n  }\n};\nexport default function pointerMove(\n  this: SwiperModel<ItemModel | null>,\n  event: IGestureEvent,\n  { openStyleChange }: ICallback,\n) {\n  if (this._fgBehavior === 0 && event.pointers.length === 1) {\n    // 第一根手指放上去，然后直接移动，此时标记为1\n    this._fgBehavior = 1;\n  }\n  const item = this.currentItem();\n  if (this.running() || item?.running()) {\n    return;\n  }\n  const onePointer = event.pointers.length === 1 || this._fgBehavior === 1;\n  const maxOption = { max: this.itemSize() };\n  const {\n    getPoint,\n    direction,\n    angle = 0,\n    scale = 1,\n    deltaX = 0,\n    deltaY = 0,\n    moveX = 0,\n    moveY = 0,\n  } = event;\n  const point = getPoint();\n  if (this._moveTarget === 'none') {\n    const point0 = getPoint('previous');\n    // 多指或者不满足以下条件的，则做图片操作\n    if (item) {\n      this._moveTarget = 'inside';\n      if (onePointer) {\n        // 是否是边缘图片\n        const isFirst = this.activeIndex() === 0;\n        const isLast = this.activeIndex() === this.countItems() - 1;\n        const rightDown = isRightDown(this.isVertical(), point0, point);\n        const { x: tx = 0, y: ty = 0 } = item.value().transform;\n        const [xRange, yRange] = item.getTranslation();\n        // 单指行为时，根据图片位置，判断后续为外部swiper操作还是内部图片操作\n        if (this.isVertical()) {\n          if (this.swipeClose() && tx >= xRange[1] && rightDown) {\n            this._moveTarget = 'closures';\n          } else {\n            // 如果x方向没有可以移动的范围，则判断向上还是向下使用deltaY的正负，否则使用direction值\n            const fixedX = xRange[0] === 0 && xRange[1] === 0;\n            // 如果x的范围是[0,0]，则判断上下移动，直接根据deltaY的正负\n            // 否则需要根据移动方向（因为移动方向是按照45度分开的）\n            const upMove = fixedX ? deltaY < 0 : direction === 'Up';\n            const downMove = fixedX ? deltaY > 0 : direction === 'Down';\n            // 如果图片上边抵达或超出上边界，仍然向下滑动（不是第一张图）\n            // 或者下边抵达或超出下边界，仍然向上滑动（不是最后一张图），则为swiper，反之为图片操作\n            // 因为第一张图片和最后一张都是边缘图片（边缘图片向两边swipe时，是没有上一张或下一张的），无需外部swipe操作，直接走内部图片操作\n            if (\n              (ty <= yRange[0] && upMove && !isLast) ||\n              (ty >= yRange[1] && downMove && !isFirst)\n            ) {\n              this._moveTarget = 'outside';\n            }\n          }\n        } else {\n          if (this.swipeClose() && ty >= yRange[1] && rightDown) {\n            this._moveTarget = 'closures';\n          } else {\n            // 如果y方向没有可以移动的范围，则判断向左还是向右使用deltaX的正负，否则使用direction值\n            const fixedY = yRange[0] === 0 && yRange[1] === 0;\n            // 如果y的范围是[0,0]，则判断左右移动，直接根据deltaX的正负\n            // 否则需要根据移动方向（因为移动方向是按照45度分开的）\n            const leftMove = fixedY ? deltaX < 0 : direction === 'Left';\n            const rightMove = fixedY ? deltaX > 0 : direction === 'Right';\n            // 如果图片左边抵达或超出左边界，仍然向右滑动（不是第一张图）\n            // 或者右边抵达或超出右边界，仍然向左滑动（不是最后一张图），则为swiper操作，反之为图片操作\n            if (\n              (tx <= xRange[0] && leftMove && !isLast) ||\n              (tx >= xRange[1] && rightMove && !isFirst)\n            ) {\n              this._moveTarget = 'outside';\n            }\n          }\n        }\n      }\n    } else {\n      this._moveTarget =\n        this.swipeClose() && isRightDown(this.isVertical(), point0, point) ? 'closures' : 'outside';\n    }\n  }\n  // 进入内部图片操作\n  if (this._moveTarget === 'inside') {\n    if (item) {\n      // 计算出外部swiper移动的原始距离diff\n      const translate = -this.activeIndex() * this.itemSize();\n      const diff = revokeDamping(this.value().transform.default - translate, maxOption);\n      let _deltaX = deltaX;\n      let _deltaY = deltaY;\n      // 把swiper移动的原始距离加进去\n      if (this.isVertical()) {\n        _deltaY += diff;\n      } else {\n        _deltaX += diff;\n      }\n      if (onePointer) {\n        const { x: tx = 0, y: ty = 0 } = item.value().transform;\n        const [xRange, yRange] = item.getTranslation();\n        let _delta = 0;\n        if (this.isVertical()) {\n          // 如果x方向没有可以移动的范围，则判断向上还是向下使用deltaY的正负，否则使用direction值\n          const fixedX = xRange[0] === 0 && xRange[1] === 0;\n          _delta = _deltaY;\n          // 竖向的时候固定x\n          _deltaX = fixedX ? 0 : _deltaX;\n          // 内部图片，最多移动到边界\n          _deltaY = between(_deltaY + ty, yRange) - ty;\n          // 超出部分由外部swiper移动\n          _delta -= _deltaY;\n        } else {\n          // 如果y方向没有可以移动的范围，则判断向左还是向右使用deltaX的正负，否则使用direction值\n          const fixedY = yRange[0] === 0 && yRange[1] === 0;\n          _delta = _deltaX;\n          // 内部图片，最多移动到边界\n          _deltaX = between(_deltaX + tx, xRange) - tx;\n          // 横向的时候固定y\n          _deltaY = fixedY ? 0 : _deltaY;\n          // 超出部分由外部swiper移动\n          _delta -= _deltaX;\n        }\n        // 内部图片需要移动的距离\n        item.moveBounce(0, 1, _deltaX, _deltaY, point);\n        // 外部swiper需要移动的距离\n        this.apply(new Value(translate + performDamping(_delta, maxOption)));\n      } else {\n        item.moveBounce(angle, scale, _deltaX, _deltaY, point);\n        if (diff !== 0) {\n          // 多指移动前，将外部swiper移动的部分归位（内部image会把swiper的距离加进去）\n          this.apply(new Value(translate));\n        }\n      }\n    }\n    return;\n  }\n  if (this._moveTarget === 'closures') {\n    openStyleChange?.((prevStyle: IOpenStyle, viewBox: IBBox) => {\n      const { width = 0, height = 0, left = 0, top = 0 } = viewBox;\n      const k = Math.min(\n        Math.max(1 - ((this.isVertical() ? moveX / width : moveY / height) || 0), minScale),\n        1,\n      );\n      const o = minOpacity + ((k - minScale) * (1 - minOpacity)) / (1 - minScale);\n      const { k: _k = 1, x: _x = 0, y: _y = 0 } = prevStyle;\n      const x = _x + deltaX + (point[0] - (_x + left + width / 2)) * (1 - k / _k);\n      const y = _y + deltaY + (point[1] - (_y + top + height / 2)) * (1 - k / _k);\n      return { o, k, x, y };\n    });\n    return;\n  }\n  // 非内部图片操作，均是外部swiper操作\n  const swiperRange = [(1 - this.countItems()) * this.itemSize(), 0];\n  // 先把当前值反算出阻尼之前的原值\n  let bt = between(this.value().transform.default, swiperRange);\n  let t = bt + revokeDamping(this.value().transform.default - bt, maxOption);\n  // 再对总值进行总体阻尼计算\n  bt = between((t += this.isVertical() ? deltaY : deltaX), swiperRange);\n  t = bt + performDamping(t - bt, maxOption);\n  this.apply(new Value(t));\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-07-28 09:57:17\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-19 14:13:38\n * @Description: ******\n */\n\nimport type { IGestureEvent } from '../modules/gesture';\nimport type { SwiperModel, ItemModel, ICallback } from '../core';\n\nexport default function pointerEnd(\n  this: SwiperModel<ItemModel | null>,\n  event: IGestureEvent,\n  { openStyleChange, slideBefore, slideAfter }: ICallback,\n) {\n  // 单指抬起的情况才可以取消动画\n  const target = this._moveTarget;\n  const cancel = event.leavePointers.length === 1 || this._fgBehavior === 1;\n  if (event.pointers.length === 0) {\n    // 抬起最后一根手指时，重置以下参数\n    this._fgBehavior = 0;\n    this._moveTarget = 'none';\n  } else if (this._fgBehavior === 1) {\n    // 多指视作单指时，抬起非最后一根手指，不做任何操作\n    // 微信这种情况下是slide了，其实我觉得吧，可以不用，影响不大\n    if (!this.running() && target === 'outside') {\n      const size = this.itemSize();\n      const index = size === 0 ? 0 : -this.value().transform.default / size;\n      this.slide(Math.round(index), {\n        before: slideBefore as (v: number) => void,\n        after: slideAfter as (v: number) => void,\n      });\n    }\n    return;\n  }\n  const item = this.currentItem();\n  if (this.running() || item?.running()) {\n    return;\n  }\n  if (target === 'closures') {\n    openStyleChange?.(() => ({ o: 1, k: 1, x: 0, y: 0, t: 300 }));\n    return;\n  }\n  item?.resetBounce(event.getPoint(), cancel);\n  // 如果移动到越界，则抬起需要恢复\n  let index = this.activeIndex();\n  if (target === 'outside') {\n    const size = this.itemSize();\n    // Math.round代表移动超过一半，就下一张\n    index = Math.round(size === 0 ? 0 : -this.value().transform.default / size);\n  }\n  this.slide(index, {\n    before: slideBefore as (v: number) => void,\n    after: slideAfter as (v: number) => void,\n  });\n}\n","/*\n * @Author: Huangjs\n * @Date: 2023-08-08 16:47:13\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-28 09:51:48\n * @Description: ******\n */\n\nimport React from 'react';\nimport { type IGestureEvent } from '../modules/gesture';\nimport Gesture from '../modules/gesture/react';\nimport Image from './image';\nimport Portal, { type IContainer } from './portal';\nimport { useStableMemo } from './useStableMemo';\nimport { useDerivedState } from './useDerivedState';\nimport { useIsomorphicLayoutEffect } from './useIsomorphicLayoutEffect';\nimport {\n  SwiperModel,\n  type ItemModel,\n  type ICallback,\n  type IOpenStyle,\n  type IBBox,\n  type IDirection,\n} from '../core';\nimport {\n  pointerStart,\n  pointerMove,\n  pointerEnd,\n  doubleTap,\n  singleTap,\n  longTap,\n  rotate,\n  scale,\n  swipe,\n} from '../events';\nimport { getBBox } from '../modules/lightdom';\nimport '../style/gallery.less';\n\ntype IGalleryRef = {\n  findDOMElement: () => Element | null | undefined;\n  getInstance: () => SwiperModel<ItemModel | null> | null | undefined;\n};\n\nexport type IGalleryProps = {\n  style?: React.CSSProperties; // 全局样式\n  className?: string; // 全局样式类\n  backdropStyle?: React.CSSProperties; // 背景样式\n  backdropClassName?: string; // 背景样式类\n  wrapperStyle?: React.CSSProperties; // 图片包装器样式\n  wrapperClassName?: string; // 图片包装器样式类\n  indicatorStyle?: React.CSSProperties; // 指示器（页码）样式\n  indicatorClassName?: string; // 指示器（页码）样式类\n  open?: boolean; // 是否打开画廊\n  current?: number; // 当前展示的图片下标\n  container?: IContainer; // 挂载的元素\n  destroyOnClose?: boolean; // 关闭时是否销毁组件\n  enableSwipeClose?: boolean; // 是否开启垂直下拉关闭\n  originBox?: IBBox; // 计算展示和结束画廊时动画移动的位置信息，一般是缩略图的bbox\n  imageUrls?: string[]; // image的url列表\n  itemGap?: number; // 图片之间的间距\n  direction?: IDirection; // 图片排列方向（上下滑动，还是左右滑动）\n  isLazy?: boolean; // 图片是否是懒加载（滑到这个图片时再加载），否则一次性加载完\n  hasLoading?: boolean; // 加载图片是否展示loading\n  hasError?: boolean; // 图片错误是否显示错误提示\n  renderError?: () => React.ReactElement | null; // 图片加载错误自定义渲染\n  hasIndicator?: boolean; // 多图片时是否需要指示器（页码）\n  renderLoading?: () => React.ReactElement | null; // 图片加载中自定义渲染\n  onPopupMenu?: (e: IGestureEvent) => void; // 长按弹出菜单事件\n  onChange?: (v: number) => void; // index改变时事件\n  onAfterChange?: (v: number) => void; // index改变后事件\n  onClose?: (e: IGestureEvent) => void; // 触发关闭事件，需要调用者在该事件内更新open参数\n  onAfterClose?: () => void; // 关闭之后（关闭动画结束）事件\n  onAfterOpenChange?: (o: boolean) => void; // 打开和关闭动画结束之后\n};\n\n//   open(T|F)和openStatus(0|1|2)按照逆时针转变\n//\n//                      关闭且动画结束(无动画)\n//                             F(0)\n//                          /\\       \\\n//                         /          \\\n//                        /            \\/\n//    关闭并执行关闭动画  F(1)          T(0)  打开且准备打开动画\n//                        |\\            |\n//                        |             |\n//                        |             |/\n//    关闭并准备关闭动画  F(2)          T(1)  打开并执行开始动画\n//                       /\\            /\n//                         \\          /\n//                          \\       \\/\n//                             T(2)\n//                      打开且动画结束(无动画)\n\nexport default React.forwardRef<IGalleryRef, IGalleryProps>(\n  (\n    {\n      style,\n      className,\n      backdropStyle,\n      backdropClassName,\n      wrapperStyle,\n      wrapperClassName,\n      indicatorStyle,\n      indicatorClassName,\n      open = false,\n      current = 0,\n      container,\n      originBox,\n      imageUrls = [],\n      itemGap = 20,\n      direction = 'horizontal',\n      isLazy = true,\n      hasLoading = true,\n      renderLoading,\n      hasError = true,\n      renderError,\n      hasIndicator = true,\n      destroyOnClose = false,\n      enableSwipeClose = true,\n      onPopupMenu,\n      onChange,\n      onAfterChange,\n      onClose,\n      onAfterClose,\n      onAfterOpenChange,\n    },\n    ref,\n  ) => {\n    const defaultTotal = imageUrls.length;\n    const defaultCurrent = !current || current < 0 || current >= defaultTotal ? 0 : current;\n    const gestureRef = React.useRef<React.ElementRef<typeof Gesture> | null>(null);\n    const swiperModelRef = React.useRef<SwiperModel<ItemModel | null> | null>(null);\n    const wrapperRef = React.useRef<HTMLDivElement | null>(null);\n    const [openStatus, setOpenStatus] = React.useState<number>(0);\n    const [openStyle, setOpenStyle] = React.useState<IOpenStyle>({});\n    const [viewBox, setViewBox] = React.useState<IBBox>({});\n    const [activeIndex, setActiveIndex] = useDerivedState<number>(defaultCurrent);\n\n    React.useImperativeHandle(\n      ref,\n      (): IGalleryRef => ({\n        findDOMElement: () => gestureRef.current?.findDOMElement(),\n        getInstance: () => swiperModelRef.current,\n      }),\n      [],\n    );\n\n    useIsomorphicLayoutEffect(() => {\n      swiperModelRef.current = new SwiperModel<ItemModel | null>({\n        transitionEl: () => wrapperRef.current,\n      });\n    }, []);\n\n    const stableOptions = useStableMemo({\n      // 只有在打开时并且动画已结束时，才可以有slide过渡\n      ...(open && openStatus === 2 ? {} : { duration: 0 }),\n      before: onChange,\n      after: onAfterChange,\n    });\n    useIsomorphicLayoutEffect(() => {\n      const swiperModel = swiperModelRef.current;\n      if (swiperModel) {\n        swiperModel.slide(activeIndex, { ...stableOptions.data });\n      }\n    }, [activeIndex, stableOptions]);\n\n    useIsomorphicLayoutEffect(() => {\n      // T(0)状态\n      if (open && openStatus === 0) {\n        setViewBox(getBBox(gestureRef.current?.findDOMElement()));\n        // 开启打开动画\n        setOpenStatus(1);\n      }\n      // F(2)状态\n      if (!open && openStatus === 2) {\n        // 开启关闭动画\n        setOpenStatus(1);\n      }\n    }, [open]);\n\n    // 在打开和关闭动画过程中viewBox或originBox发生变化，则不再重新动画\n    const stableBBox = useStableMemo({ viewBox, originBox });\n    useIsomorphicLayoutEffect(() => {\n      // 进行开启关闭动画，F(1)或T(1)状态\n      if (openStatus === 1) {\n        const item = swiperModelRef.current?.currentItem();\n        // 动画之前重置内部图片的transform\n        item?.reset();\n        const { elementWidth: ew = 0, elementHeight: eh = 0 } = item?.sizePosition() || {};\n        const {\n          left: ol = 0,\n          top: ot = 0,\n          width: ow = 0,\n          height: oh = 0,\n        } = stableBBox.data.originBox || {};\n        const {\n          left: rl = 0,\n          top: rt = 0,\n          width: rw = 0,\n          height: rh = 0,\n        } = stableBBox.data.viewBox;\n        let k = 0.001;\n        let x = 0;\n        let y = 0;\n        let w = 0;\n        let h = 0;\n        if (rw > 0 && rh > 0 && ow > 0 && oh > 0) {\n          x = ol + ow / 2 - (rl + rw / 2);\n          y = ot + oh / 2 - (rt + rh / 2);\n        }\n        if (ew > 0 && eh > 0 && ow > 0 && oh > 0) {\n          const rat = ew / eh > ow / oh;\n          k = rat ? oh / eh : ow / ew;\n          w = rat ? eh * (ow / oh) : ew;\n          h = rat ? eh : ew / (ow / oh);\n        }\n        const hideStyle = { o: 0, k, x, y, w, h };\n        const showStyle = { o: 1, k: 1, x: 0, y: 0, w: ew, h: eh };\n        // 动画开始样式\n        setOpenStyle((prevOpenStyle) => ({\n          // 这里在关闭的时候，优先从当前状态prevOpenStyle开始动画\n          ...(open ? hideStyle : { ...showStyle, ...prevOpenStyle }),\n        }));\n        // 使用Promise是为了使上述setState生效，在下一次渲染操作新的setState\n        Promise.resolve().then(() => {\n          // 走一次getBBox为了使上次渲染的样式立马生效，然后进行下次渲染\n          getBBox(gestureRef.current?.findDOMElement());\n          // 以上两步可以可以合并只使用：setTimeout(() => {}, 0);\n          // 动画结束样式\n          setOpenStyle({ ...(open ? showStyle : hideStyle), t: 300 });\n        });\n      }\n    }, [open, openStatus, stableBBox]);\n\n    useIsomorphicLayoutEffect(() => {\n      const swiperModel = swiperModelRef.current;\n      if (swiperModel) {\n        swiperModel.swipeClose(enableSwipeClose);\n      }\n    }, [enableSwipeClose]);\n\n    useIsomorphicLayoutEffect(() => {\n      const swiperModel = swiperModelRef.current;\n      if (swiperModel) {\n        swiperModel.direction(direction);\n      }\n    }, [direction]);\n\n    useIsomorphicLayoutEffect(() => {\n      const swiperModel = swiperModelRef.current;\n      if (swiperModel) {\n        const { width, height } = viewBox;\n        let size = direction !== 'horizontal' ? height : width;\n        size = !size ? 0 : size + itemGap;\n        swiperModel.itemSize(size);\n      }\n    }, [direction, itemGap, viewBox]);\n\n    useIsomorphicLayoutEffect(() => {\n      const contextmenu = (e: Event) => {\n        e.preventDefault();\n        e.stopPropagation();\n      };\n      const resize = () => setViewBox(getBBox(gestureRef.current?.findDOMElement()));\n      window.addEventListener('resize', resize);\n      window.addEventListener('contextmenu', contextmenu);\n      return () => {\n        window.removeEventListener('resize', resize);\n        window.removeEventListener('contextmenu', contextmenu);\n      };\n    }, []);\n\n    const _wrapperStyle = React.useMemo(() => {\n      let { width = 0, height = 0 } = viewBox;\n      const totalGap = (defaultTotal - 1) * itemGap;\n      if (direction !== 'horizontal') {\n        height = height * defaultTotal + totalGap;\n      } else {\n        width = width * defaultTotal + totalGap;\n      }\n      return { width, height };\n    }, [direction, itemGap, viewBox, defaultTotal]);\n\n    function renderImages() {\n      return imageUrls.map((url, index) => {\n        return (\n          <Image\n            ref={(_ref) => swiperModelRef.current?.itemModels(_ref && _ref.getInstance(), index)}\n            key={index}\n            style={{\n              ...(index === activeIndex\n                ? {\n                    transform: `translate(${openStyle.x}px,${openStyle.y}px) scale(${openStyle.k})`,\n                    transition: openStyle.t ? `transform ${openStyle.t}ms` : '',\n                    // 在图片放大的情况下，图片超出部分会被hidden，这里对于整体缩小的情况将需要visible\n                    overflow: (openStyle.k || 1) < 1 || openStyle.t ? 'visible' : undefined,\n                  }\n                : {}),\n              // 给予图片之间一个间隔gap\n              marginTop: direction !== 'horizontal' && index !== 0 ? itemGap : 0,\n              marginLeft: direction !== 'horizontal' || index === 0 ? 0 : itemGap,\n            }}\n            imgStyle={\n              index === activeIndex\n                ? {\n                    width: openStyle.w || undefined,\n                    height: openStyle.h || undefined,\n                    transition:\n                      openStyle.t && openStyle.w && openStyle.h\n                        ? `width ${openStyle.t}ms, height ${openStyle.t}ms`\n                        : '',\n                    // 在带开和关闭动画过程中，图片的object-fit使用cover，保持宽高变化的情况下图片不变形\n                    objectFit: openStyle.w && openStyle.h ? 'cover' : undefined,\n                  }\n                : {}\n            }\n            src={url}\n            error={hasError ? renderError : false}\n            loading={hasLoading ? renderLoading : false}\n            active={!isLazy || activeIndex === index}\n            viewBox={viewBox}\n          />\n        );\n      });\n    }\n\n    function eventBind(trigger: (e: IGestureEvent, o: ICallback) => void, event: IGestureEvent) {\n      const swiperModel = swiperModelRef.current;\n      if (swiperModel) {\n        trigger.apply(swiperModel, [\n          event,\n          {\n            preventAllTap: () => {\n              // 曲线救国：这里使用回调阻止所有Tap事件触发\n              const gesture = gestureRef.current?.getInstance();\n              if (gesture) {\n                gesture.preventAllTap();\n              }\n            },\n            popupMenu: (e: IGestureEvent) => {\n              onPopupMenu?.(e);\n            },\n            internalClose: (e: IGestureEvent) => {\n              if (typeof onClose === 'function') {\n                onClose(e);\n                // 返回true通知真的关闭了\n                return true;\n              }\n            },\n            openStyleChange: (computedStyle: (style: IOpenStyle, bbox: IBBox) => IOpenStyle) => {\n              setOpenStyle((prevOpenStyle) => computedStyle(prevOpenStyle, viewBox));\n            },\n            slideBefore: (index: number) => {\n              setActiveIndex(index);\n              onChange?.(index);\n            },\n            slideAfter: (index: number) => onAfterChange?.(index),\n          },\n        ]);\n      }\n    }\n    // F(0)状态时destroyOnClose，则销毁元素\n    if (destroyOnClose && !open && openStatus === 0) {\n      return null;\n    }\n\n    return (\n      <Portal lockOverflow={open && openStatus === 2} container={container}>\n        <Gesture\n          ref={gestureRef}\n          onPointerStart={(e) => eventBind(pointerStart, e)}\n          onPointerMove={(e) => eventBind(pointerMove, e)}\n          onPointerEnd={(e) => eventBind(pointerEnd, e)}\n          onDoubleTap={(e) => eventBind(doubleTap, e)}\n          onSingleTap={(e) => eventBind(singleTap, e)}\n          onLongTap={(e) => eventBind(longTap, e)}\n          onRotate={(e) => eventBind(rotate, e)}\n          onScale={(e) => eventBind(scale, e)}\n          onSwipe={(e) => eventBind(swipe, e)}>\n          <div\n            className={`preview-image__gallery__container preview-image__gallery__container-${direction}${\n              !className ? '' : ` ${className}`\n            }${open || openStatus !== 0 ? ' visible' : ''}`}\n            style={style}>\n            <div\n              className={`preview-image__gallery__backdrop${\n                !backdropClassName ? '' : ` ${backdropClassName}`\n              }`}\n              style={{\n                backgroundColor: '#000f',\n                ...(backdropStyle || {}),\n                opacity: openStyle.o,\n                transition: !openStyle.t ? '' : `opacity ${openStyle.t}ms`,\n              }}\n              onTransitionEnd={(e: React.SyntheticEvent<HTMLDivElement, TransitionEvent>) => {\n                if (e.nativeEvent.propertyName === 'opacity') {\n                  if (openStatus === 1) {\n                    //动画结束转换到T(2)或F(0)状态\n                    setOpenStatus(open ? 2 : 0);\n                    if (!open) {\n                      onAfterClose?.();\n                    }\n                    onAfterOpenChange?.(open);\n                  }\n                  setOpenStyle(({ o, k, x, y }) => ({ o, k, x, y }));\n                }\n              }}\n            />\n            <div\n              ref={wrapperRef}\n              className={`preview-image__gallery__wrapper${\n                !wrapperClassName ? '' : ` ${wrapperClassName}`\n              }`}\n              style={{\n                ...(wrapperStyle || {}),\n                ..._wrapperStyle,\n              }}>\n              {renderImages()}\n            </div>\n            {hasIndicator && defaultTotal > 1 && (\n              <div\n                className={`preview-image__gallery__indicator${\n                  !indicatorClassName ? '' : ` ${indicatorClassName}`\n                }${open && openStatus === 2 ? ' visible' : ''}`}\n                style={indicatorStyle}>\n                {imageUrls.map((_, index) => (\n                  <span\n                    key={index}\n                    className={`preview-image__gallery__indicator-item${\n                      activeIndex === index ? ' active' : ''\n                    }`}\n                  />\n                ))}\n              </div>\n            )}\n          </div>\n        </Gesture>\n      </Portal>\n    );\n  },\n);\n","/*\n * @Author: Huangjs\n * @Date: 2022-05-11 17:49:45\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-09-28 09:59:50\n * @Description: ******\n */\n\nimport React from 'react';\nimport Gallery, { type IGalleryProps } from './gallery';\nimport Image, { type IImageProps } from './image';\nimport Portal, { type IPortalProps, type IContainer } from './portal';\nimport type { IBBox } from '../core';\n\nexport { Gallery, Image, Portal, IGalleryProps, IImageProps, IPortalProps, IContainer };\n\nexport default function PreviewImage({\n  open = false,\n  urls = [],\n  current = '',\n  onClose,\n  showMenu,\n  originBox,\n}: {\n  open?: boolean;\n  onClose?: () => void;\n  urls?: string[];\n  current?: string;\n  showMenu?: () => void;\n  originBox?: IBBox;\n}) {\n  const index = urls.indexOf(current);\n  return (\n    <Gallery\n      open={open}\n      current={index}\n      imageUrls={urls}\n      enableSwipeClose={true}\n      destroyOnClose={true}\n      onPopupMenu={showMenu}\n      onClose={onClose}\n      originBox={originBox}\n    />\n  );\n}\n"],"names":["useIsomorphicLayoutEffect","window","document","createElement","React","useLayoutEffect","useEffect","useEvent","core","type","onEvent","handler","e","apply","on","off","EventEmitter","constructor","this","events","one","single","onceHandler","args","pool","push","unregistered","i","len","length","splice","emit","event","isCurrentTarget","target","currentTarget","_target","parentNode","fixOption","value","defaultValue","minVal","isTouchable","navigator","maxTouchPoints","getEventPoints","started","touches","points","Array","prototype","filter","call","t","map","pageX","pageY","identifier","isFirst","changedTouches","slice","getDistance","x0","y0","x1","y1","Math","sqrt","pow","getAngle","atan2","PI","getCenter","ok0","ok1","getDirection","x","y","abs","options","super","wheelDelay","longTapInterval","doubleTapInterval","doubleTapDistance","touchMoveDistance","swipeVelocity","swipeDuration","raiseDuration","_rotateAngle","_singleTapTimer","_longTapTimer","_wheelTimerEnd","_preventTap","_swipePoints","_preventSingleTap","_preventDoubleTap","_firstPointer","_pointer0","_pointer1","resetOptions","preventAllTap","fp","clearTimeout","newEvent","sourceEvent","timestamp","Date","now","pointers","leavePointers","getPoint","timer","wheelEnd","changed","p","pointer","start","previous","current","pointer0","pointer1","setTimeout","waitTime","firstPointer","singleTapTimer","moved","start0","previous0","current0","start1","previous1","current1","eCenter","mCenter","sCenter","whichOne","direction","moveDirection","deltaX","moveX","deltaY","moveY","eDistance","mDistance","sDistance","scale","moveScale","angle","moveAngle","_timestamp","point","ended","delayTime","intervalTime","prev","next","endPos","startPos","velocity","deltaTime","distance","swipeComputed","factor","_velocity","duration","deceleration","stretchX","stretchY","rad","cos","sin","getVector","canceled","downed","that","unbind","removeEventListener","mousemoved","mouseupped","blured","dragstarted","documentElement","preventDefault","stopPropagation","button","addEventListener","capture","passive","wheeled","deltaMode","forwardRef","_ref2","ref","children","_objectWithoutPropertiesLoose","_excluded","elementRef","useRef","coreRef","Core","onPan","onTap","onSwipe","onSingleTap","onLongTap","onDoubleTap","onMultiPan","onScale","onRotate","onPointerStart","onPointerMove","onPointerEnd","onPointerCancel","onGestureStart","onGestureMove","onGestureEnd","useEvents","useImperativeHandle","findDOMElement","getInstance","refFun","useCallback","_ref","element","Element","Component","ReactDOM","findDOMNode","Children","only","cloneElement","_extends","onTouchStart","bind","onTouchMove","onTouchEnd","onTouchCancel","onMouseDown","onWheel","console","warn","cached","measureScrollBarSize","fresh","undefined","inner","style","width","height","outer","outerStyle","position","top","left","pointerEvents","visibility","overflow","appendChild","body","widthContained","offsetWidth","widthScroll","clientWidth","removeChild","ensureSize","str","match","Number","isNaN","autoPxReg","getBBox","getBoundingClientRect","useChanged","compare","propsRef","useDerivedState","useCompare","_value","nowValueRef","forceUpdate","setState","useState","useForceUpdate","updateValue","v","val","canUseDOM","root","global","vendors","raf","requestAnimationFrame","caf","cancelAnimationFrame","cancelRequestAnimationFrame","last","fn","delay","max","id","delayCall","callback","Animation","easing","_delay","_frameId","_elapsed","_sleepId","_delayId","_tick","_delayFn","frameFn","elapsed","tick","restart","stop","sleep","time","end","Value","precision","transform","default","_precision","Object","keys","forEach","k","toRaw","raw","Transition$1","cssProperties","_cssProperties","_animations","_apply","update","running","name","replace","toLocaleLowerCase","extendOptions","unionCSSProperties","oldCSSProperties","newCSSProperties","finalCSSProperties","oldCSSName","oldCSSValue","newCSSValue","join","union","deltaCSSProperties","startCSSProperties","endCSSProperties","startCSSValue","_endCSSProperties$nam","endCSSValue","restItem","deltaCSSValue","key","deltaValue","delta","deltaCSSNames","remainCSSProperties","_deltaCSSProperties$n","_extendOptions","Promise","resolve","before","after","cancel","restOptions","_excluded2","animation","remain","progress","_progress","thisCSSValue","remainCSSValue","remainValue","index","findIndex","a","count","tempCSSValue","Transition","el","cssText","suffix","test","removeProperty","setStyle","container","_container","querySelector","getElement","easeOutQuad","defaultAnimationExtendOptions","SwiperModel","itemModels","itemSize","enableSwipeClose","transitionEl","_direction","_itemModels","_itemSize","_activeIndex","_enableSwipeClose","_fgBehavior","_moveTarget","swipeClose","activeIndex","isHorizontal","isVertical","xy","isArray","currentItem","countItems","slide","min","isChanged","translate","then","DEG_TO_RAD","Matrix","multiply","rm","lhm","rhm","a11","a12","a13","a14","a21","a22","a23","a24","a31","a32","a33","a34","a41","a42","a43","a44","b11","b12","b13","b14","b21","b22","b23","b24","b31","b32","b33","b34","b41","b42","b43","b44","identity","m","z","rotate","Float32Array","ra","s","c","recipLen","nc","yz","zx","xs","ys","zs","rotateEuler","xa","ya","za","xra","yra","zra","cx","sx","cy","sy","cz","sz","cxsy","sxsy","perspective","fovy","aspect","zNear","zFar","f","tan","rangeReciprocal","Transform","toString","matrix","damping","expo","revoke","performDamping","option","mode","revokeDamping","ratioOffset","effectuate","isBetween","between","_","ItemModel","sizePosition","dblAdjust","dblScale","rotation","scalation","translation","_dblAdjust","_dblScale","_damping","_rotation","_scalation","_translation","_sizePosition","containerCenter","containerWidth","containerHeight","naturalWidth","naturalHeight","elementWidth","elementHeight","setDblAdjust","setDamping","setDblScale","setRotation","setScalation","setTranslation","reset","getRotation","getScalation","getXTranslation","getYTranslation","aspectRatio","getDblScale","setXTranslation","setYTranslation","getTranslation","bx","by","aj","getDblAdjust","isDamping","_this$_damping","indexOf","rotateTo","transformTo","scaleTo","translateTo","translateX","translateXTo","translateY","translateYTo","_point","_options","_a","_k","_x","_y","_transform","ox","oy","computeOffset","adjust","dk","cw","ch","ew","eh","moveBounce","aRange","ba","kRange","bk","xMax","yMax","resetBounce","tk","swipeBounce","stretch","transition","maxBounce","xyScale","xyPos","xyRange","sign","_stretch","_duration","xySwipe","xyBounce","xyMove","kt","_defs","_g","assign","arguments","source","hasOwnProperty","_path","SvgLoading","props","xmlns","viewBox","x2","y2","offset","stopColor","stopOpacity","fill","fillRule","opacity","d","r","attributeName","begin","dur","repeatCount","values","SvgError","defaultRenderError","className","Error","marginTop","defaultRenderLoading","Loading","Image","src","alt","imgStyle","loading","error","active","wrapperRef","imageRef","itemModelRef","status","setStatus","_status","MAX_VALUE","findImageElement","imageSize","useMemo","size","imageEl","nWidth","nHeight","itemModel","_imageSize","alignItems","onLoad","onError","getContainer","Portal","destroy","lockOverflow","specifyEle","setSpecifyEle","defalutEle","defaultEleRender","_defalutEle$parentEle","parentElement","_defalutEle$parentEle2","finalEle","lock","overflowRef","html","isOverflow","scrollHeight","innerHeight","clientHeight","innerWidth","scrollbarSize","getComputedStyle","getScrollBarSize","split","Fragment","createPortal","useStableMemo","data","dataRef","item","round","longTap","popupMenu","singleTap","internalClose","swipe","slideBefore","slideAfter","isForward","diff","diffXY","all","xRange","yRange","isClose","doubleTap","pointerStart","stopCount","_item$value$transform","tx","ty","rest","isLast","isRightDown","pointerMove","openStyleChange","onePointer","maxOption","point0","rightDown","fixedX","fixedY","_deltaX","_deltaY","_delta","prevStyle","o","swiperRange","bt","pointerEnd","Gallery","backdropStyle","backdropClassName","wrapperStyle","wrapperClassName","indicatorStyle","indicatorClassName","open","originBox","imageUrls","itemGap","isLazy","hasLoading","renderLoading","hasError","renderError","hasIndicator","destroyOnClose","onPopupMenu","onChange","onAfterChange","onClose","onAfterClose","onAfterOpenChange","defaultTotal","defaultCurrent","gestureRef","swiperModelRef","openStatus","setOpenStatus","openStyle","setOpenStyle","setViewBox","setActiveIndex","_gestureRef$current","stableOptions","swiperModel","_gestureRef$current2","stableBBox","_swiperModelRef$curre","ol","ot","ow","oh","rl","rt","rw","rh","w","h","rat","hideStyle","showStyle","prevOpenStyle","_gestureRef$current3","contextmenu","resize","_gestureRef$current4","_wrapperStyle","totalGap","eventBind","trigger","_gestureRef$current5","gesture","computedStyle","Gesture","backgroundColor","onTransitionEnd","nativeEvent","propertyName","url","_swiperModelRef$curre2","marginLeft","objectFit","PreviewImage","urls","showMenu"],"mappings":"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"}